(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[676,590],{2239:function(e,t,n){"use strict";n.d(t,"t",function(){return u}),n.d(t,"i",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"e",function(){return _});var a=n(0),i=n(6),r=n(53),o=n(157),s=n(200),c=n(1354),d=n(292),l="@ms/odsp-shared/lib/base/BaseModel",u=new i.t({name:"".concat(l,".asyncType"),factory:new i.e(s.e)}),f=new i.t({name:"".concat(l,".observablesFactoryType"),factory:new r.a(c.e,{asyncType:u.optional})}),p=new i.t({name:"".concat(l,".eventGroupType"),factory:new i.e(o.t)}),m=new i.t({name:"".concat(l,".errorHandler")}),_=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=t.id,r=void 0===i?"":i;return a.id=r,a._BaseModel_dependencies=n,a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"async",{get:function(){return this._BaseModel_getAsync()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){return this._BaseModel_getEvents()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"observables",{get:function(){return this._BaseModel_getObservables()},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(e,t,n){return this.observables.subscribe(e,t,{isBeforeChange:n})},t.prototype.createComputed=function(e,t){return this.observables.compute(e,t)},t.prototype.createPureComputed=function(e,t){return this.observables.pureCompute(e,t)},t.prototype.createBackgroundComputed=function(e,t){return this.observables.backgroundCompute(e,t)},t.prototype.addDisposable=function(e){return this.scope.attach(e)},t.prototype.trackPromise=function(e){var t=!1,n=this.scope.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),a=function(){t=!0,n.dispose()};return e.done(a,a),e},t.prototype.wrapObservable=function(e){return this.observables.wrap(e)},t.prototype.peekUnwrapObservable=function(e){return Object(c.a)(e)},t.prototype.createObservable=function(e){return this.observables.create(e)},t.prototype.unwrapObservable=function(e){return Object(c.i)(e)},t.prototype.isObservable=function(e){return Object(c.n)(e)},t.prototype._BaseModel_getAsync=function(){var e=new(this.scope.attached(this._BaseModel_getAsyncType()))(this,this._BaseModel_getErrorHandler());return this._BaseModel_getAsync=function(){return e},e},t.prototype._BaseModel_getEvents=function(){var e=new(this.scope.attached(this._BaseModel_getEventGroupType()))(this,this._BaseModel_getErrorHandler());return this._BaseModel_getEvents=function(){return e},e},t.prototype._BaseModel_getObservables=function(){var e=new(this.scope.attached(this._BaseModel_getObservablesFactoryType()))({owner:this});return this._BaseModel_getObservables=function(){return e},e},t.prototype._BaseModel_getAsyncType=function(){return this._BaseModel_dependencies.asyncType||this.resources&&this.resources.consume(u.optional)||s.e},t.prototype._BaseModel_getEventGroupType=function(){return this._BaseModel_dependencies.eventGroupType||this.resources&&this.resources.consume(p.optional)||o.t},t.prototype._BaseModel_getObservablesFactoryType=function(){return this._BaseModel_dependencies.observablesFactoryType||this.resources&&(this.resources.consume(f.optional)||Object(i.i)(c.e,{asyncType:this._BaseModel_getAsyncType()}))||c.e},t.prototype._BaseModel_getErrorHandler=function(){return this._BaseModel_dependencies.errorHandler||this.resources&&this.resources.consume(m.optional)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},d.e.dependencies),{asyncType:u.optional,observablesFactoryType:f.optional,eventGroupType:p.optional,errorHandler:m.optional}),t}(d.e);t.n=_},2268:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(2272),i=n(53),r=function(){function e(e,t){this._itemsStore=t.itemsStore}return e.prototype.getParent=function(e){if(e){var t=this._itemsStore.getItem(e.key),n=t&&t.peek(),a=n&&(n.parentKey||n.UNSAFE_parent&&n.UNSAFE_parent.key);return a?this._itemsStore.getItem(a):void 0}},e.prototype.getFacetedAncestorOrSelf=function(e,t,n){return void 0===n&&(n=""),this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})},e.prototype.getAncestorOrSelf=function(e,t){for(var n,a=e&&e.key;a;){var i=this._itemsStore.getItem(a),r=i&&i.peek();if(!r)break;if(t(r)){n=i;break}a=r&&(r.parentKey||r.UNSAFE_parent&&r.UNSAFE_parent.key)}return n},e.dependencies={itemsStore:a.t},e}(),o=Object(i.r)("ItemParentHelper",r)},2272:function(e,t,n){"use strict";n.d(t,"t",function(){return I});var a=n(0),i=n(2293),r=n(121),o=n(1354),s=n(6),c=n(53),d=n(601),l=n(1357),u=n(688),f=n(2468),p=n(1358),m=n(31),_=Object(m.isFeatureEnabled)(m.ReadOnlyItemsStore),h="token=",b="result=",g="item_write=",v="item=";function y(e){return e&&e.item&&e.item.peek().key}function S(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null,n.items=[],t.valueHasMutated()}var D=function(e){function t(){var t=e.call(this,"ItemsStore")||this;return t._itemSetsKeys={},t._observables=new o.e({owner:t}),t._vaultItemsToPurge=[],window.odstore=t,t}return Object(a.__extends)(t,e),t.prototype.dispose=function(){this._observables.dispose()},t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,Object(a.__spreadArray)([e],t,!1))},t.prototype.getItem=function(e){return this.getValue(v+e)},t.prototype.setItemSet=function(e,t){var n=b+e;this.setValue(n,t),this._itemSetsKeys[n]=1},t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var a=(t=this.getValue(n)).content&&t.content.peek(),i=a&&a.items;if(i)for(var r=0,o=i;r<o.length;r++){var s=o[r];if(s&&s.peek().parentKey===e)return t}}},t.prototype.getItemSet=function(e){return this.getValue(b+e)},t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice(b.length));return e},t.prototype.setNextRequestToken=function(e,t,n){var a=h+t;n?this.setValue(a,n):this.remove(a)},t.prototype.getNextRequestToken=function(e){return this.getValue(h+e)},t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,a=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),a)},t.prototype.invalidateItemSet=function(e){var t=this.getValue(b+e);t&&S(t)},t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&S(t)},t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a),r=i&&i.locationFilter;r&&r.indexOf(e)>=0&&(t.isExpired=!0)}}},t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a);i&&i.tagFilter===e&&(t.isExpired=!0)}}},t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();n&&n.key&&n.key.indexOf("allmyphotos")>=0&&(e.isExpired=!0,this._invalidateItem(n))}},t.prototype.invalidateAllVault=function(){for(var e=0,t=Object(a.__spreadArray)([],this._vaultItemsToPurge,!0);e<t.length;e++){var n=t[e],r=void 0;n.vault&&n.vault.root&&((r=new i.e(n.key)).name=n.name,r.displayName=n.displayName,r.dateModified=" ",r.folder={},r.vault={isLocked:!0,root:{}}),this._purgeItem(n,r)}this._vaultItemsToPurge=[]},t.prototype._handleItemInvalidation=function(e,t,n){var a=this;if(t){var i=t.peek(),r=!1,o=[];if(i)switch(o.push(i),i.type){case u.e.Folder:case u.e.Media:r=!0}for(var s in this._itemSetsKeys){var c=this.getValue(s),d=c.item&&c.item.peek(),l=d&&d.key;l&&(l===e||r&&l.indexOf("allmyphotos")>-1)&&(l===e?this.setNextRequestToken(e,c.key,""):o.push(d),c.isExpired=!0)}o.forEach(n?function(e){return a._purgeItem(e)}:function(e){return a._invalidateItem(e)})}},t.prototype._purgeItem=function(e,t){var n=t||new i.e(e.key);this.setItem(n)},t.prototype._invalidateItem=function(e){var t=new i.e(e.key);Object(p.default)(t,e),Object(p.default)(t,{revision:e.revision+1}),this.setItem(t)},t.prototype._handleSetItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=[];_&&!Object.isFrozen(e)&&Object.freeze(e),e.vault&&this._vaultItemsToPurge.push(e);for(var r=function(t){var n="".concat(v).concat(t),a=_?"".concat(g).concat(t):n,r=o.getValue(n),s=o.getValue(a);s?s(e):((s=o._observables.create(e)).equalityComparer=l.n,o.setValue(a,s),r=_?o._observables.pureCompute(function(){return s()}):s,o.setValue(n,r)),i.push(r)},o=this,s=0,c=Object(f.e)(Object(a.__spreadArray)([e.key],t,!0));s<c.length;s++){var d=c[s];r(d)}return i[0]},t}(r.e),I=new s.t({name:"ItemsStore",factory:new c.i(D)});t.e=D},2293:function(e,t,n){"use strict";var a=n(37);t.e=function(e){void 0===e&&(e=""),this.isDropEnabled=!1,this.permissions={High:0,Low:0},this.key=e,this.revision=0,this.queryType=a.e.Files,this.displayType=a.e.Files,this.isPlaceholder=!0,this.properties={},this.recycleBinProperties={},this.reputationProperties={},this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0},this.urls={},this.state={upload:{status:5},removing:!1}}},2324:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},2468:function(e,t,n){"use strict";function a(e){var t;t={};for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a],o="".concat(r);t[o]||(t[o]=!0,n.push(r))}return n}n.d(t,"e",function(){return a})},2551:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return o});var a=n(2239),i=n(6),r=n(1399),o=new i.t({name:"".concat("IsDetailsPaneExpanded",".isDetailsPaneExpanded"),factory:{dependencies:{detailsPaneId:r.e,observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},2553:function(e,t){var n,a,i=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{a="function"==typeof clearTimeout?clearTimeout:o}catch(e){a=o}}();var c,d=[],l=!1,u=-1;function f(){l&&c&&(l=!1,c.length?d=c.concat(d):u=-1,d.length&&p())}function p(){if(!l){var e=s(f);l=!0;for(var t=d.length;t;){for(c=d,d=[];++u<t;)c&&c[u].run();u=-1,t=d.length}c=null,l=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===o||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function _(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new m(e,t)),1!==d.length||l||s(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=_,i.addListener=_,i.once=_,i.off=_,i.removeListener=_,i.removeAllListeners=_,i.emit=_,i.prependListener=_,i.prependOnceListener=_,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},2659:function(e,t,n){"use strict";n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a=n(183),i=n(51);function r(e){return e}function o(e){return e}function s(e,t){return e&&e.extension&&!!e.openUrl&&!t.isRecycleBin(e.queryType)&&e.itemStatus!==a.t.ConditionalAccessViewOnly&&e.itemStatus!==a.t.ConditionalAccessBlocked&&i.e.hasItemPermission(e,i.e.openItems)}},2719:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e.fromHexString=function(e,t){var n=t?{High:2147483647,Low:2147483647}:{High:0,Low:0},a=e&&e.match(/^(0x)?([0-9a-f]*)$/i);if(a){var i=void 0,r=void 0;(e=(e=a[2]||"0").slice(-16)).length<=8?(i=0,r=parseInt(e,16)):(i=parseInt(e.slice(0,-8),16),r=parseInt(e.slice(-8),16)),isNaN(i)||isNaN(r)||(n.High=i,n.Low=r)}return n},e.or=function(e){return(e||[]).reduce(function(e,t){return{High:e.High|t.High,Low:e.Low|t.Low}},{High:0,Low:0})},e.and=function(e){return e&&e.length?e.reduce(function(e,t){return{High:e.High&t.High,Low:e.Low&t.Low}}):{High:0,Low:0}}}(a||(a={})),t.t=a},2748:function(e,t,n){(function(t){var a;self,a=(e,n)=>(()=>{var a,i,r,o,s,c,d,l={4969:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(95018),i=function(){function e(){this._isAllowed=!1}return e.prototype.putBackgroundFetchAllowed=function(e){if(this._isAllowed=e,this.isBackgroundFetchAllowed()&&this._isAllowedDeferral){var t=this._isAllowedDeferral;this._isAllowedDeferral=void 0,t.resolve(void 0)}},e.prototype.isBackgroundFetchAllowed=function(){return this._isAllowed},e.prototype.waitForBackgroundFetchAllowed=function(){return this.isBackgroundFetchAllowed()?a.Resolved():(this._isAllowedDeferral||(this._isAllowedDeferral=a.Defer()),this._isAllowedDeferral.promise())},e}();t.default=i},22213:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(95018),i=function(){function e(){this._isActive=!1}return e.prototype.putAppActive=function(e){if(this._isActive=e,this.isAppActive()&&this._appActiveDeferral){var t=this._appActiveDeferral;this._appActiveDeferral=void 0,t.resolve(void 0)}},e.prototype.isAppActive=function(){return this._isActive},e.prototype.waitForAppActive=function(){return this.isAppActive()?a.Resolved():(this._appActiveDeferral||(this._appActiveDeferral=a.Defer()),this._appActiveDeferral.promise())},e}();t.default=i},16464:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5259),i=n(95018),r=n(97766),o=function(){function e(e){this._config=e,this.configUpdated=new a.default,this._cachedConfigs={}}return e.prototype.initialize=function(){return this.updateConfigsToFetch()},e.prototype.updateConfigsToFetch=function(){var e=this,t=this._config.getConfig(),n=t.databaseInterface,a=t.configsToFetch;if(!n)return i.Resolved();for(var r=[],o=function(t){if(s._cachedConfigs[t])return"continue";r.push(n.getData(t).then(function(n){n&&(e._cachedConfigs[t]=n)}).catch(function(){return i.Resolved()}))},s=this,c=0,d=a;c<d.length;c++)o(d[c]);return i.all(r).then(function(){r.length>0&&e.configUpdated.fire()})},e.prototype.getEcsConfig=function(){return this._cachedConfigs[r.EcsConfigType.User]||this._cachedConfigs[r.EcsConfigType.Default]},e.prototype.getEcsConfigByType=function(e){return this._cachedConfigs[e]},e.prototype.putConfig=function(e){var t=this.getEcsConfig();this._cachedConfigs[e.configType]=e;var n=this.getEcsConfig();(n&&n.configType===e.configType||t&&n&&t.configType!==n.configType)&&this.configUpdated.fire();var a=this._config.getConfig().databaseInterface;return a?a.putData(e.configType,e):i.Resolved()},e}();t.default=o},28976:function(e,t){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.initialize=function(e){if(this._config)throw"ECS Configuration already initialized";this._config=e},e.prototype.getConfig=function(){if(!this._config)throw"ECS Configuration not yet initialized";return this._config},e.prototype.setConfigsToFetch=function(e){if(!this._config)throw"ECS Configuration not yet initialized";this._config=n(n({},this._config),{configsToFetch:e})},e.prototype.setFetchTimeout=function(e){if(!this._config)throw"ECS Configuration not yet initialized";this._config=n(n({},this._config),{fetchTimeout:e})},e}();t.default=a},46705:(e,t,n)=>{"use strict";var a=n(4969),i=n(22213),r=n(16464),o=n(28976),s=n(97766);t.lk=s;var c=n(42021),d=n(64287),l=n(11838),u=function(){function e(){this._allowBackgroundFetchData=new a.default,this._appActiveData=new i.default,this._config=new o.default,this._cache=new r.default(this._config),this._skypeTokenData=new d.default,this._telemetryManager=new l.default(this._cache),this._scheduler=new c.default(this._config,this._skypeTokenData,this._cache,this._appActiveData,this._allowBackgroundFetchData,this._telemetryManager),this.telemetryEventAdded=this._telemetryManager.telemetryEventAdded,this.configUpdated=this._cache.configUpdated}return e.prototype.initialize=function(e){var t=this;return this._config.initialize(e),this._skypeTokenData.putSkypeTokenData(e.initialSkypeTokenData),this._appActiveData.putAppActive(e.initialAppActiveState),this._cache.initialize().then(function(){t._scheduler.initialize()})},e.prototype.dispose=function(){var e;(null===(e=this._config.getConfig().Killswitches)||void 0===e?void 0:e.isSkypeTokenDataLeakFixEnabled)&&this._scheduler.dispose()},e.prototype.getConfig=function(){return this._cache.getEcsConfig()},e.prototype.getConfigType=function(){var e=this._cache.getEcsConfig();if(e)return e.configType},e.prototype.requestUpdate=function(){this._scheduler.requestUpdate()},e.prototype.pause=function(){this._scheduler.pause()},e.prototype.resume=function(){this._scheduler.resume()},e.prototype.setAllowBackgroundFetch=function(e){this._allowBackgroundFetchData.putBackgroundFetchAllowed(e)},e.prototype.useSkypeToken=function(e,t){this._skypeTokenData.putSkypeTokenData({skypeToken:e,skypeTokenExpiration:t})},e.prototype.setAppActive=function(e){this._appActiveData.putAppActive(e)},e.prototype.setConfigsToFetch=function(e){var t=this;return this._config.setConfigsToFetch(e),this._cache.updateConfigsToFetch().then(function(){t._scheduler.updateConfigsToFetch()})},e.prototype.setFetchTimeout=function(e){this._config.setFetchTimeout(e)},e}();t.XP=u},97766:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),(n=t.EcsConfigType||(t.EcsConfigType={}))[n.Default=0]="Default",n[n.User=1]="User"},4567:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o,s,c=n(10324),d=n(95018),l=n(97766),u=n(90130),f=function(e){function t(t,n,a,i,r,o,s,c){var d=e.call(this,t)||this;d._config=n,d._skypeTokenData=a,d._appActiveData=i,d._allowBackgroundFetchData=r,d._etag=o,d._getUserConfig=s;var l=d._config.getConfig();if(d._apiPath=l.clientTeam?"/config/v1/"+l.clientName+"/"+l.clientVersion+"/"+l.clientTeam:"/config/v1/"+l.clientName+"/"+l.clientVersion,c){var u=Object.keys(c).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(c[e].toString())});u&&(d._apiPath+="?"+u.join("&"))}return d}return i(t,e),t.prototype._blockRequestUntil=function(e){var t=this;if(this._getUserConfig&&!this._skypeTokenData.isSkypeTokenValid()&&console.log("ECS - Delaying User config fetch until we have a valid SkypeToken"),!this._appActiveData.isAppActive()&&!this._allowBackgroundFetchData.isBackgroundFetchAllowed()){var n=this._getUserConfig?"User config":"config";console.log("ECS - Delaying "+n+" fetch until the app is active (or background fetch is allowed)")}return d.race([this._appActiveData.waitForAppActive(),this._allowBackgroundFetchData.waitForBackgroundFetchAllowed()]).then(function(){if(t._getUserConfig)return t._skypeTokenData.waitForValidSkypeToken()}).then(function(){s=Date.now()})},t.prototype._getHeaders=function(){var e={};return this._etag&&(e["If-None-Match"]=this._etag),this._getUserConfig&&(e.Authorization=this._skypeTokenData.getSkypeToken()),e},t.prototype.getConfig=function(){var t=this._config.getConfig().fetchTimeout;return void 0!==t&&(t<0?t=0:t>0&&t<3e4&&(t=3e4)),e.prototype.performApiGetDetailed.call(this,this._apiPath,{timeout:t})},t}(c.GenericRestClient),p=function(){function e(e,t,n,a,i){this._config=e,this._skypeTokenData=t,this._appActiveData=n,this._allowBackgroundFetchData=a,this._telemetryManager=i,this._ecsFailureBackoffTimer=new c.ExponentialTime(1e3,3e5),this._cacheMaxAgeRegex=/.*max-age=(\d+).*/gi,this._serverIndex=NaN}return e.prototype.getConfig=function(e,t,n){var a=this,i=this._config.getConfig().hosts;if((isNaN(this._serverIndex)||this._serverIndex>i.length-1)&&(this._serverIndex=Math.floor(Math.random()*i.length)),!i||!i.length)return d.Rejected(new Error("no configuration service endpoint"));var o=d.Defer(),c=0,p=function(){var m=e&&e.eTag?e.eTag:void 0,_=new f(i[a._serverIndex],a._config,a._skypeTokenData,a._appActiveData,a._allowBackgroundFetchData,m,t,n);c++,_.getConfig().then(function(n){var f=n.headers.etag,p=n.headers.expires;n.body&&n.body.Headers&&(f||(f=n.body.Headers.ETag),p||(p=n.body.Headers.Expires));var _=a._calculateResponseTimeInfo(e);if(!f||!p)return console.warn("ECS - Service returned an empty ETag or Expiration header: "+JSON.stringify(n)),d.Rejected({timedOut:!1,responseParsingException:new Error("ECS Service returned empty ETag or Expiration header"),responseCode:n.statusCode});var h,b=new Date(a._calculateExpirationDate(n.headers)).getTime();if(304===n.statusCode&&e)(h=r({},e)).configType=t?l.EcsConfigType.User:l.EcsConfigType.Default,h.eTag=f,h.expiration=b,h.cacheUpdateTime=_.lastResponseTime,h.lastFetchTokenHash=a._skypeTokenData.getSkypeTokenHash(n.requestHeaders.Authorization);else{if("object"!=typeof n.body)return console.warn("ECS - Service returned invalid response "+JSON.stringify(n)),d.Rejected({timedOut:!1,responseParsingException:new Error("ECS Service returned invalid response body"),responseCode:n.statusCode});h={config:n.body,configType:t?l.EcsConfigType.User:l.EcsConfigType.Default,eTag:f,expiration:b,cacheUpdateTime:s,lastFetchTokenHash:a._skypeTokenData.getSkypeTokenHash(n.requestHeaders.Authorization),appVersion:a._config.getConfig().clientVersion}}a._telemetryManager.sendTelemetryEvent(new u.EcsConfigFetchResponse(_.fetchDelayMs,n.statusCode,c,a._skypeTokenData.isSkypeTokenValid(),i[a._serverIndex],_.fetchDurationValid,!!m,JSON.stringify(n).length,_.cacheAge,!(e&&e.expiration-Date.now()>0),s,_.lastResponseTime,t,f)),a._ecsFailureBackoffTimer.reset(),o.resolve(h)}).catch(function(n){var r={timedOut:n&&n.timedOut||!1,responseParseError:n&&n.responseParsingException,responseCode:n&&n.statusCode||0,message:a._getErrorMessage(n)};console.error("ECS - Service request failed to return a response (timedOut: "+r.timedOut+", responseParseError: "+r.responseParseError+")");var o=a._calculateResponseTimeInfo(e);a._telemetryManager.sendTelemetryEvent(new u.EcsConfigFetchResponse(o.fetchDelayMs,r.responseCode,c,a._skypeTokenData.isSkypeTokenValid(),i[a._serverIndex],o.fetchDurationValid,!!m,0,o.cacheAge,!(e&&e.expiration-Date.now()>0),s,o.lastResponseTime,t,void 0,r.timedOut,r.responseParseError,r.message)),setTimeout(function(){p()},a._ecsFailureBackoffTimer.getTimeAndCalculateNext())})};return p(),o.promise()},e.prototype._calculateExpirationDate=function(e){var t=Date.now()+1728e5;if(e.date&&e.expires){var n=new Date(e.date).getTime(),a=Date.now()-n,i=new Date(e.expires).getTime();return isNaN(i)?t:Math.min(t,i+a)}var r=this._cacheMaxAgeRegex.exec(e["cache-control"]);return this._cacheMaxAgeRegex.lastIndex=0,r&&2===r.length?Math.min(t,Date.now()+1e3*Number(r[1])):Date.now()+18e5},e.prototype._calculateResponseTimeInfo=function(e){var t=(o=Date.now())-s;return{lastResponseTime:o,fetchDelayMs:t,fetchDurationValid:!(t<0||t>31536e6),cacheAge:e?o-e.cacheUpdateTime:0}},e.prototype._getErrorMessage=function(e){if(e)return"string"==typeof e?e:"object"==typeof e&&(e.statusText||e.message)?e.statusText||e.message:void 0},e}();t.default=p},42021:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97766),i=n(4567),r=function(){function e(e,t,n,r,o,s){var c=this;this._config=e,this._skypeTokenData=t,this._cache=n,this._isFetchingSettings={},this._pendingFetch={},this._pendingTimers={},this._subscriptionToken=null,this._paused=!1,this._fetchEcsSettingsIfNeeded=function(e){var t,n=c._config.getConfig(),i=c._cache.getEcsConfigByType(e);if(-1!==n.configsToFetch.indexOf(e)&&!c._isFetchingSettings[e])if(i||!c._pendingFetch[e]){var r=i?i.expiration-Date.now():-1;r<=0||i&&e===a.EcsConfigType.User&&c._skypeTokenData.isSkypeTokenValid()&&i.lastFetchTokenHash!==c._skypeTokenData.getSkypeTokenHash(c._skypeTokenData.getSkypeToken())?c._fetchSkypeEcsSettings(e):(null===(t=n.Killswitches)||void 0===t?void 0:t.isSkypeTokenDataLeakFixEnabled)?(c._pendingTimers[e]>0&&clearTimeout(c._pendingTimers[e]),c._pendingTimers[e]=window.setTimeout(function(){return c._fetchEcsSettingsIfNeeded(e)},r)):window.setTimeout(function(){return c._fetchEcsSettingsIfNeeded(e)},r)}else c._fetchSkypeEcsSettings(e)},this._fetchSkypeEcsSettings=function(e,t){void 0===t&&(t=!1),c._isFetchingSettings[e]||c._paused&&!t?c._pendingFetch[e]=!0:(c._pendingFetch[e]=!1,c._isFetchingSettings[e]=!0,c._config.getConfig().getEcsParameters().catch(function(){return console.warn("ECS - Failed to fetch ECS fetching parameters"),{}}).then(function(t){return c._ecsClient.getConfig(c._cache.getEcsConfig(),e===a.EcsConfigType.User,t)}).then(function(t){console.log("ECS - Config fetch complete"),c._isFetchingSettings[e]=!1,c._cache.putConfig(t),c._fetchEcsSettingsIfNeeded(e)}))},this._ecsClient=new i.default(this._config,this._skypeTokenData,r,o,s)}return e.prototype.initialize=function(){var e=this;this.updateConfigsToFetch(),this._subscriptionToken=this._skypeTokenData.skypeTokenChanged.subscribe(function(){return e._fetchEcsSettingsIfNeeded(a.EcsConfigType.User)})},e.prototype.dispose=function(){var e,t,n=this._config.getConfig();if(null===(e=n.Killswitches)||void 0===e?void 0:e.isSkypeTokenDataLeakFixEnabled){for(var a=0,i=n.configsToFetch;a<i.length;a++){var r=i[a];clearTimeout(this._pendingTimers[r]),this._pendingTimers[r]=0}null===(t=this._subscriptionToken)||void 0===t||t.unsubscribe(),this._subscriptionToken=null,this._skypeTokenData.skypeTokenChanged.dispose()}},e.prototype.updateConfigsToFetch=function(){for(var e=this._config.getConfig(),t=0,n=e.configsToFetch;t<n.length;t++)(r=n[t])in this._isFetchingSettings||(this._isFetchingSettings[r]=!1),r in this._isFetchingSettings||(this._pendingFetch[r]=!1);for(var a=0,i=e.configsToFetch;a<i.length;a++){var r=i[a],o=this._cache.getEcsConfigByType(r);!o||o.appVersion&&o.appVersion!==e.clientVersion?this._fetchSkypeEcsSettings(r,!0):this._fetchEcsSettingsIfNeeded(r)}},e.prototype.requestUpdate=function(){for(var e=0,t=this._config.getConfig().configsToFetch;e<t.length;e++){var n=t[e];this._fetchSkypeEcsSettings(n)}},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1;for(var e=0,t=this._config.getConfig().configsToFetch;e<t.length;e++){var n=t[e];this._fetchEcsSettingsIfNeeded(n)}},e}();t.default=r},64287:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5259),i=n(95018),r=function(){function e(){this.skypeTokenChanged=new a.default}return e.prototype.putSkypeTokenData=function(e){if(this._data=e,this.isSkypeTokenValid()&&this.skypeTokenChanged.fire(),this.isSkypeTokenValid()&&this._validSkypeTokenDeferral){var t=this._validSkypeTokenDeferral;this._validSkypeTokenDeferral=void 0,t.resolve(void 0)}},e.prototype.isSkypeTokenValid=function(){var e=this._data;return!!e&&!!e.skypeToken&&e.skypeTokenExpiration>Date.now()},e.prototype.getSkypeToken=function(){var e=this._data;if(!e||!e.skypeToken)throw"No Skype Token provided";return e.skypeToken},e.prototype.getSkypeTokenHash=function(e){return void 0===e?0:e.split("").reduce(function(e,t){return(101*e+t.charCodeAt(0))%999727999},e.length)},e.prototype.waitForValidSkypeToken=function(){return this.isSkypeTokenValid()?i.Resolved():(this._validSkypeTokenDeferral||(this._validSkypeTokenDeferral=i.Defer()),this._validSkypeTokenDeferral.promise())},e}();t.default=r},55473:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.getAttributes=function(){return{Source:"ecs_client"}},e}();t.TelemetryEventBase=n},90130:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b){var g=e.call(this)||this;return g._responseTime=t,g._responseCode=n,g._fetchAttempts=a,g._hasValidToken=i,g._serverEndpoint=r,g._fetchDurationValid=o,g._cacheAvailable=s,g._responseSize=c,g._configAge=d,g._configExpired=l,g._fetchStart=u,g._fetchEnd=f,g._isUserConfig=p,g._etag=m,g._timedOut=_,g._responseParsingException=h,g._errorMessage=b,g}return i(t,e),t.prototype.getEventName=function(){return"ecs_tsclient_fetch_config"},t.prototype.getAttributes=function(){var t=e.prototype.getAttributes.call(this);return t.fetch_delay_ms=this._responseTime,t.fetch_response_code=this._responseCode,t.fetch_attempts=this._fetchAttempts,t.authenticated_user=this._hasValidToken,t.url=this._serverEndpoint,t.fetch_duration_valid=this._fetchDurationValid,t.cache_available=this._cacheAvailable,t.response_size=this._responseSize,t.config_age=this._configAge,t.config_expired=this._configExpired,t.fetch_start=this._fetchStart,t.fetch_end=this._fetchEnd,t.is_user_config=this._isUserConfig,this._etag&&(t.fetched_etag=this._etag),void 0!==this._timedOut&&(t.fetch_timed_out=this._timedOut),this._responseParsingException&&(t.fetch_response_parsing_error=this._responseParsingException.message),this._errorMessage&&(t.fetch_error_message=this._errorMessage),t},t}(n(55473).TelemetryEventBase);t.EcsConfigFetchResponse=r},11838:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5259),i=function(){function e(e){this._cache=e,this.telemetryEventAdded=new a.default}return e.prototype.sendTelemetryEvent=function(t){var n=t.getEventName(),a=t.getAttributes(),i=!1,r=this._cache.getEcsConfig();if(r){if(e._containsEcsClientTelemetryConfig(r.config)){var o=r.config.ECSCONFIG;o&&o.ecsClientTelemetry&&(i=!!o.ecsClientTelemetry[n])}}else console.warn("No previously cached ECS telemetry config exists - fallback to sending event"),i=!0;i&&this.telemetryEventAdded.fire(n,a)},e._containsEcsClientTelemetryConfig=function(e){return!!e&&!!e.ECSCONFIG&&!!e.ECSCONFIG.ecsClientTelemetry},e}();t.default=i},96223:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(96662);t.DEFAULT_TIME_GROW_FACTOR=2.718281828459045,t.DEFAULT_TIME_JITTER=.11962656472;var i=function(){function e(e,n,i,r){void 0===i&&(i=t.DEFAULT_TIME_GROW_FACTOR),void 0===r&&(r=t.DEFAULT_TIME_JITTER),this._initialTime=e,this._maxTime=n,this._growFactor=i,this._jitterFactor=r,a.assert(this._initialTime>0,"Initial delay must be positive"),a.assert(this._maxTime>0,"Delay upper bound must be positive"),a.assert(this._growFactor>=0,"Ratio must be non-negative"),a.assert(this._jitterFactor>=0,"Jitter factor must be non-negative"),this.reset()}return e.prototype.reset=function(){this._incrementCount=0,this._currentTime=Math.round(this._initialTime*(1+Math.random()*this._jitterFactor))},e.prototype.getTime=function(){return this._currentTime},e.prototype.getIncrementCount=function(){return this._incrementCount},e.prototype.calculateNext=function(){var e=this._currentTime*this._growFactor;return e>this._maxTime&&(e=this._maxTime),this._jitterFactor<1e-5?this._currentTime=e:this._currentTime=Math.round(Math.random()*e*this._jitterFactor+e),this._currentTime<this._initialTime&&(this._currentTime=this._initialTime),this._currentTime>this._maxTime&&(this._currentTime=this._maxTime),this._incrementCount++,this._currentTime},e.prototype.getTimeAndCalculateNext=function(){var e=this.getTime();return this.calculateNext(),e},e}();t.ExponentialTime=i},27447:function(e,t,n){"use strict";var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(96662),r=n(22982),o=function(){function e(e){this._defaultOptions={excludeEndpointUrl:!1,withCredentials:!1,retries:0},this._endpointUrl=e}return e.prototype._performApiCall=function(e,t,n,o){var s=this;void 0===o&&(o={});var c=a(a({},this._defaultOptions),o);n&&(c.sendData=n),c.eTag&&(c.augmentHeaders||(c.augmentHeaders={}),c.augmentHeaders["If-None-Match"]=c.eTag),c.contentType||(c.contentType=i.isString(c.sendData)?"form":"json");var d=c.excludeEndpointUrl?e:this._endpointUrl+e;return new r.SimpleWebRequest(t,d,c,function(){return s._getHeaders(c)},function(){return s._blockRequestUntil(c)}).start().then(function(e){return s._processSuccessResponse(e),e})},e.prototype._getHeaders=function(e){return{}},e.prototype._blockRequestUntil=function(e){},e.prototype._processSuccessResponse=function(e){},e.prototype.performApiGet=function(e,t){return this.performApiGetDetailed(e,t).then(function(e){return e.body})},e.prototype.performApiGetDetailed=function(e,t){return this._performApiCall(e,"GET",void 0,t)},e.prototype.performApiPost=function(e,t,n){return this.performApiPostDetailed(e,t,n).then(function(e){return e.body})},e.prototype.performApiPostDetailed=function(e,t,n){return this._performApiCall(e,"POST",t,n)},e.prototype.performApiPatch=function(e,t,n){return this.performApiPatchDetailed(e,t,n).then(function(e){return e.body})},e.prototype.performApiPatchDetailed=function(e,t,n){return this._performApiCall(e,"PATCH",t,n)},e.prototype.performApiPut=function(e,t,n){return this.performApiPutDetailed(e,t,n).then(function(e){return e.body})},e.prototype.performApiPutDetailed=function(e,t,n){return this._performApiCall(e,"PUT",t,n)},e.prototype.performApiDelete=function(e,t,n){return this.performApiDeleteDetailed(e,t,n).then(function(e){return e.body})},e.prototype.performApiDeleteDetailed=function(e,t,n){return this._performApiCall(e,"DELETE",t,n)},e}();t.GenericRestClient=o},2008:(e,t,n)=>{"use strict";function a(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),a(n(96223)),a(n(27447)),a(n(22982))},22982:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o,s,c=n(95018),d=n(96662),l=n(96223);function u(e){return!!e&&0===e.indexOf("application/json")}function f(e,t){return t.canceled||!t.statusCode||t.statusCode>=400&&t.statusCode<600?s.DoNotRetry:s.RetryCountedWithBackoff}!function(e){e[e.DontCare=0]="DontCare",e[e.Low=1]="Low",e[e.Normal=2]="Normal",e[e.High=3]="High",e[e.Critical=4]="Critical"}(o=t.WebRequestPriority||(t.WebRequestPriority={})),function(e){e[e.DoNotRetry=0]="DoNotRetry",e[e.RetryUncountedImmediately=1]="RetryUncountedImmediately",e[e.RetryUncountedWithBackoff=2]="RetryUncountedWithBackoff",e[e.RetryCountedWithBackoff=3]="RetryCountedWithBackoff",e[e.PauseUntilResumed=4]="PauseUntilResumed"}(s=t.ErrorHandlingType||(t.ErrorHandlingType={})),t.DefaultOptions={priority:o.Normal},t.SimpleWebRequestOptions={MaxSimultaneousRequests:5,HungRequestCleanupIntervalMs:1e4,setTimeout:function(e,t){return setTimeout(e,t)},clearTimeout:function(e){return clearTimeout(e)}},t.DefaultErrorHandler=f;var p,m=[],_=[],h=[],b=0,g=0,v=function(){function e(e,n,a,i,o){this._action=e,this._url=n,this.options=a,this._getHeaders=i,this._blockRequestUntil=o,this._aborted=!1,this._timedOut=!1,this._paused=!1,this._created=Date.now(),this._finishHandled=!1,this._retryExponentialTime=new l.ExponentialTime(1e3,3e5),this._options=r(r({},t.DefaultOptions),a)}return e.prototype.getPriority=function(){return this._options.priority||o.DontCare},e.checkQueueProcessing=function(){for(var e=function(){var e=m.shift();_.push(e),(e._blockRequestUntil&&e._blockRequestUntil()||c.Resolved()).finally(function(){d.remove(_,e)}).then(function(){h.length<t.SimpleWebRequestOptions.MaxSimultaneousRequests&&!e._aborted?(h.push(e),y._scheduleHungRequestCleanupIfNeeded(),e._fire()):e._enqueue()},function(t){e._respond("_blockRequestUntil rejected: "+t)})};m.length>0&&h.length<t.SimpleWebRequestOptions.MaxSimultaneousRequests;)e()},e._scheduleHungRequestCleanupIfNeeded=function(){h.length>0&&void 0===p?p=t.SimpleWebRequestOptions.setTimeout(this._hungRequestCleanupTimerCallback,t.SimpleWebRequestOptions.HungRequestCleanupIntervalMs):0===h.length&&p&&(t.SimpleWebRequestOptions.clearTimeout(p),p=void 0)},e.prototype._removeFromQueue=function(){d.remove(h,this),d.remove(m,this)},e.prototype._assertAndClean=function(e,t){e||(this._removeFromQueue(),console.error(t),d.assert(e,t))},e.prototype._fire=function(){var n=this;this._xhr=new XMLHttpRequest,this._xhrRequestHeaders={};var a=d.attempt(function(){n._xhr.open(n._action,n._url,!0)});if(a)this._respond(a.toString());else{if(this._options.timeout){var i=g;3!==i&&(this._assertAndClean(!this._requestTimeoutTimer,"Double-fired requestTimeoutTimer"),this._requestTimeoutTimer=t.SimpleWebRequestOptions.setTimeout(function(){n._requestTimeoutTimer=void 0,n._timedOut=!0,n.abort()},this._options.timeout)),(3===i||i<=1)&&(this._xhr.timeout=this._options.timeout,this._xhr.ontimeout=function(){g=3,3===i&&(n._timedOut=!0,n._aborted=!0,n._respond("TimedOut"))})}var r=b;3!==r?(0===r&&(b=1),this._xhr.onreadystatechange=function(){n._xhr&&(3!==n._xhr.readyState||!n._options.streamingDownloadProgress||n._aborted?4===n._xhr.readyState&&(0===r&&1===b&&t.SimpleWebRequestOptions.setTimeout(function(){3!==b&&(b=2)},1e4),n._respond()):n._options.streamingDownloadProgress(n._xhr.responseText))}):this._options.streamingDownloadProgress&&(this._xhr.onreadystatechange=function(){n._xhr&&3===n._xhr.readyState&&n._options.streamingDownloadProgress&&!n._aborted&&n._options.streamingDownloadProgress(n._xhr.responseText)}),2!==r&&(this._xhr.onload=function(){b=3,3===r&&n._respond()},this._xhr.onerror=function(){b=3,3===r&&n._respond()}),this._xhr.onabort=function(){n._aborted=!0,n._respond("Aborted")},this._xhr.upload&&this._options.onProgress&&(this._xhr.upload.onprogress=this._options.onProgress);var o=this._options.acceptType||"json",s=this._options.customResponseType||e._getResponseType(o),c=d.attempt(function(){n._xhr.responseType=s});if(c&&"json"!==s)throw c;y._setRequestHeader(this._xhr,this._xhrRequestHeaders,"Accept",e.mapContentType(o)),this._xhr.withCredentials=!!this._options.withCredentials;var l=this.getRequestHeaders(),u={};if(Object.keys(l).forEach(function(e){var t=l[e],a=e.toLowerCase();"content-type"!==a?"accept"!==a?(n._assertAndClean(!u[a],"Setting duplicate header key: "+u[a]+" and "+e),null!=t?(u[a]=!0,y._setRequestHeader(n._xhr,n._xhrRequestHeaders,e,t)):console.warn('Tried to set header "'+e+'" on request with "'+t+'" value, header will be dropped')):n._assertAndClean(!1,"Don't set Accept with options.headers -- use it with the options.acceptType property"):n._assertAndClean(!1,"Don't set Content-Type with options.headers -- use it with the options.contentType property")}),this._options.sendData){var f=e.mapContentType(this._options.contentType||"json");y._setRequestHeader(this._xhr,this._xhrRequestHeaders,"Content-Type",f);var p=e.mapBody(this._options.sendData,f);this._xhr.send(p)}else this._xhr.send()}},e._setRequestHeader=function(e,t,n,a){e.setRequestHeader(n,a),t[n]=a},e.mapContentType=function(e){return"json"===e?"application/json":"form"===e?"application/x-www-form-urlencoded":e},e.mapBody=function(e,t){if(u(t)){if(!d.isString(e))return JSON.stringify(e)}else if((r=t)&&0===r.indexOf("application/x-www-form-urlencoded")){if(!d.isString(e)&&d.isObject(e)){var n=e;return Object.keys(n).map(function(e){return encodeURIComponent(e)+(n[e]?"="+encodeURIComponent(n[e].toString()):"")}).join("&")}}else if(function(e){return!!e&&0===e.indexOf("multipart/form-data")}(t)){if(d.isObject(e)){var a=new FormData,i=e;return Object.keys(i).forEach(function(e){return a.append(e,i[e])}),a}d.assert(!1,"contentType multipart/form-data must include an object as sendData")}var r;return e},e.prototype.setUrl=function(e){this._url=e},e.prototype.setHeader=function(e,t){this._options.augmentHeaders||(this._options.augmentHeaders={}),t?this._options.augmentHeaders[e]=t:delete this._options.augmentHeaders[e]},e.prototype.getRequestHeaders=function(){var e={};return!this._getHeaders||this._options.overrideGetHeaders||this._options.headers||(e=r(r({},e),this._getHeaders())),this._options.overrideGetHeaders&&(e=r(r({},e),this._options.overrideGetHeaders)),this._options.headers&&(e=r(r({},e),this._options.headers)),this._options.augmentHeaders&&(e=r(r({},e),this._options.augmentHeaders)),e},e.prototype.getOptions=function(){return d.clone(this._options)},e.prototype.setPriority=function(e){this._options.priority!==e&&(this._options.priority=e,this._paused||this._xhr||(d.remove(m,this),this._enqueue()))},e.prototype.resumeRetrying=function(){this._paused?(this._paused=!1,this._enqueue()):d.assert(!1,"resumeRetrying() called but not paused!")},e.prototype._enqueue=function(){var t=this;if(!this._aborted&&!(h.indexOf(this)>=0||_.indexOf(this)>=0||m.indexOf(this)>=0)){var n=m.findIndex(function(e){return e.getPriority()===t.getPriority()&&e._created>t._created||e.getPriority()<t.getPriority()});n>-1?m.splice(n,0,this):m.push(this),e.checkQueueProcessing()}},e._getResponseType=function(e){return"blob"===e?"arraybuffer":"text/xml"===e||"application/xml"===e?"document":"text/plain"===e?"text":"json"},e._hungRequestCleanupTimerCallback=function(){p=void 0,h.filter(function(e){return!(!e._xhr||4!==e._xhr.readyState||(console.warn("SimpleWebRequests found a completed XHR that hasn't invoked it's callback functions, manually responding"),0))}).forEach(function(e){e._respond()}),y._scheduleHungRequestCleanupIfNeeded()},e}();t.SimpleWebRequestBase=v;var y=function(e){function n(t,n,a,i,r){return e.call(this,t,n,a,i,r)||this}return i(n,e),n.prototype.abort=function(){this._aborted?d.assert(!1,"Already aborted "+this._action+" request to "+this._url):(this._aborted=!0,this._retryTimer&&(t.SimpleWebRequestOptions.clearTimeout(this._retryTimer),this._retryTimer=void 0),this._requestTimeoutTimer&&(t.SimpleWebRequestOptions.clearTimeout(this._requestTimeoutTimer),this._requestTimeoutTimer=void 0),this._deferred?(this._respond("Aborted"),this._xhr&&this._xhr.abort()):d.assert(!1,"Haven't even fired start() yet -- can't abort"))},n.prototype.start=function(){var e=this;return this._deferred?(d.assert(!1,"WebRequest already started"),c.Rejected("WebRequest already started")):(this._deferred=c.Defer(),this._deferred.onCancel(function(){e.abort()}),this._enqueue(),this._deferred.promise())},n.prototype._respond=function(e){var n=this;if(!this._finishHandled){this._finishHandled=!0,this._removeFromQueue(),this._retryTimer&&(t.SimpleWebRequestOptions.clearTimeout(this._retryTimer),this._retryTimer=void 0),this._requestTimeoutTimer&&(t.SimpleWebRequestOptions.clearTimeout(this._requestTimeoutTimer),this._requestTimeoutTimer=void 0);var a,i=0;if(this._xhr)try{i=this._xhr.status,a=this._xhr.statusText||e}catch(e){}else a=e||"Browser Error - Possible CORS or Connectivity Issue";var r,o,c={};if(this._xhr){if((this._xhr.getAllResponseHeaders()||"").split(/\r?\n/).forEach(function(e){if(0!==e.length){var t=e.indexOf(":");-1===t?c[e]="":c[e.substr(0,t).toLowerCase()]=e.substr(t+1).trim()}}),!c["content-type"]){var l=this._xhr.getResponseHeader("content-type");l&&(c["content-type"]=l)}if(r=this._xhr.response,c["content-type"]&&u(c["content-type"])&&(!r||!d.isObject(r))&&("text"===this._xhr.responseType||""===this._xhr.responseType)&&this._xhr.responseText)try{r=JSON.parse(this._xhr.responseText)}catch(e){o=e,console.warn("Failed to parse XHR JSON response")}}if(this._xhr&&4===this._xhr.readyState&&(i>=200&&i<300||304===i)){var p={url:this._xhr.responseURL||this._url,method:this._action,requestOptions:this._options,requestHeaders:this._xhrRequestHeaders||{},statusCode:i,statusText:a,headers:c,body:r,responseParsingException:o};this._deferred.resolve(p)}else{var m={url:(this._xhr?this._xhr.responseURL:void 0)||this._url,method:this._action,requestOptions:this._options,requestHeaders:this._xhrRequestHeaders||{},statusCode:i,statusText:a,headers:c,body:r,canceled:this._aborted,timedOut:this._timedOut,responseParsingException:o};this._options.augmentErrorResponse&&this._options.augmentErrorResponse(m);var _=this._options.customErrorHandler?this._options.customErrorHandler(this,m):f(0,m);_!==s.DoNotRetry&&(this._options.retries&&this._options.retries>0||_===s.PauseUntilResumed||_===s.RetryUncountedImmediately||_===s.RetryUncountedWithBackoff)?(_===s.RetryCountedWithBackoff&&this._options.retries--,this._requestTimeoutTimer&&(t.SimpleWebRequestOptions.clearTimeout(this._requestTimeoutTimer),this._requestTimeoutTimer=void 0),this._aborted=!1,this._timedOut=!1,this._finishHandled=!1,this._xhr&&(this._xhr.onabort=null,this._xhr.onerror=null,this._xhr.onload=null,this._xhr.onprogress=null,this._xhr.onreadystatechange=null,this._xhr.ontimeout=null,this._xhr=void 0,this._xhrRequestHeaders=void 0),_===s.PauseUntilResumed?this._paused=!0:_===s.RetryUncountedImmediately?this._enqueue():this._retryTimer=t.SimpleWebRequestOptions.setTimeout(function(){n._retryTimer=void 0,n._enqueue()},this._retryExponentialTime.getTimeAndCalculateNext())):this._deferred.reject(m)}v.checkQueueProcessing()}},n}(v);t.SimpleWebRequest=y},96662:function(e,t){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.assert=function(e,t){if(!e)throw new Error(t)},t.isObject=function(e){return null!==e&&"object"==typeof e},t.isString=function(e){return"string"==typeof e},t.attempt=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];try{return e.apply(void 0,t)}catch(e){return new Error(e)}},t.remove=function(e,t){for(var n=e.length-1;n>=0;n--)e[n]===t&&e.splice(n,1)},t.clone=function(e){return Array.isArray(e)?e.map(t.clone):t.isObject(e)?Object.keys(e).reduce(function(a,i){var r;return n(n({},a),((r={})[i]=t.clone(e[i]),r))},{}):e}},10324:(e,t,n)=>{e.exports=n(2008)},44385:(e,t,n)=>{"use strict";function a(e,t){for(var n="";n.length<e;){var a=16*(null!=t?t:Math.random)();n+=(a|=0).toString(16)}return n}function i(){return crypto.getRandomValues(new Uint32Array(1))[0]/4294967296}n.r(t),n.d(t,{Empty:()=>r,_guidRegEx:()=>o,cryptoRandom:()=>i,generate:()=>s,isValidGuid:()=>u,normalizeDashes:()=>l,normalizeLower:()=>c,normalizeUpper:()=>d});var r="00000000-0000-0000-0000-000000000000",o=/^[0-9a-f]{8}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{12}$/i;function s(e){var t=[];t.push(a(8,e)),t.push(a(4,e));var n="4"+a(3,e);t.push(n);var i=a(4,e),r=parseInt(i[0],16);return r&=3,i=(r|=8).toString(16)+i.substr(1),t.push(i),t.push(a(12,e)),t.join("-")}function c(e,t){return void 0===t&&(t=!1),e?f(e.toLowerCase(),t):""}function d(e,t){return void 0===t&&(t=!1),e?f(e.toUpperCase(),t):""}function l(e,t){if(void 0===t&&(t=!1),e){var n=e.replace(/[^A-Fa-f0-9]/g,"");if(32===n.length)return f("".concat(n.slice(0,8),"-").concat(n.slice(8,12),"-").concat(n.slice(12,16),"-").concat(n.slice(16,20),"-").concat(n.slice(20)),t)}return""}function u(e){return!(!e||!o.test(c(e)))}function f(e,t){var n=e.match(/^\{(.*)\}$/);return n?t?n[0]:n[1]:t?"{"+e+"}":e}},51027:(e,t,n)=>{"use strict";n.d(t,{t:()=>a});var a="Annotations"},35424:(e,t,n)=>{"use strict";n.d(t,{t:()=>a});var a="MicrosoftForms"},72480:(e,t,n)=>{"use strict";n.d(t,{XA:()=>i,eB:()=>a,lS:()=>r});var a=["unknown","referralApp","DevHost","StreamWebApp","OfficeHome","edge","BingAtWork"],i=["unknown","referralView","test","view","CreateCenter","StreamStartPage","postroll","postroll-1","postroll-2","webcapture","Search"],r=["camera","screenrecorder","audio","copilot"]},16244:(e,t,n)=>{"use strict";n.d(t,{M:()=>a,u:()=>r});var a,i=n(40086);function r(e,t,n){var a=n?n(e):new URL(e);if(a)return t.addPsi&&a.searchParams.set("psi",t.playbackSessionId),a.searchParams.set("ccat",t.contextCategory.toString()),a.searchParams.set("correlationid",(0,i.p)()),t.addClient&&a.searchParams.set("client","streamvideoplayer"),t.addNoiseSuppression&&a.searchParams.set("enhanceAudio","true"),t.additionalMetaQsps&&t.additionalMetaQsps.forEach(function(e,t){a.searchParams.set(t,e)}),a.toString();throw new Error("URL is not supported")}!function(e){e[e.Unknown=0]="Unknown",e[e.TeamsMeetingRecording=1]="TeamsMeetingRecording",e[e.Others=2]="Others"}(a||(a={}))},72216:(e,t,n)=>{"use strict";function a(e,t,n,a,i){var r=!!a.getSetting("isEditInEmbedEnabled","boolean"),o=!!a.getSetting("isXplatViewModeEnabled","boolean");if(void 0!==n)return n?"EditTrustedHost":"NoEditTrustedHost";if(o&&i&&"XplatPackage"===i)return"NoEditTrustedHost";if(r)return e?t?"EditTrustedHost":"EditUntrustedHost":t?"NoEditTrustedHost":"NoEditUntrustedHost";var s=!1;return i&&(s="OneUpEmbedPage"!==i&&"OneUpMicroservice"!==i&&"StreamEmbedPage"!==i),e?s?"EditTrustedHost":"EditUntrustedHost":s?"NoEditTrustedHost":"NoEditUntrustedHost"}n.d(t,{A:()=>a})},16131:(e,t,n)=>{"use strict";n.d(t,{PK:()=>c});var a=n(95610),i=n(16244),r=n(254),o=n(71757),s="altManifestMetadata",c=function(e){function t(t){var n=this,a=t.getBaseFeatures();return(n=e.call(this,a)||this).sourceGenerator=t,n._playbackItem=void 0,n.cdnDecryptionKey=void 0,n.getDashPlaybackConfig=function(){var e,t;return n.cdnDecryptionKey||(n.cdnDecryptionKey=(0,o.l)()),{defaultTrackLabel:n._baseFeatures.isNSEnabledInFileInfo?"EnhancedAudio":"OriginalAudio",minVideoBandwidth:n._baseFeatures.isMinVideoBandwidthKillswitchEnabled?12e5:void 0,initialQuality:{useNetworkInformation:!0,defaultBandwidth:1328e3},getSegmentMetadataFromUrl:function(e,t){return function(e,t){var n,a;const i=new URL(e);let r;r="initsegment"===i.searchParams.get("part")?"Init":"mediasegment"===i.searchParams.get("part")?"Media":"Undefined";const o=i.searchParams.get("segmentTime");let s;o&&(s=parseInt(o,10),isNaN(s)&&(s=void 0));const c=null!==(n=i.searchParams.get("quality"))&&void 0!==n?n:void 0,d=null!==(a=i.searchParams.get("track"))&&void 0!==a?a:void 0;let l;return(null==t?void 0:t.track)&&("audio"===d?l="Audio":"video"===d&&(l="Video")),{segmentType:r,representationId:c,segmentStartTime:s,track:l}}(e,t)},cdnDecryptionKey:n.cdnDecryptionKey,videoManifestPostBody:null!==(e=n._playbackItemPostBody)&&void 0!==e?e:void 0,isNSEnabledInFileInfo:null!==(t=n._baseFeatures.isCheckFileInfoDefinedForGetItemCallEnabled)&&void 0!==t?t:n._baseFeatures.isNSEnabledInFileInfo,isWatermarkEnabled:n._baseFeatures.isWatermarkEnabled,isSoftTrimEnabled:n._baseFeatures.isSoftTrimEnabled,isSoftTrimEditsPresent:!!n.mediaEdits}},n.getRequestParameters=function(e,t){return n.sourceGenerator.getRequestParameters(e,t)},n.decorateSingleUrl=function(e,t,a){var r,o,c,d,l=!("PROGRESSIVE"===t),u={contextCategory:a?i.M.TeamsMeetingRecording:i.M.Unknown,playbackSessionId:n.getPlaybackSessionId(),addPsi:!0,addNoiseSuppression:l,addClient:!l,additionalMetaQsps:null===(r=n._context)||void 0===r?void 0:r.additionalMetaQsps},f=new URL(e);if((null===(o=n._playbackItem)||void 0===o?void 0:o.altManifestMetadata)&&l){var p=null===(c=n._playbackItem)||void 0===c?void 0:c.altManifestMetadata;if(n._baseFeatures.isMaxUrlLengthEnabled)p&&e.length>=7500&&(f.searchParams.delete(s),"DASH"===t&&(n._playbackItemPostBody=p));else{var m=function(e){if(!e)return{};try{return JSON.parse(atob(e))}catch(e){return{}}}(p);if(p&&"AudioTracks"in m)if("DASH"===t)f.searchParams.delete(s),n._playbackItemPostBody=p;else{delete m.AudioTracks;var _=function(e){try{return btoa(JSON.stringify(e))}catch(e){return""}}(m);_&&f.searchParams.set(s,_)}}}return l&&n._baseFeatures.isSoftTrimEnabled&&n.mediaEdits&&(f.searchParams.set("mem",btoa(n.mediaEdits)),f.searchParams.set("imer",n._baseFeatures.isSwaEditMode?"false":"true")),l&&n._baseFeatures.enableOif&&f.searchParams.set("oif","4kp"),(0,i.u)(null!==(d=null==f?void 0:f.toString())&&void 0!==d?d:e,u)},n._baseFeatures=a,n._playbackItemPromise=t.itemProvider.getOnePlayerPlaybackItem(),n._mediaType=t.mediaType,n.bootstrappedResources=t.getBootstrappedResources(),n}return(0,a.__extends)(t,e),t.prototype.getDownloadUrls=function(){var e,t,n,r,o;return(0,a.__awaiter)(this,void 0,void 0,function(){var s,c,d,l,u,f,p,m,_=this;return(0,a.__generator)(this,function(h){switch(h.label){case 0:return this._baseFeatures.enableRefactoredLogics?(s=this,[4,this.sourceGenerator.getFeatures()]):(null===(e=this.engineLogger)||void 0===e||e.info("getDownloadUrls","using legacy provider"),[2,this.sourceGenerator.getSimplePlaybackSources(function(e,t,n){return _.decorateSingleUrl(e,t?"DASH":"PROGRESSIVE",n)})]);case 1:return s._context=h.sent(),c=function(e){return _.ifPlaybackTechAllowed(e)},this._baseFeatures.isTechChoiceLogEnabled&&(this.providerTechChoice={hlsAllowed:c("HLS"),dashAllowed:c("DASH"),progAllowed:c("PROGRESSIVE")},void 0!==(null===(t=this._context)||void 0===t?void 0:t.isMediaSourceAvailable)&&(this.providerTechChoice.isMediaSourceAvailable=null===(n=this._context)||void 0===n?void 0:n.isMediaSourceAvailable)),d=this,[4,this._playbackItemPromise];case 2:return d._playbackItem=h.sent(),[4,this.decoratePlaybackItem()];case 3:return h.sent(),this.mediaEdits=(null===(r=this._baseFeatures)||void 0===r?void 0:r.isSoftTrimEnabled)?this._playbackItem.edits:void 0,l=this._playbackItem.isItemTMR,u=!0===l?i.M.TeamsMeetingRecording:i.M.Unknown,(f=function(e,t,n){const{favor:a,reason:i}=function(e,t,n){var a,i,r,o;const s=(n.extension||"").toLowerCase(),c=n.premiumProcessingStatus;let d;return"FullEncode"===c||"Proxy"===c?{favor:!1,reason:"4K"}:(null==t?void 0:t.isStreamingSupported)?t.isProgressivePlaybackAllowed?".webm"===s?{favor:!1,reason:"WF"}:t.isHEVCFavorAdaptiveEnabled&&"hevc"===(null===(i=null===(a=n.video)||void 0===a?void 0:a.codec)||void 0===i?void 0:i.toLowerCase())?{favor:!1,reason:"HF"}:!1===(null==t?void 0:t.isMediaSourceAvailable)||!1===(null==t?void 0:t.isVideoBitrateAllowed)?{favor:!0,reason:"SP"}:(null===(r=null==n?void 0:n.video)||void 0===r?void 0:r.durationInMs)&&n.video.durationInMs>36e5&&n.isItemTMR||(null===(o=null==n?void 0:n.video)||void 0===o?void 0:o.durationInMs)&&n.video.durationInMs>72e5&&!1===n.isItemTMR?{favor:!1,reason:"AD"}:n.audio&&".mp3"===(n.extension||"").toLowerCase()?{favor:!0,reason:"M3"}:("audio"===e&&(d={favor:!0,reason:"OA"}),n.bitrate&&n.bitrate<=3e6&&(d={favor:!0,reason:"BT"}),!n.bitrate&&".mp4"===n.extension&&n.sizeInBytes<=5242880&&(d={favor:!0,reason:"SZ"}),["OA","BT","SZ"].find(e=>e===(null==d?void 0:d.reason))?t.isSoftTrimEnabled&&t.softTrimEdits&&!t.isSwaEditMode?{favor:!1,reason:"ST"}:{favor:!0,reason:null==d?void 0:d.reason}:{favor:!1,reason:"FE"}):{favor:!1,reason:"PS"}:{favor:!0,reason:"SN"}}(e,t,n),r=a;let o=i;return t.shouldPrioritizeHls?!1===(null==t?void 0:t.isVideoBitrateAllowed)?(o="SB",{order:["PROGRESSIVE","HLS","DASH"],reason:i}):(o="SA",{order:a?["HLS","PROGRESSIVE","DASH"]:["HLS","DASH","PROGRESSIVE"],reason:o}):{order:r?["PROGRESSIVE","DASH","HLS"]:["DASH","PROGRESSIVE","HLS"],reason:o}}(this._mediaType,(0,a.__assign)((0,a.__assign)((0,a.__assign)({},this._context),this._baseFeatures),{softTrimEdits:this.mediaEdits}),this._playbackItem)).reason&&this.techReason(f.reason),p=f.order.filter(function(e){var t,n=_.ifPlaybackTechAllowed(e);return n||null===(t=_.engineLogger)||void 0===t||t.warn("getDownloadUrls","filter out source for tech ".concat(e)),n}).map(function(e){return{urls:_.getDecoratedDownloadUrlsForTech(u,e),playbackFormat:e}}),this._baseFeatures.isTechChoiceLogEnabled&&void 0!==this.bootstrappedResources&&(m=null==p?void 0:p[0],this.boostrapTechMismatch=function(e,t){var n,a;if(e&&t)switch(t){case"DASH":return void 0===e.mediaManifest;case"PROGRESSIVE":return void 0===e.mediaElement||!0===(null===(n=null==e?void 0:e.techChoice)||void 0===n?void 0:n.hls);case"HLS":return void 0===e.mediaElement||!0!==(null===(a=null==e?void 0:e.techChoice)||void 0===a?void 0:a.hls);default:return}}(this.bootstrappedResources,null==m?void 0:m.playbackFormat)),void 0!==p&&0!==(null==p?void 0:p.length)||null===(o=this.engineLogger)||void 0===o||o.error("getDownloadUrls","returning empty source array"),[2,p]}})})},t.prototype.getBootstrappedResources=function(){return this.bootstrappedResources},t.prototype.getStats=function(){var e,t,n,a;if(this._baseFeatures.isTechChoiceLogEnabled)return{bootstrapTechChoice:null===(e=this.bootstrappedResources)||void 0===e?void 0:e.techChoice,engineTechChoice:this.providerTechChoice,bootstrapTechMismatch:this.boostrapTechMismatch,mediaEditInfo:this._baseFeatures.isSoftTrimEnabled?null!==(n=null===(t=this.bootstrappedResources)||void 0===t?void 0:t.mediaEditInfo)&&void 0!==n?n:{areMediaEditsPresent:!!this.mediaEdits,shouldRequestMediaEdits:null!==(a=this._baseFeatures.isSwaEditMode)&&void 0!==a&&a}:void 0}},t.prototype.getDecoratedDownloadUrlsForTech=function(e,t){var n,r;return(0,a.__awaiter)(this,void 0,void 0,function(){var o,s=this;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return[4,this.getDownloadUrlsForTech(t)];case 1:return o=a.sent(),null===(n=this.engineLogger)||void 0===n||n.info("getDecoratedDownloadUrlsForTech","Source generator provided urls: tech: ".concat(t,", urlLength: ").concat(null!==(r=null==o?void 0:o.length)&&void 0!==r?r:0)),[2,o.map(function(n){return n.url=s.decorateSingleUrl(n.url,t,e===i.M.TeamsMeetingRecording),n})]}})})},t.prototype.getDownloadUrlsForTech=function(e){var t=this.getIGetDownloadUrlParamsArrayForTech(e);return this.sourceGenerator.getUrlsForParametersList(t,e)},t.prototype.decoratePlaybackItem=function(){return(0,a.__awaiter)(this,void 0,void 0,function(){var e;return(0,a.__generator)(this,function(t){switch(t.label){case 0:return this._playbackItem?[4,this._baseFeatures.premiumProcessingStatusPromise]:[2];case 1:return e=t.sent(),this._playbackItem.premiumProcessingStatus=e,[2]}})})},t.prototype.getIGetDownloadUrlParamsArrayForTech=function(e){if(!this.ifPlaybackTechAllowed(e))return[];switch(e){case"DASH":return this.getDashDownloadUrlParamsArray();case"HLS":case"PROGRESSIVE":return[{playbackType:e}];default:return[]}},t.prototype.getDashDownloadUrlParamsArray=function(){var e=[{playbackType:"DASH"}];return this._baseFeatures.enableCdnOnly?e.unshift({playbackType:"DASH",preferEncryption:!0,forcedHybridCdn:!1}):e.unshift({playbackType:"DASH",preferEncryption:!0,forcedHybridCdn:!0}),e},t.prototype.ifPlaybackTechAllowed=function(e){var t,n,a,i,r,o;switch(e){case"DASH":return!!(null===(t=this._context)||void 0===t?void 0:t.isStreamingSupported);case"HLS":if(this._baseFeatures.isHlsAllowedFixEnabled){var s=document.createElement("video"),c=s.canPlayType("application/vnd.apple.mpegurl");s.remove();var d="maybe"===c||"probably"===c,l=null!==(n=this.sourceGenerator.getPlatformContext().isSafariOrIos)&&void 0!==n&&n,u=!this.sourceGenerator.getPlatformContext().isWindowsAndEdge;return null===(a=this.engineLogger)||void 0===a||a.info("ifPlaybackTechAllowed","canPlayType: ".concat(d,", isSafari/iOS: ").concat(l,", isNotWindowsAndEdge: ").concat(u)),!!(null===(i=this._context)||void 0===i?void 0:i.isHlsPlaybackAllowed)&&d&&u}return!!(null===(r=this._context)||void 0===r?void 0:r.isHlsPlaybackAllowed);case"PROGRESSIVE":return!!(null===(o=this._context)||void 0===o?void 0:o.isProgressivePlaybackAllowed);default:return!0}},t.prototype.techReason=function(e){this._baseFeatures.isTechChoiceLogEnabled&&this.providerTechChoice&&(this.providerTechChoice.reason=e)},t}(r.e)},63741:(e,t,n)=>{"use strict";n.d(t,{J:()=>f});var a=n(95610),i=n(35424),r=n(51027),o=n(85954),s=function(){function e(e,t,n){this.pluginIdentifier=e,this.onePlayerLogger=t,this.userEngagementLogger=n}return e.prototype.measureQos=function(e,t,n){return this.onePlayerLogger.measureQos("PluginEndQos",Object.assign({},this.pluginIdentifier,e),t,n)},e.prototype.appLogic=function(e,t){this.onePlayerLogger.appLogic("PluginAppLogic",Object.assign({},this.pluginIdentifier,{name:e,message:t}))},e.prototype.userAction=function(e){this.userEngagementLogger.userAction(e)},e.prototype.startQos=function(e){return this.onePlayerLogger.startQos("PluginEndQos",Object.assign({},this.pluginIdentifier,e))},e}(),c=n(38267),d=function(){function e(e){this.dataControllers=new Map,this._isInitialized=new c.m(!1),this.onInitialize=e}return Object.defineProperty(e.prototype,"isInitialized",{get:function(){return this._isInitialized},enumerable:!1,configurable:!0}),e.prototype.initialize=function(){this.isInitialized.value||this.onInitialize()},e.prototype.getDataController=function(e){var t;return null===(t=this.onInitialize)||void 0===t||t.call(this),this.dataControllers.get(e)},e.prototype.addDataController=function(e,t){if(this.isInitialized.value)throw new Error("The provider is already finalized and ready.");if(this.dataControllers.has(e))throw new Error("The data controller with ID ".concat(e," is already added."));this.dataControllers.set(e,t)},e.prototype.finalize=function(){if(this.isInitialized.value)throw new Error("The provider is already finalized and ready.");this._isInitialized.value=!0},e}(),l=function(){function e(e,t){this.pluginIdentifier=e,this.onePlayerLogger=t}return e.prototype.initialize=function(e){this.timeInSecondsProvider=e},e.prototype.userAction=function(e){var t,n;this.timeInSecondsProvider||this.onePlayerLogger.warn("PluginError","User action was logged before the time provider was initialized.",(0,a.__assign)({name:"UserActionBeforeInitialize",isExpected:!1,codeLocation:"LateInitializableEngagementLogger.userAction"},this.pluginIdentifier)),this.onePlayerLogger.userAction("PluginButtonAction",Object.assign({},this.pluginIdentifier,{name:e,playbackTimeSec:null!==(n=null===(t=this.timeInSecondsProvider)||void 0===t?void 0:t.call(this))&&void 0!==n?n:0,actionType:"Unknown"}))},e}(),u={pluginName:"Interactivity",pluginVersion:o._},f=function(){function e(e,t,n,a,i,r){this.name="interactivity",this.isInitialized=!1,this.documentId=t,this.getAccessTokenVroom2_1=a,this.interactivityStateProvider=n,this.engagementLogger=new l(u,r),this.log=new s(u,r,this.engagementLogger);var o=Number(e);(isNaN(o)||o<0&&-1!==o)&&(this.log.appLogic("FirstInteractivityPointDefaultOverride","First interactivity point was not set or was invalid. It will be overridden with default value."),o=-1),this.firstInteractivityPointMs=o,this.featureConfiguration={isFormsFeatureEnabled:!!i.getSetting("isInteractivityFormsFeatureEnabled","boolean"),isAnnotationsFeatureEnabled:!!i.getSetting("isInteractivityAnnotationsFeatureEnabled","boolean")}}return e.prototype.initialize=function(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,function(){var i,r,o,s=this;return(0,a.__generator)(this,function(a){switch(a.label){case 0:if(i=this.log.startQos({name:"InitializeInteractivityEngineAdapter"}),!t.topOverlay||!t.bottomOverlay)return i.endUnexpectedError("Fatal","Interactivity wasn't loaded because container elements were not set."),[2];if(!(Object.values(this.featureConfiguration).indexOf(!0)>=0))return i.endExpectedError("Warning","There are no interactivity features enabled. Interactivity cannot be loaded."),[2];if(this.engagementLogger.initialize(function(){var t;return null!==(t=e.currentTimeInSeconds.value)&&void 0!==t?t:0}),this.interactivityStateProvider.value&&this.log.appLogic("MetadataInteractivityStateProviderOverride","Interactivity state provider was present in metadata. It will be overridden."),r=new d(function(){var a=s.log.startQos({name:"LazyInitializeInteractivityEngineAdapter"});s.ensureInitialized(e,t,r,n).then(function(e){e?a.end():a.endExpectedError("Warning","Interactivity was already initialized.")}).catch(function(e){a.endUnexpectedError("Fatal",e)})}),this.interactivityStateProvider.value=r,this.firstInteractivityPointMs<0)return i.endExpectedError("Warning","Interactivity wasn't loaded initially because conditions were not met."),[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.ensureInitialized(e,t,r,n)];case 2:return a.sent(),i.end(),[3,4];case 3:throw o=a.sent(),i.endUnexpectedError("Fatal",o),o;case 4:return[2]}})})},e.prototype.ensureInitialized=function(e,t,n,i){return(0,a.__awaiter)(this,void 0,void 0,function(){return(0,a.__generator)(this,function(a){switch(a.label){case 0:return this.isInitialized?[2,!1]:[4,this.initializeInternal(e,t,n,i)];case 1:return a.sent(),this.isInitialized=!0,[2,!0]}})})},e.prototype.initializeInternal=function(e,t,i,r){return(0,a.__awaiter)(this,void 0,void 0,function(){var o,s,c,d,l,u,f,p=this;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return o=this.log.startQos({name:"LoadInteractivity"}),[4,Promise.all([n.e(64555),n.e(91443),n.e(32895),n.e(49102),n.e(92016),n.e(91360)]).then(n.bind(n,40842))];case 1:s=a.sent().bootstrapOnePlayerInteractivity,a.label=2;case 2:return a.trys.push([2,4,,5]),c=this.log.startQos({name:"InitializeInteractivityEngine"}),[4,s(e,this.log,this.featureConfiguration,[t.topOverlay,t.bottomOverlay],this.firstInteractivityPointMs,function(){return p.getAccessTokenVroom2_1()},this.documentId,r)];case 3:return d=a.sent(),l=d.featuresPromise,u=d.engineInitializationPromise,o.end(),Promise.all([l,u]).then(function(e){var t=e[0];p.onFeaturesLoaded(t,i),c.end()}).catch(function(e){return c.endUnexpectedError("Fatal",e)}),[3,5];case 4:throw f=a.sent(),o.endUnexpectedError("Fatal",f),f;case 5:return[2]}})})},e.prototype.onFeaturesLoaded=function(e,t){var n=e.find(function(e){return e.id===i.t});n&&(t.addDataController(i.t,n),this.log.appLogic("InteractivityFormsDataControllerAdded"));var a=e.find(function(e){return e.id===r.t});a&&(t.addDataController(r.t,a),this.log.appLogic("InteractivityAnnotationsDataControllerAdded")),t.finalize(),this.log.appLogic("InteractivityStateProviderReady")},e}()},99419:(e,t,n)=>{"use strict";n.d(t,{a:()=>s});var a=n(25629),i=n(16131),r=function(){function e(){}return e.prototype.getOnePlayerPlaybackItem=function(){return Promise.resolve({id:"",isDownloadAllowed:!1,extension:"mp4",sizeInBytes:1e6,itemStatus:"Active",isItemTMR:!1})},e.prototype.getOnePlayerItem=function(){return Promise.resolve({fileName:""})},e}(),o=function(){function e(e){var t,n;this.options=e,this.mediaType=null!==(t=e.mediaType)&&void 0!==t?t:"audio",this.itemProvider=null!==(n=e.itemProvider)&&void 0!==n?n:new r}return e.prototype.getFeatures=function(){var e={isProgressivePlaybackAllowed:!0,isStreamingSupported:!0,isHlsPlaybackAllowed:this.canPlayTypeHls(),ProgressiveUrlQspStreamClient:!1,shouldPrioritizeHls:!1,isMediaSourceAvailable:!0};return Promise.resolve(e)},e.prototype.getBaseFeatures=function(){var e;return{enableRefactoredLogics:!0,isMinVideoBandwidthKillswitchEnabled:!1,isFetchOperationErrorLogKillswitchEnabled:!0,useEngineLogger:!0,isPlayerNameHeaderEnabled:!1,isWatermarkEnabled:Boolean(null===(e=this.options)||void 0===e?void 0:e.isWatermarkEnabled)}},e.prototype.getRequestParameters=function(e,t){return this.options.getRequestParameters?this.options.getRequestParameters(e,t):Promise.resolve({url:e,headers:{}})},e.prototype.getPlatformContext=function(){return{}},e.prototype.getSimplePlaybackSources=function(e){throw new Error("Method not implemented.")},e.prototype.getUrlsForParametersList=function(e,t){var n=this;return this.options.delayLoadedUrls?this.options.delayLoadedUrls.then(function(a){return n.transformUrls(e,t,a)}):Promise.resolve(this.transformUrls(e,t,{dashUrl:this.options.dashUrl?[this.options.dashUrl]:void 0,hlsUrl:this.options.hlsUrl?[this.options.hlsUrl]:void 0,progressiveUrl:this.options.progressiveUrl?[this.options.progressiveUrl]:void 0}))},e.prototype.getBootstrappedResources=function(){},e.prototype.transformUrls=function(e,t,n){switch(t){case"DASH":return!n.dashUrl||n.dashUrl.length<=0?[]:this.options.disableDashUrlDecoration?n.dashUrl.map(function(e){return{url:e}}):e.map(function(e){var t=n.dashUrl[0],i=new URL(t),r=i.searchParams;return e.forcedHybridCdn?(r.set(a.RL,"1"),r.set(a.VS,"true")):(r.delete(a.RL),r.delete(a.VS)),{url:t=i.toString(),sourceType:{cdnTech:e.forcedHybridCdn?"HybridCdn":"Origin",transcodingTech:"Ffmpeg"}}});case"HLS":if(n.hlsUrl)return n.hlsUrl.map(function(e){return{url:e}});break;case"PROGRESSIVE":if(n.progressiveUrl)return n.progressiveUrl.map(function(e){return{url:e}})}return[]},e.prototype.canPlayTypeHls=function(){var e=document.createElement("video").canPlayType("application/vnd.apple.mpegurl"),t=navigator.userAgent,n=/(edg|edge)/i.test(t),a=/windows nt/i.test(t);return!("maybe"!==e&&"probably"!==e||a&&n)},e}();function s(e){if(!(e.dashUrl||e.hlsUrl||e.progressiveUrl||e.delayLoadedUrls))throw new Error("Video can not be played, no url found");var t=new o(e),n=new i.PK(t);return e.enablePrefetch&&n.getPlaybackSources().catch(function(e){}),n}},85954:(e,t,n)=>{"use strict";n.d(t,{_:()=>r});var a=window.Flight&&window.Flight.version?window.Flight.version:void 0,i=window._spModuleLink&&window._spModuleLink.buildNumber?window._spModuleLink.buildNumber:void 0,r=a||i||"53.9.3"},78987:(e,t,n)=>{"use strict";n.d(t,{u:()=>i});var a=n(59213);function i(){(0,a.QX)("@msstream/one-player#noop-create-html",{createHTML:function(e){return e}})}},254:(e,t,n)=>{"use strict";n.d(t,{e:()=>O});var a=n(95610),i=n(71757);function r(e){var t;return null===(t=null==e?void 0:e.getElementsByTagName("SegmentTimeline")[0])||void 0===t?void 0:t.getElementsByTagName("S")}const o="Representation",s="bandwidth";function c(e,t,n){return{prefetchVideoSegmentQuality:null==e?void 0:e.id,prefetchAudioSegmentQuality:null==t?void 0:t.id,prefetchDownlinkBps:n}}function d(e,t,n){return n>=e/.5&&e>t}async function l(e,t){var n;if(!t.getDashPlaybackConfig)return;let a;if(t.getRequestParameters)try{a=await t.getRequestParameters(e)}catch(e){throw(i=e).name="getRequestParamsAsyncFailure",i}var i;const r=a?{headers:a.headers}:{},o=null===(n=t.getDashPlaybackConfig())||void 0===n?void 0:n.videoManifestPostBody;o&&(r.method="POST",r.body=o),t.isPlayerNameHeaderEnabled&&(r.headers=Object.assign(Object.assign({},null==a?void 0:a.headers),{pn:"hostApp-OnePlayer-Web"}));const s=await fetch(e,r),c=await s.arrayBuffer();return{text:(d=c,(new TextDecoder).decode(new Uint8Array(d))),arrBuf:c,status:s.status,statusText:s.statusText,headers:s.headers,url:s.url};var d}function u(e,t,n,a,i,o,s,c,d,l){var u,p;let m=null===(u=null==t?void 0:t.getElementsByTagName("SegmentTemplate")[0])||void 0===u?void 0:u.getAttribute("Init"===e?"initialization":"media");m=new URL(m.replace("$RepresentationID$",null==n?void 0:n.id),a).toString();let _=0;"Media"===e&&(i.isSoftTrimEnabled&&i.isSoftTrimEditsPresent?_=function(e){const t=r(e);if(t){const e=function(e){const t=[];return e.forEach(e=>{const n=parseInt(e.getAttribute("t")||"0",10),a=isNaN(n)?0:n;t.push({time:a})}),t}(Array.from(t));if(e)return e[0].time}return 0}(t):void 0!==d&&0!==d&&(_=function(e,t){var n;t=Math.max(0,t-2);const a=parseInt((null===(n=null==e?void 0:e.getElementsByTagName("SegmentTemplate")[0])||void 0===n?void 0:n.getAttribute("timescale"))||"0",10),i=r(e);let o;return i?(o=function(e){const t=[];return e.forEach(e=>{const n=parseInt(e.getAttribute("d")||"0",10),a=parseInt(e.getAttribute("r")||"0",10);t.push({duration:n,repeatCount:a})}),t}(Array.from(i)),function(e,t,n){let a=0,i=0;const r=t*n;for(const t of e){if(0===t.duration)return a;if(i=Math.floor((r-a)/t.duration),i<=t.repeatCount)return a+t.duration*i;a+=t.duration*(t.repeatCount+1)}return a}(o,t,a)):0}(t,d)),m=new URL(m.replace("$Time$",_.toString()),a).toString()),c&&(m=new URL(m+"&generateHMAC=true").toString());const h=null==n?void 0:n.id,b=o(e,t);return{matcher:t=>{const n=i.getSegmentMetadataFromUrl(t),a=(null==n?void 0:n.segmentType)===e,r=(null==n?void 0:n.representationId)===h,o="Init"===e||(null==n?void 0:n.segmentStartTime)===_;return a&&r&&o},qosName:b,segmentData:null!==(p=null==s?void 0:s.measuredFetchOperation(b,{getResponsePromise:()=>f(m,l),url:m}))&&void 0!==p?p:f(m,l)}}async function f(e,t){let n;t&&(n=await t(e));const a=await fetch((null==n?void 0:n.url)||e,{headers:null==n?void 0:n.headers});return{arrBuf:await a.arrayBuffer(),status:a.status,statusText:a.statusText,headers:a.headers,url:e}}function p(e,t){return!!e&&!0===e&&0===t}function m(e,t){var n,a,r,f,m,_,h=null===(n=t.prefetchedResources)||void 0===n?void 0:n.mediaManifest,b=t.dependencies.prefetchQosTracker;_=h?b?b.measuredFetchOperation("PrefetchManifestByBootstrapping",{getResponsePromise:function(){return h}}):h:b?b.measuredFetchOperation("PrefetchManifestBySourceProvider",{getResponsePromise:function(){return l(e,t)}}):l(e,t);var g=null===(a=t.prefetchedResources)||void 0===a?void 0:a.mediaSegments;return m=void 0!==g?g.then(function(e){if(null==e?void 0:e.segments)return{mediaBitrate:e.mediaBitrate,metadata:e.metadata,segments:e.segments.map(function(e){return{matcher:e.matcher,segmentData:e.qosName&&b?b.measuredFetchOperation(e.qosName,{getResponsePromise:function(){return e.segmentData}}):e.segmentData}})}}):async function(e,t){var n,a;const i=t.getDashPlaybackConfig(),r=t.isHybridCdnRequested;if(!i)return;const l=null===(n=await e)||void 0===n?void 0:n.text;if(!l)return;const f=t.dependencies.secureXmlParse(l,"@msstream/one-player#noop-create-html",function(e){const t=e.getLogger("dashPrefetchService");return e=>null==t?void 0:t.error("secureXmlParse",e)}(t.dependencies));if(!f)return;const m=null===(a=f.documentElement.getElementsByTagName("BaseURL")[0])||void 0===a?void 0:a.innerHTML,_=function(e,t){let n,a;return Array.from(e.documentElement.getElementsByTagName("AdaptationSet")).forEach(e=>{var i;if("video"===e.getAttribute("contentType")&&void 0===a)a=e;else{const a=null===(i=e.getElementsByTagName("Label")[0])||void 0===i?void 0:i.innerHTML;t.defaultTrackLabel&&a&&!a.includes(t.defaultTrackLabel)||void 0!==n||(n=e)}}),{audioAdaptationSet:n,videoAdaptationSet:a}}(f,i);if(void 0===_.audioAdaptationSet&&void 0===_.videoAdaptationSet)return;const h=function(e){var t;if(e.initialQuality.useNetworkInformation){const e=null===(t=null===navigator||void 0===navigator?void 0:navigator.connection)||void 0===t?void 0:t.downlink;if(e&&!isNaN(e))return 1e6*e}}(i),{fetchInfo:b,totalBandwidth:g,metadata:v}=function(e,t,n){var a;const i=null!=n?n:null===(a=null==t?void 0:t.initialQuality)||void 0===a?void 0:a.defaultBandwidth;let r=0;const{audioAdaptationSet:l,videoAdaptationSet:u}=e,f=l?l.getElementsByTagName(o):[],p=u?Array.from(u.getElementsByTagName(o)):[];let m=f?f[0]:void 0,_=p?p[0]:void 0;r=parseInt((null==m?void 0:m.getAttribute(s))||"0",10)+parseInt((null==_?void 0:_.getAttribute(s))||"0",10);const h=m&&_?0:-1;for(let e=h;e<(null==f?void 0:f.length);e++)for(let t=h;t<(null==p?void 0:p.length);t++){const n=e>=0?parseInt(f[e].getAttribute(s)||"0",10):0,a=t>=0?parseInt(p[t].getAttribute(s)||"0",10):0,o=n+a;d(o,r,i)&&(r=o,m=0!==n?f[e]:void 0,_=0!==a?p[t]:void 0)}const b=[];return l&&m&&b.push({adaptationSet:l,representation:m}),u&&_&&b.push({adaptationSet:u,representation:_}),{fetchInfo:b,totalBandwidth:r,metadata:c(_,m,n)}}(_,i,h),y=t.startTimeInSeconds;return{mediaBitrate:g,segments:b.map((e,n)=>[u("Init",e.adaptationSet,e.representation,m,i,t.prefetchQosGetter,t.dependencies.prefetchQosTracker,p(r,n),void 0,t.getRequestParameters),u("Media",e.adaptationSet,e.representation,m,i,t.prefetchQosGetter,t.dependencies.prefetchQosTracker,void 0,y,t.getRequestParameters)]).reduce((e,t)=>e.concat(t)),metadata:v}}(_,t),t.isCdnRequested?{mediaManifest:_,mediaSegments:m,contentProtectionKey:(0,i.X)(_,null!==(r=t.getRequestParameters)&&void 0!==r?r:function(e){return Promise.resolve({url:e})},t.dependencies.prefetchQosTracker,null===(f=t.getDashPlaybackConfig())||void 0===f?void 0:f.cdnDecryptionKey)}:{mediaManifest:_,mediaSegments:m}}function _(e,t){return"video"===t.getAttribute("contentType")?"Init"===e?"PrefetchVideoInitSegmentBySourceProvider":"PrefetchVideoMediaSegmentBySourceProvider":"Init"===e?"PrefetchAudioInitSegmentBySourceProvider":"PrefetchAudioMediaSegmentBySourceProvider"}var h=n(84122);function b(e,t,n){return t.measuredOperation("PreloadNativeVideoBySourceProvider",function(){return function(e,t,n,a){var i=(0,h.v3)();if(i.crossOrigin="anonymous",i.src=e,i.load(),t){var r=function(){i.currentTime=t,i.removeEventListener("loadedmetadata",r)};i.addEventListener("loadedmetadata",r)}return{mediaElement:i}}(e,n)})}var g=n(25629),v=n(8684),y=n(52852),S=function(){function e(e){this.isFetchOperationErrorLogKillswitchEnabled=e,this.engineLogger=(0,y.j)("PrefetchQosTracker"),this.perfMeasures=[]}return e.prototype.wireQosEvents=function(e){var t=this;this.log=e,this.perfMeasures.length>0&&(this.perfMeasures.forEach(function(n){D(n,e,t.engineLogger)}),this.perfMeasures=[])},e.prototype.measuredFetchOperation=function(e,t){var n=this,a=(0,v.U)(e),i=t.getResponsePromise(),r=this.isFetchOperationErrorLogKillswitchEnabled?i.then(function(t){return n.getPerfMeasurePromise(t,a,e)},function(t){return(0,v.V)(a,{result:"Fatal",isExpected:!1,message:"Fetch Failure. Error: ".concat(t.message)},{name:e})}):i.then(function(t){return n.getPerfMeasurePromise(t,a,e)});return this.processQosResult(r),i},e.prototype.measuredOperation=function(e,t){var n,a,i=(0,v.U)(e);try{n=t(),a={result:"Success"}}catch(e){a={message:e.message,result:"Warning",isExpected:!1}}return this.processQosResult(Promise.resolve((0,v.V)(i,a,{name:e}))),n},e.prototype.processQosResult=function(e){this.log?D(e,this.log,this.engineLogger):this.perfMeasures.push(e)},e.prototype.getPerfMeasurePromise=function(e,t,n){var a=(null==e?void 0:e.status)||0;return a>=200&&a<=300?(0,v.V)(t,{result:"Success"},{name:n}):(0,v.V)(t,{result:"Warning",isExpected:!1,message:"Fetch Failure with Status Code "+a},{name:n})},e}();function D(e,t,n){e.then(function(e){var n;"measure"===(null===(n=e.measure)||void 0===n?void 0:n.entryType)&&t.completedQos("PlayerInitEndQos",e.measure,e.result,e.data)}).catch(function(e){n?n.error("logQosEvent",String(e)):console.debug(e)})}var I=n(40086),x=n(59213),C={DASH:"application/dash+xml",HLS:"application/vnd.apple.mpegurl",PROGRESSIVE:"video/mp4"},O=function(){function e(e){this.features=e,this.startTimeInSeconds=0,this.enableStartTimePrefetch=!1,e.useEngineLogger&&(this.engineLogger=(0,y.j)("PlaybackSourceProvider")),e.playbackSessionId&&(this.playbackSessionId=e.playbackSessionId),e.startTimeInSeconds&&(this.startTimeInSeconds=e.startTimeInSeconds),e.enableStartTimePrefetch&&(this.enableStartTimePrefetch=e.enableStartTimePrefetch),this.qosTracker=new S(this.features.isFetchOperationErrorLogKillswitchEnabled)}return e.prototype.getPlaybackSessionId=function(){return this.playbackSessionId||(this.playbackSessionId=(0,I.p)()),this.playbackSessionId},e.prototype.getPlaybackSources=function(){return(0,a.__awaiter)(this,void 0,void 0,function(){var e,t,n,i,r,o=this;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return this.features.isDupPbSrcFixDisabled?this.playbackSources?[3,2]:(e=this,t=this.transformSource,[4,this.getDownloadUrls()]):[3,3];case 1:e.playbackSources=t.apply(this,[a.sent()]),a.label=2;case 2:return[3,5];case 3:return this.playbackSourcesPromise||this.playbackSources||(this.playbackSourcesPromise=this.getDownloadUrls().then(function(e){return o.transformSource(e)})),this.playbackSources?[3,5]:(n=this,[4,this.playbackSourcesPromise]);case 4:n.playbackSources=a.sent(),a.label=5;case 5:if(void 0===this.playbackSources||0===this.playbackSources.length)throw new Error("No supported playback sources.");return[4,this.features.enablePrefetchPromise];case 6:return i=a.sent(),!this.prefetchedResourcesPromise&&i&&(this.prefetchedResourcesPromise=this.doPrewarm(this.playbackSources)),[4,this.prefetchedResourcesPromise];case 7:return r=a.sent(),this.playbackSources[0].prefetchedResources=r,[2,this.playbackSources]}})})},e.prototype.wireQosEvents=function(e){this.qosTracker.wireQosEvents(e)},e.prototype.transformSource=function(e){var t,n=this,a=null===(t=this.getDashPlaybackConfig())||void 0===t?void 0:t.defaultTrackLabel;return e.map(function(e){var t,i,r=e.mimeType||C[e.playbackFormat];if(r){var o="DASH"===e.playbackFormat,s="HLS"===e.playbackFormat;return{playbackFormat:e.playbackFormat,urls:o?(0,g.wY)(e.urls,n.features):e.urls,defaultTrackLabel:o||s?a:void 0,mimeType:r}}null===(t=n.engineLogger)||void 0===t||t.error("transformSource","Can not detect mimetype. playbackFormat: ".concat(e.playbackFormat,", mime: ").concat(null!==(i=e.mimeType)&&void 0!==i?i:"mis"))}).filter(function(e){return void 0!==e})},e.prototype.doPrewarm=function(e){return(0,a.__awaiter)(this,void 0,void 0,function(){var t,n,i,r,o,s;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return 0===e.length?[2]:[4,(t=e[0]).urls];case 1:if(!(n=a.sent())||0===n.length)return[2];switch(i=n[0],r=i.sourceType?"HybridCdn"===i.sourceType.cdnTech:i.url.indexOf(g.RL+"=1")>=0&&i.url.indexOf(g.VS+"=true")>=0,o=i.sourceType?"Cdn"===i.sourceType.cdnTech:i.url.indexOf(g.RL+"=1")>=0,s=this.getBootstrappedResources(),t.playbackFormat){case"DASH":return[2,m(i.url,{getDashPlaybackConfig:this.getDashPlaybackConfig,getRequestParameters:this.getRequestParameters,isCdnRequested:o,isHybridCdnRequested:r,prefetchedResources:s,startTimeInSeconds:this.startTimeInSeconds,isPlayerNameHeaderEnabled:this.features.isPlayerNameHeaderEnabled,dependencies:{getLogger:function(e){return(0,y.j)(e)},prefetchQosTracker:this.qosTracker,secureXmlParse:x.SA},prefetchQosGetter:_})];case"HLS":case"PROGRESSIVE":return[2,(null==s?void 0:s.mediaElement)?this.qosTracker.measuredOperation("PreloadNativeVideoByBootstrapping",function(){return(0,h.Es)(s.mediaElement),{mediaElement:s.mediaElement}}):this.enableStartTimePrefetch?b(i.url,this.qosTracker,this.startTimeInSeconds):b(i.url,this.qosTracker)]}return[2]}})})},e}()},71757:(e,t,n)=>{"use strict";n.d(t,{l:()=>u,X:()=>l});var a=n(95610),i=n(52852),r=n(59213),o=function(e){for(var t=e.substring(2),n=new Uint8Array(t.length/2),a=0;a<t.length;a+=2){var i=parseInt(t.substr(a,2),16);if(isNaN(i))throw new Error("Invalid hexString");n[a/2]=i}return n};function s(e){(0,i.j)("contentProtectionParser").error("secureXmlParse",e)}var c=function(){function e(e,t,n){this.valid=!0,this.keyId=e,this.iv=t,this.keyBuffer=n}return e.prototype.isValid=function(){return this.valid},e.prototype.setIsValid=function(e){this.valid=e},e.prototype.getKeyInfo=function(){return{keyId:this.keyId,iv:this.iv,keyBuffer:this.keyBuffer}},e}(),d=(0,i.j)("videoProtectionKey");function l(e,t,n,i){return(0,a.__awaiter)(this,void 0,void 0,function(){var r,o,s;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return[4,p(e)];case 1:return(r=a.sent())?i&&function(e,t){var n=e.getKeyInfo();return n.keyBuffer&&n.keyId?n.keyId===t.keyId||(d.error("isProvidedKeyValid","Key mismatch: provided key and manifest key Ids do not match"),e.setIsValid(!1),!1):(d.error("isProvidedKeyValid","keyBuffer and keyId are required fields"),e.setIsValid(!1),!1)}(i,r)?(o=i.getKeyInfo(),s=Promise.resolve({arrBuf:o.keyBuffer,headers:new Headers,status:200,statusText:"OK",url:"",timeSpentInMs:0}),[2,n?n.measuredOperation("PageContextVideoProtectionKeyBySourceProvider",function(){return s}):s]):[2,f(r,t,n)]:(d.error("retrieveCdnVideoProtectionKey","Prefetch manifest does not have the content protection element"),[2])}})})}function u(){var e=window.g_fileInfo;if(e){var t=e.EncKey;if("string"==typeof t&&t.trim()){var n=JSON.parse(t);if("string"==typeof n.Key&&n.Key.trim())try{var a=Uint8Array.from(atob(n.Key),function(e){return e.charCodeAt(0)});return 16!==a.length?void d.error("getEncryptionKey","Invalid key object in page context: Key field does not match expected size"):new c(n.Kid,n.IV?Uint8Array.from(atob(n.IV),function(e){return e.charCodeAt(0)}):void 0,a)}catch(e){return void d.error("getEncryptionKey","Unexpected error while decoding key object in page context: "+e)}else d.error("getEncryptionKey","Invalid key object in page context: Key field is not an string or is empty")}else d.warn("getEncryptionKey","No key found in page context")}}function f(e,t,n){var i;return(0,a.__awaiter)(this,void 0,void 0,function(){var r,o;return(0,a.__generator)(this,function(s){switch(s.label){case 0:return r=e.keyUri.toString(),[4,t(r)];case 1:return o=null!==(i=s.sent().url)&&void 0!==i?i:r,[2,n&&n.measuredFetchOperation("PrefetchVideoProtectionKeyBySourceProvider",{getResponsePromise:function(){return e=o,(0,a.__awaiter)(void 0,void 0,void 0,function(){var t,n,i,r,o;return(0,a.__generator)(this,function(a){switch(a.label){case 0:if(void 0===e)throw new Error("Illegal argument error: keyUri is undefined");return[4,fetch(e)];case 1:return[4,(t=a.sent()).arrayBuffer()];case 2:return n=a.sent(),i=t.headers,r=t.status,o=t.statusText,[2,{headers:i,status:r,statusText:o,url:e,arrBuf:n}]}})});var e},url:r})]}})})}function p(e){var t;return(0,a.__awaiter)(this,void 0,void 0,function(){var n,c,d;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return[4,e];case 1:return(n=null===(t=a.sent())||void 0===t?void 0:t.text)?(c=function(e){var t=new Map,n=function(e){return(0,r.SA)(e,"@msstream/one-player#noop-create-html",s)||new Document}(e),a=(0,i.j)("contentProtectionParser"),c=Array.from(n.getElementsByTagName("ContentProtection"));return 0===c.length||Array.from(c).forEach(function(e){return function(e,t,n){var a;if(!((null===(a=null==e?void 0:e.children)||void 0===a?void 0:a.length)<3)){var i=e.getAttribute("schemeIdUri"),r=e.children[0].getAttribute("schemeIdUri"),s=e.children[1].getAttribute("keySystemUri"),c=e.children[2].getAttribute("keyUriTemplate"),d=e.children[2].getAttribute("IV");if(function(e,t,n){return"urn:mpeg:dash:sea:2012"===e&&"urn:mpeg:dash:sea:aes128-cbc:2013"===t&&"urn:mpeg:dash:sea:keysys:http:2013"===n}(i,r,s))if(null!==c&&function(e){try{return new URL(e).searchParams.has("kid")}catch(e){return!1}}(c)){var l=new URL(c),u=l.searchParams.get("kid");t.has(u)||(null!==d&&function(e){return/0x[A-Fa-f0-9]{32}/.test(e)}(d)?t.set(u,{keyId:u,keyUri:l,iv:o(d)}):n?n.error("addToKeyContentProtectionMap","ContentProtection IV is not valid hex string"):console.error("ContentProtection IV is not valid hex string"))}else n?n.error("addToKeyContentProtectionMap","ContentProtection keyUriTemplate is not a valid URI"):console.error("ContentProtection keyUriTemplate is not a valid URI");else n?n.error("addToKeyContentProtectionMap","ContentProtection does not match any known schema"):console.error("ContentProtection does not match any known schema")}}(e,t,a)}),t}(n),0===c.size?[2,void 0]:(d=c.values().next().value).keyUri?[2,d]:[2,void 0]):[2,void 0]}})})}},25629:(e,t,n)=>{"use strict";n.d(t,{RL:()=>i,VS:()=>r,wY:()=>o});var a=n(95610),i="enableCdn",r="hybridPlayback";function o(e,t){return(0,a.__awaiter)(this,void 0,void 0,function(){var n;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return[4,e];case 1:if(!(n=a.sent()))return[2,Promise.resolve(void 0)];if(!t.enableCdnOnly){if(!t.isCdnFallbackFixEnabled)return[2,n.map(function(e){return e.url=s(e.url),e})];n[0].url=s(n[0].url)}return[2,n]}})})}function s(e){var t=new URL(e),n=t.searchParams,a=n.get(i),o=n.get(r);return a&&"1"===a||t.searchParams.append(i,"1"),o&&"true"===o||t.searchParams.append(r,"true"),t.toString()}},52852:(e,t,n)=>{"use strict";n.d(t,{W:()=>i,j:()=>r});var a=n(95610),i=new(function(){function e(){this.inMemoryLogStore=[]}return e.prototype.dispose=function(){this.inMemoryLogStore=[]},e.prototype.getEntries=function(e){var t=(0,a.__spreadArray)([],this.inMemoryLogStore,!0);return!0===e&&(this.inMemoryLogStore=[]),t},e.prototype.error=function(e,t,n,a){this.addToStore("error",e,t,n,a)},e.prototype.info=function(e,t,n,a){this.addToStore("info",e,t,n,a)},e.prototype.warn=function(e,t,n,a){this.addToStore("warn",e,t,n,a)},e.prototype.debug=function(e,t,n,a){this.addToStore("debug",e,t,n,a)},e.prototype.addToStore=function(e,t,n,a,i){this.inMemoryLogStore.length>=5e4&&this.inMemoryLogStore.shift();var r="[".concat(Date.now(),"] - ").concat(e," - ").concat(t," - ").concat(n,": ").concat(a).concat(void 0!==i?" - ".concat(i):"");this.inMemoryLogStore.push(r),console.log(r)},e}()),r=function(e){return{error:function(t,n,a){return i.error(e,t,n,a)},info:function(t,n,a){return i.info(e,t,n,a)},warn:function(t,n,a){return i.warn(e,t,n,a)},debug:function(t,n,a){return i.warn(e,t,n,a)}}}},84122:(e,t,n)=>{"use strict";n.d(t,{Es:()=>i,LS:()=>o,S:()=>r,v3:()=>a});var a=function(){var e=document.createElement("video");return i(e),e},i=function(e){e.style.width="100%",e.style.height="100%",e.style.top="0",e.style.position="absolute",e.setAttribute("playsInline",""),e.setAttribute("preload","auto"),e.classList.add("engine-video-root"),e.crossOrigin="anonymous"},r=function(e){if(!e||0===e.buffered.length)return"[0,0]";for(var t=e.buffered,n="",a=0;a<t.length;a++)""!==n&&(n+=","),n+="[".concat(t.start(a),",").concat(t.end(a),"]");return n};function o(e,t){if(e&&t){var n=e.buffered;if(n&&!(n.length<=0)){var a=n.end(0)/e.duration*t;if(!isNaN(a))return Math.round(a)}}}},31924:(e,t,n)=>{"use strict";n.d(t,{g:()=>a});var a=function(e,t,n,a,i,r,o,s){this.level=e,this.isExpected=t,this.scenario=n,this.knownError=a,this.originalError=i,this.message=r,this.playbackSessionId=o,this.hostSessionId=s}},8684:(e,t,n)=>{"use strict";n.d(t,{U:()=>i,V:()=>r});var a=n(40086),i=function(e){var t,n="".concat(e,"-").concat((0,a.p)());return performance&&performance.mark&&performance.getEntriesByName?(performance.mark(n),t=performance.getEntriesByName(n)[0]):t=new Date,t},r=function(e,t,n){var a;return"mark"===e.entryType?(performance.measure(e.name,e.name),a=performance.getEntriesByName(e.name,"measure")[0]):a=[e,new Date],{measure:a,result:t,data:n}}},13331:(e,t,n)=>{"use strict";n.d(t,{y:()=>i});var a=function(e){this.callback=e,this.willBeUnregistered=!1,this.unregisterOnNextCall=!1},i=function(){function e(e){this.onCallbackError=e,this._observers=new Array}return e.prototype.subscribe=function(e,t){if(void 0===t&&(t={}),!e)return function(){};var n=new a(e);return n.unregisterOnNextCall=!!t.unregisterOnFirstCall,this._observers.push(n),this.internalRemove.bind(this,n)},e.prototype.notify=function(e){for(var t=0,n=this._observers;t<n.length;t++){var a=n[t];if(!a.willBeUnregistered){try{a.callback(e)}catch(e){this.onCallbackError&&this.onCallbackError(e)}a.unregisterOnNextCall&&this.deferUnregister(a)}}},e.prototype.unsubscribeAll=function(){this._observers.length=0},e.prototype.deferUnregister=function(e){var t=this;e.unregisterOnNextCall=!1,e.willBeUnregistered=!0,setTimeout(function(){t.internalRemove(e)},0)},e.prototype.internalRemove=function(e){var t=this._observers.indexOf(e);return-1!==t&&(this._observers.splice(t,1),!0)},e}()},38267:(e,t,n)=>{"use strict";n.d(t,{m:()=>i});var a=n(13331),i=function(){function e(e,t){this._value=e,this.onCallbackError=t,this._observable=new a.y(t)}return e.prototype.unsubscribeAll=function(){this._observable.unsubscribeAll()},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){e!==this._value&&(this._value=e,this._observable.notify(e))},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e,t){var n=!(null==t?void 0:t.ignoreCurrentValue);if(n)try{e(this._value)}catch(e){this.onCallbackError&&this.onCallbackError(e)}return(null==t?void 0:t.unregisterOnFirstCall)&&n?function(){}:this._observable.subscribe(e,t)},e}()},59213:(e,t,n)=>{"use strict";function a(e){var t=!1,n="";return e instanceof HTMLElement||e instanceof SVGElement?n="XML document contains non-XML tags":e instanceof Element&&"script"===e.tagName?n="XML document embeds script tags":"#cdata-section"===e.nodeName?n="XML document embeds CDATA tags":"#text"===e.nodeName&&function(e){return(new XMLSerializer).serializeToString(e)!==e.textContent}(e)?n="XML document contains forbidden characters":t=!0,{isValid:t,message:n}}n.d(t,{QX:()=>o,ci:()=>s,N7:()=>c,SA:()=>d});var i=new Map;function r(){return void 0!==window.trustedTypes}function o(e,t){if(r()&&!i.has(e))try{i.set(e,window.trustedTypes.createPolicy(e,t))}catch(t){console.warn("Unable to create policy ".concat(e,": ").concat(t))}}function s(e,t,n){void 0===n&&(n=void 0);var a=new DOMParser;if(r()&&n&&i.has(n)){var o=i.get(n).createHTML(e);return o?a.parseFromString(o,t):void 0}return a.parseFromString(e,t)}function c(e,t){return void 0===t&&(t=void 0),r()&&t&&i.has(t)?i.get(t).createHTML(e):e}function d(e,t,n){void 0===t&&(t=void 0);var i=s(e,"text/xml",t);if(i)return function(e,t){if(void 0!==e)if(e.documentElement){if(!e.getElementsByTagName("parsererror").length){for(var n,i=document.createNodeIterator(e,NodeFilter.SHOW_ALL);n=i.nextNode();){var r=a(n),o=r.isValid,s=r.message;if(!o)return void(null==t||t(s))}return e}null==t||t("XML parser error found")}else null==t||t("XML document was empty")}(i,n)}},40086:(e,t,n)=>{"use strict";n.d(t,{p:()=>r,t:()=>o});var a=n(40592);const i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function r(){return(0,a.Z)()}function o(e){return"string"==typeof(t=e)&&i.test(t);var t}},41362:(e,t,n)=>{"use strict";n.d(t,{G:()=>i});const a=JSON.parse('{"clcids":{"ar-SA":"0x401","bg-BG":"0x402","ca-ES":"0x40A","cs-CZ":"0x405","da-DK":"0x406","de-DE":"0x407","el-GR":"0x408","en-GB":"0x809","es-ES":"0x40A","es-MX":"0x40A","et-EE":"0x425","eu-ES":"0x40A","fi-FI":"0x40B","fr-CA":"0x40C","fr-FR":"0x40C","gl-ES":"0x40A","he-IL":"0x40D","hr-HR":"0x41A","hu-HU":"0x40E","id-ID":"0x421","it-IT":"0x410","ja-JP":"0x411","kk-KZ":"0x419","ko-KR":"0x412","lt-LT":"0x427","lv-LV":"0x426","nb-NO":"0x414","nl-NL":"0x413","nn-NO":"0x414","pl-PL":"0x415","pt-BR":"0x416","pt-PT":"0x816","ro-RO":"0x418","ru-RU":"0x419","sk-SK":"0x41B","sl-SI":"0x424","sr-Cyrl-RS":"0x241A","sr-Latn-RS":"0x241A","sv-SE":"0x41D","th-TH":"0x41E","tr-TR":"0x41F","uk-UA":"0x422","vi-VN":"0x42A","zh-CN":"0x804","zh-TW":"0x404"}}');function i(e){if(!("clcids"in a))return"";for(var t=a.clcids,n=e.toLowerCase(),i=0,r=Object.keys(t);i<r.length;i++){var o=r[i];if(o.toLowerCase()===n)return t[o]}return""}},33379:(e,t,n)=>{"use strict";n.d(t,{N:()=>r});const a=JSON.parse('{"cultures":{"ar-SA":"ar","az-Latn-AZ":"az-latn-az","bg-BG":"bg","bs-Latn-BA":"bs-latn-ba","ca-ES":"ca","ca-es-valencia":"ca","cs-CZ":"cs","cy":"cy-gb","cy-GB":"cy-gb","da-DK":"da","de-DE":"de","el-GR":"el","en-GB":"en-gb","es-ES":"es","es-MX":"es-mx","et-EE":"et","eu-ES":"eu","fi-FI":"fi","fil":"fil-ph","fil-PH":"fil-ph","fr-CA":"fr-ca","fr-FR":"fr","ga-IE":"ga-ie","gl-ES":"gl","he-IL":"he","hi-IN":"hi","hr-HR":"hr","hu-HU":"hu","id-ID":"id","is-IS":"is","it-IT":"it","ja-JP":"ja","ka-GE":"ka","kk-KZ":"kk","ko-KR":"ko","lt-LT":"lt","lv-LV":"lv","mk-MK":"mk","ms-MY":"ms","nb-NO":"nb-no","nl-NL":"nl","nn-NO":"nn-np","pl-PL":"pl","prs":"prs-af","pt-BR":"pt-br","pt-PT":"pt-pt","ro-RO":"ro","ru-RU":"ru","sk-SK":"sk","sl-SI":"sl","sq-AL":"sq","sr":"sr-latn-rs","sr-Cyrl-RS":"sr-cyrl-rs","sr-Latn-RS":"sr-latn-rs","sr-cyrl":"sr-cyrl-rs","sr-cyrl-ba":"sr-cyrl-rs","sv-SE":"sv","th-TH":"th","tr-TR":"tr","uk-UA":"uk","vi-VN":"vi","zh-CN":"zh-cn","zh-TW":"zh-tw","zh-hans":"zh-cn","zh-hant":"zh-tw"}}');var i={"en-AU":"en-GB","en-IE":"en-GB","en-IN":"en-GB","en-MY":"en-GB","en-NZ":"en-GB","en-GB":"en-GB","en-TT":"en-GB","en-SA":"en-GB","en-ZW":"en-GB","prs-AF":"en-GB","zh-SG":"zh-CN","zh-HK":"zh-CN","zh-MO":"zh-CN"};function r(e){if("cultures"in a){for(var t=a.cultures,n=e.toLowerCase(),r=0,o=Object.keys(i);r<o.length;r++){var s=o[r];if(s.toLowerCase()===n){e=i[s];break}}for(var c=0,d=Object.keys(t);c<d.length;c++){var l=d[c];if(l.toLowerCase()===n)return t[l]}var u=e.split("-")[0].toLowerCase();if("en"===u)return u;for(var f in t)if(t[f]===u)return u}return""}},9423:(e,t,n)=>{"use strict";n.d(t,{Yc:()=>r,ZG:()=>s,gE:()=>o});var a="<safe>",i="</safe>";function r(e){return"".concat(a).concat(e).concat(i)}function o(e){return!(e.length<a.length+i.length)&&e.substring(0,a.length)===a&&e.substring(e.length-i.length)===i}function s(e){return o(e)?e.substring(a.length,e.length-i.length):e}},19822:(e,t,n)=>{"use strict";n.d(t,{L:()=>d});var a=n(95610),i=n(46705),r=n(95018),o=n(66092),s="timeStamp",c="___undefined___";function d(e,t,n,i,r,d,h,b){var g,v,y,S,D,I,x,C,O,w,E,A,L,k,M;return(0,a.__awaiter)(this,void 0,void 0,function(){var P,T,U,F,H,R,N,B,j,V,z,G,K=this;return(0,a.__generator)(this,function(W){switch(W.label){case 0:try{h=h||localStorage}catch(e){}for(P=!1,T=0,U=e;T<U.length&&(F=U[T],!(P="Segmentation"===F.ecsProject));T++);if(P||e.push({providerId:"SegmentationECSProvider",ecsProject:"Segmentation"}),H=function(e,t){var n,a,i,r,o,s,c,d,l={ecsmetadata:"true"};return l.rolloutenvironment=null!==(n=e.rolloutEnvironment)&&void 0!==n?n:"Unknown",e.cloud&&(l.cloud=e.cloud),t&&(l.agents=t),e.aadUserId&&(l.userid=e.aadUserId),e.aadTenantId&&(l.tenantid=e.aadTenantId),e.flightSessionId&&(l.sessionid=e.flightSessionId),l.userlanguage=null!==(a=e.currentCultureName)&&void 0!==a?a:"Unknown",e.hostVersion&&(l.hostversion=e.hostVersion),l.hostname=null!==(i=e.hostName)&&void 0!==i?i:"Unknown",l.hostview=null!==(r=e.hostView)&&void 0!==r?r:"Unknown",l.hostintegrationtype=null!==(o=e.hostIntegrationType)&&void 0!==o?o:"Unknown",e.clientVersion&&(l.clientversion=e.clientVersion),l.accounttype=null!==(s=e.accountType)&&void 0!==s?s:"Unknown",l.platform=null!==(c=e.platform)&&void 0!==c?c:"Unknown",e.packageName&&(l.packagename=e.packageName),e.packageVersion&&(l.packageversion=e.packageVersion),e.hostVersion&&(l.hostversion=e.hostVersion),e.deviceId&&(l.deviceid=e.deviceId),e.hostVersionNumber&&(l.hostVersionNumber=e.hostVersionNumber.toString()),e.osVer&&(l.osVer=e.osVer),e.onePlayerVersion&&(l.onePlayerVersion=e.onePlayerVersion),l.teamsring=null!==(d=e.teamsRing)&&void 0!==d?d:"Unknown",l}(r,e.map(function(e){return e.ecsProject}).join(",")),h&&(R=function(e,t){var n=u(f(e)),i=t.getItem(n+"-"+s);if(i){var r=new Date(i),o=Date.now()-r.getTime(),d=t.getItem(n);if(d){var l=JSON.parse(d,function(e,t){return t===c?void 0:t});return o<36e5?(0,a.__assign)((0,a.__assign)({},l),{isValid:!0}):(0,a.__assign)((0,a.__assign)({},l),{isValid:!1})}}}(H,h),N=null!==(g=null==R?void 0:R.eTag)&&void 0!==g?g:null===(y=null===(v=null==R?void 0:R.config)||void 0===v?void 0:v.Headers)||void 0===y?void 0:y.ETag),!h||!(null==R?void 0:R.isValid))return[3,1];for(R.fromCache=!0,z=[],G=0;G<e.length;G++)z.push(new o.N(e[G].providerId,R,e[G].ecsProject));return B={providers:z,eTag:null===(D=null===(S=R.config)||void 0===S?void 0:S.Headers)||void 0===D?void 0:D.ETag,filters:r,ring:null===(x=null===(I=R.config)||void 0===I?void 0:I.Segmentation)||void 0===x?void 0:x.Ring,fromCache:!0},l(t,r,!1)&&(B.refreshEcsConfigsAndUpdateCache=function(){return _(n,i,t,H,d,N).then(function(e){h&&e&&("304"===e.config.Headers.StatusCode?p(H,h):m(H,e,h))})}),[2,B];case 1:return l(t,r,!0),[4,_(n,i,t,H,d,N,b)];case 2:if(j=W.sent()){if("304"===j.config.Headers.StatusCode&&R){for(R.fromCache=!0,V=[],G=0;G<e.length;G++)V.push(new o.N(e[G].providerId,R,e[G].ecsProject));return[2,{providers:V,eTag:null===(O=null===(C=R.config)||void 0===C?void 0:C.Headers)||void 0===O?void 0:O.ETag,filters:r,ring:null===(E=null===(w=R.config)||void 0===w?void 0:w.Segmentation)||void 0===E?void 0:E.Ring,fromCache:!0,refreshEcsConfigsAndUpdateCache:function(){return(0,a.__awaiter)(K,void 0,void 0,function(){return(0,a.__generator)(this,function(e){return h&&p(H,h),[2]})})}}]}for(z=[],G=0;G<e.length;G++)z.push(new o.N(e[G].providerId,j,e[G].ecsProject));return[2,{providers:z,eTag:null===(L=null===(A=j.config)||void 0===A?void 0:A.Headers)||void 0===L?void 0:L.ETag,filters:r,ring:null===(M=null===(k=j.config)||void 0===k?void 0:k.Segmentation)||void 0===M?void 0:M.Ring,fromCache:!1,refreshEcsConfigsAndUpdateCache:function(){return(0,a.__awaiter)(K,void 0,void 0,function(){return(0,a.__generator)(this,function(e){return h&&j&&m(H,j,h),[2]})})}}]}throw new Error("Remote call returned undefined unexpectedly");case 3:return[2]}})})}function l(e,t,n){if(!e){if(n)throw new Error("ECS endpoint is undefined");return!1}if(!t.cloud){if(n)throw new Error("ECS cloud is undefined");return!1}return!0}function u(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push([n,e[n]]);return t.sort(function(e,t){return t[0].localeCompare(e[0])}),JSON.stringify(t)}function f(e){var t=(0,a.__assign)({},e);return delete t.sessionid,t}function p(e,t){var n=u(f(e));t.setItem(n+"-"+s,new Date(Date.now()).toString())}function m(e,t,n){var a=u(f(e)),i=JSON.stringify(t,function(e,t){return void 0===t?c:t});n.setItem(a,i),n.setItem(a+"-"+s,new Date(Date.now()).toString())}function _(e,t,o,s,c,d,l){var u={isFlightEnabled:!1};if(c&&(u=c()),!0===u.isFlightEnabled)return(0,a.__awaiter)(this,void 0,void 0,function(){var i,r,c,l,u,f,p,m,_,h,b;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return[4,Promise.all([n.e(24281),n.e(49102),n.e(20464)]).then(n.bind(n,24281))];case 1:i=a.sent().RestService,r={timeoutMs:1e3},c="/config/v1/".concat(e,"/").concat(t),l={},void 0!==d&&(l["If-None-Match"]=d),a.label=2;case 2:return a.trys.push([2,7,,8]),[4,i.getWithResponse("SettingsStore.EcsRemoteProvider",{},o,c,s,l,r)];case 3:return 200!==(f=a.sent()).status?[3,5]:[4,f.json()];case 4:return p=a.sent(),m=null!==(b=null!==(h=f.headers.get("etag"))&&void 0!==h?h:p.Headers.ETag)&&void 0!==b?b:"",_=new Date(function(e){var t=/.*max-age=(\d+).*/gi,n=Date.now()+1728e5;if(e.get("date")&&e.get("expires")){var a=new Date(e.get("date")).getTime(),i=Date.now()-a,r=new Date(e.get("expires")).getTime();return isNaN(r)?n:Math.min(n,r+i)}if(e.get("cache-control")){var o=t.exec(e.get("cache-control"));if(t.lastIndex=0,o&&2===o.length)return Math.min(n,Date.now()+1e3*Number(o[1]))}return Date.now()+18e5}(f.headers)).getTime(),u={config:p,eTag:m,expiration:isNaN(_)?0:_,configType:0,cacheUpdateTime:0,lastFetchTokenHash:0,appVersion:""},[3,6];case 5:u=304===f.status?{config:{Headers:{CountryCode:"",ETag:d,Expires:"",StatusCode:"304"}},eTag:d,expiration:0,configType:0,cacheUpdateTime:0,lastFetchTokenHash:0,appVersion:""}:void 0,a.label=6;case 6:return[3,8];case 7:return a.sent(),u=void 0,[3,8];case 8:return[2,Promise.resolve(u)]}})});var f=l?{isSkypeTokenDataLeakFixEnabled:null==l?void 0:l.isEcsClientLeakFixEnabled}:void 0,p={hosts:[o],clientName:e,clientVersion:t,configsToFetch:[i.lk.EcsConfigType.Default],getEcsParameters:function(){return(0,r.Resolved)(s)},initialAppActiveState:!0,Killswitches:f},m=new i.XP,_=new Promise(function(e){m.configUpdated.subscribe(function(){m.configUpdated.unsubscribe(function(){}),e(m.getConfig())})});return m.initialize(p),(0,a.__awaiter)(this,void 0,void 0,function(){var e;return(0,a.__generator)(this,function(t){switch(t.label){case 0:return(null==l?void 0:l.isEcsClientLeakFixEnabled)?[4,h(_,5e3)]:[3,2];case 1:return e=t.sent(),m.dispose(),[2,e];case 2:return[4,h(_,5e3)];case 3:return[2,t.sent()]}})})}function h(e,t){var n=new Promise(function(e,n){var a=setTimeout(function(){clearTimeout(a),n(new Error("Timed out when trying to retrieve ECS config from ECS"))},t)});return Promise.race([e,n])}},66092:(e,t,n)=>{"use strict";n.d(t,{N:()=>o});var a=n(95610),i=n(58842),r=n(51621),o=function(){function e(e,t,n){if(this.isOverride=!1,!t.config)throw new Error("EcsRemoteProvider received malformed Ecs Sdk Config Object - config field is null or undefined");this.id=e,this.ecsSdkObject=t,this.agent=n}return e.prototype.tryGetSetting=function(e,t,n){var i,o,s;try{var c=null===(o=null===(i=this.ecsSdkObject.config)||void 0===i?void 0:i[this.agent])||void 0===o?void 0:o[e];if(void 0!==c){var d=this.extractCorrespondingConfigIds(e,c,this.agent);d||n&&n.OnProviderError&&n.OnProviderError({providerId:this.id,isOverrideProvider:this.isOverride,name:"MissingConfigIdError",reason:"Could not find corresponding configId for requested Ecs setting: "+e,message:"Could not find corresponding configId for requested Ecs setting: "+e}),void 0!==(s=(0,r.xn)(this.id,this.isOverride,e,c,t,n,void 0))&&(s=(0,a.__assign)((0,a.__assign)({},s),{configIds:d,agent:this.agent}))}}catch(t){n&&n.OnProviderError&&n.OnProviderError({providerId:this.id,isOverrideProvider:this.isOverride,name:"GetSettingError",reason:"TryGetSetting failed to retrieve a setting with name: ".concat(e),message:t.message})}return s},e.prototype.getProviderInfo=function(){return{providerId:this.id,configIdData:this.getAllFlights()}},e.prototype.getAllFlights=function(){var e,t,n,a=null===(n=null===(t=this.ecsSdkObject.config)||void 0===t?void 0:t.ConfigIDs)||void 0===n?void 0:n[this.agent],i=((e={})[this.agent]=a,e);return(0,r.c2)(i)},e.prototype.extractCorrespondingConfigIds=function(e,t,n){var a;if("object"===i.r.typeOf(t))return this.findAllUniqueEcsConfigIds(t);var r=null===(a=this.ecsSdkObject.config[n]._ecs)||void 0===a?void 0:a[e];return r?[r]:void 0},e.prototype.findAllUniqueEcsConfigIds=function(e){var t=this,n=[];Object.keys(e).forEach(function(t){n.push([t,e[t]])});var a=n.reduce(function(e,n){var a=n[0],i=n[1];return"_ecs"===a?e.concat(t.parseConfigIdsFromEcsMetadataObject(i)):"object"==typeof i&&i?e.concat(t.findAllUniqueEcsConfigIds(i)):e},[]);return a.filter(function(e,t){return a.indexOf(e)===t})},e.prototype.parseConfigIdsFromEcsMetadataObject=function(e){var t=[];return Object.keys(e).forEach(function(n){-1===t.indexOf(e[n])&&t.push(e[n])}),t},e}()},58842:(e,t,n)=>{"use strict";n.d(t,{r:()=>a});var a=function(){function e(){}return e.convertType=function(t,n,a){var i=e.typeOf(t);if(void 0===i)throw new TypeError("Setting value is not a data type that is supported by Setting Store: setting value = "+t);if(i===n)return t;var r=i,o=n,s=this.tryCastValue(t,r,String(o));if(void 0!==s)return a&&a(),s;throw new TypeError("Type conversion from value A to data type B is not supported by Setting Store: value A = "+t+", type B = "+n)},e.typeOf=function(e){try{if(null===e)return"null";if(void 0===e)return"undefined";if(Array.isArray(e)){if(0===e.length)return"any[]";for(var t=0,n=e;t<n.length;t++)if(typeof n[t]!=typeof e[0])return;var a=typeof e[0];return"number"===a||"boolean"===a||"string"===a||"object"===a?a+"[]":void 0}var i=typeof e;return"number"===i||"boolean"===i||"string"===i||"object"===i?i:void 0}catch(e){return}},e.tryCastValue=function(t,n,a){if("any[]"===n){if("number[]"===a||"string[]"===a||"boolean[]"===a||"object[]"===a)return[]}else if("null"===n){if("string"===a||"object"===a||"number[]"===a||"string[]"===a||"boolean[]"===a||"object[]"===a)return null}else if("boolean"===n){if("number"===a)return t?1:0;if("string"===a)return t?"true":"false"}else if("string"===n){if("null"===a&&"null"===t)return null;if("number"===a){var i=Number(t);if(!isNaN(i))return i}if("boolean"===a){if("true"===t.toLowerCase())return!0;if("false"===t.toLowerCase())return!1}if("object"===a)try{var r=JSON.parse(t);if("object"===e.typeOf(r))return r}catch(e){}if("number[]"===a||"string[]"===a||"boolean[]"===a||"object[]"===a){r=void 0;try{r=JSON.parse(t)}catch(e){}var o=e.typeOf(r);if(o&&(o===a||"any[]"===o))return r}}else if("number"===n){if("string"===a&&t)return t.toString();if("boolean"===a){if(0===t)return!1;if(1===t)return!0}}else if(("object"===n||"boolean[]"===n||"number[]"===n||"string[]"===n||"object[]"===n)&&"string"===a)try{return JSON.stringify(t)}catch(e){}},e}()},51621:(e,t,n)=>{"use strict";n.d(t,{PC:()=>c,aD:()=>s,c2:()=>l,rN:()=>f,tl:()=>u,xn:()=>d});var a=n(95610),i=n(9423),r=n(58842),o=new Map;function s(e){var t={};try{var n=/^(?:[\w.-])+=?(?:(?!=).)*/gm;"string"==typeof e&&"?"===e[0]&&(e=e.substring(1)),e.split("&").forEach(function(e){var a=e.match(n);a&&a.forEach(function(e){var n=e.split("="),a=n[0],i=n[1];if(a){var r=decodeURIComponent(a.replace(/\+/g," "));if(i){var o=decodeURIComponent(i.replace(/\+/g," "));t[r]=t[r]?t[r]+","+o:o}else t[r]=void 0}})})}catch(e){}return t}function c(e){var t=[];return e.forEach(function(e){t.push({id:e.id,isOverride:e.isOverride})}),t}function d(e,t,n,i,s,c,d){var l;try{var u=r.r.convertType(i,s,function(){var l=n+"-"+s;if(!o.has(l)){o.set(l,!0);var u={providerId:e,isOverrideProvider:t,name:"SettingTypeConversionWarning",reason:"Converted the type of ".concat(n," from ").concat(r.r.typeOf(i)||"unknown"," to ").concat(s,".")};d?d.logEvent("Warning","SettingsProviderInfo",f(u)):c&&c.OnProviderWarning&&c.OnProviderWarning((0,a.__assign)((0,a.__assign)({},u),{name:"SettingTypeConversionWarning"}))}});void 0!==u&&(l={isOverride:t,value:u})}catch(o){var p={providerId:e,isOverrideProvider:t,name:"SettingTypeConversionError",reason:"Failed to convert the type of ".concat(n," from ").concat(r.r.typeOf(i)||"unknown"," to ").concat(s,"."),message:o.message};d?d.logEvent("Fatal","SettingsProviderError",f(p)):c&&c.OnProviderError&&c.OnProviderError((0,a.__assign)((0,a.__assign)({},p),{name:"SettingTypeConversionError"}))}return l}function l(e){var t=new Map,n=[];if(e)for(var a=0,i=Object.keys(e);a<i.length;a++){var r=i[a],o=e[r];if(o&&o.length>0){var s=new Set(o.split(","));t.set(r,s),s.forEach(function(e){n.push(e)})}}return{providerKeyToConfigIdsMap:t,allConfigIds:n}}function u(e){return{scenario:e.name,message:e.reason?(0,i.Yc)(e.reason):e.message?e.message:"mis",stack:"n/a",currentProviderList:e.activeProviders?e.activeProviders:[]}}function f(e){return{scenario:e.name,message:e.reason?(0,i.Yc)(e.reason):e.message?e.message:"mis",stack:"n/a",providerId:e.providerId?e.providerId:"mis",isOverrideProvider:e.isOverrideProvider}}},79002:(e,t,n)=>{"use strict";n.d(t,{L:()=>i,Y:()=>a});var a="mis",i="n/a"},5259:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SubscriptionToken:()=>a,default:()=>i});var a=function(){function e(e,t){this._event=e,this._callback=t}return e.prototype.unsubscribe=function(){this._event.unsubscribe(this._callback)},e}();const i=function(){function e(e){void 0===e&&(e=!1);var t=this;this._allowStopPropagation=e,this.fire=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var a=t._subscribers,i=a.length-1;i>=0;i--){var r=a[i].apply(null,e);if(t._allowStopPropagation&&r)return!0}return!1},this._subscribers=[]}return e.prototype.dispose=function(){this._subscribers=[]},e.prototype.subscribe=function(e){return this._subscribers=this._subscribers.concat(e),new a(this,e)},e.prototype.unsubscribe=function(e){this._subscribers=this._subscribers.filter(function(t){return t!==e})},e}()},95018:(e,n)=>{"use strict";function a(e){return null!=e&&"function"==typeof e.then}function i(e){return null!=e&&"function"==typeof e.cancel}function r(e,t){if(!n.config.catchExceptions)return e();try{return e()}catch(e){return t(e)}}Object.defineProperty(n,"__esModule",{value:!0}),n.config={exceptionsToConsole:!0,catchExceptions:!0,traceEnabled:!1,exceptionHandler:void 0,unhandledErrorHandler:function(e){throw e}},n.fromThenable=function(e){var t=u();return e.then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise().thenAsync(function(e){return e})};var o,s=[],c=void 0!==t;function d(e){s.push(e),1===s.length&&(c?t(l):setTimeout(l,0))}function l(){var e=s;s=[];for(var t=0;t<e.length;t++)e[t]()}function u(){return new o.SyncTask}function f(e){return(new o.SyncTask).resolve(e).promise()}function p(e){var t=u(),n=!1;return t.onCancel(function(t){e.forEach(function(e){i(e)&&o.SyncTask.cancelOtherInternal(e,t)})}),e.forEach(function(e){a(e)?e.then(function(e){n||(n=!0,t.resolve(e))},function(e){n||(n=!0,t.reject(e))}):n||(n=!0,t.resolve(e))}),t.promise()}n.asyncCallback=d,function(e){var t=function(){function e(){this._completedSuccess=!1,this._completedFail=!1,this._traceEnabled=!1,this._cancelCallbacks=[],this._wasCanceled=!1,this._wasExplicitlyCanceled=!1,this._resolving=!1,this._storedCallbackSets=[],this._mustHandleError=!0}return e.prototype._addCallbackSet=function(t,n){var a=this,i=new e;return i.onCancel(function(e){t.wasCanceled=!0,t.cancelContext=e,a._cancelInternal(e)}),t.task=i,this._storedCallbackSets.push(t),n?this._mustHandleError=!1:i._mustHandleError=!1,this._resolving||(this._completedSuccess?this._resolveSuccesses():this._completedFail&&this._resolveFailures()),i.promise()},e.prototype.onCancel=function(e){return this._completedSuccess||this._completedFail||(this._wasCanceled?e(this._cancelContext):this._cancelCallbacks.push(e)),this},e.prototype.then=function(e,t){return this._addCallbackSet({successFunc:e,failFunc:t},!0)},e.prototype.thenAsync=function(e,t){return this._addCallbackSet({successFunc:e,failFunc:t,asyncCallback:!0},!0)},e.prototype.catch=function(e){return this._addCallbackSet({failFunc:e},!0)},e.prototype.always=function(e){return this._addCallbackSet({successFunc:e,failFunc:e},!0)},e.prototype.setTracingEnabled=function(e){return this._traceEnabled=e,this},e.prototype.finally=function(e){return this._addCallbackSet({successFunc:e,failFunc:e},!1),this},e.prototype.done=function(e){return this._addCallbackSet({successFunc:e},!1),this},e.prototype.fail=function(e){return this._addCallbackSet({failFunc:e},!1),this},e.prototype.resolve=function(e){return this._checkState(!0),this._completedSuccess=!0,this._storedResolution=e,this._cancelCallbacks=[],this._resolveSuccesses(),this},e.prototype.reject=function(t){return this._checkState(!1),this._completedFail=!0,this._storedErrResolution=t,this._cancelCallbacks=[],this._resolveFailures(),e._enforceErrorHandled(this),this},e.prototype._checkState=function(e){if(this._completedSuccess||this._completedFail){this._completeStack&&console.error(this._completeStack.message,this._completeStack.stack);var t="Failed to "+(e?"resolve":"reject")+": the task is already "+(this._completedSuccess?"resolved":"rejected");throw new Error(t)}(n.config.traceEnabled||this._traceEnabled)&&(this._completeStack=new Error("resolve"))},e._enforceErrorHandled=function(t){t._mustHandleError&&(e._rejectedTasks.push(t),e._enforceErrorHandledTimer||(e._enforceErrorHandledTimer=setTimeout(function(){e._enforceErrorHandledTimer=void 0;var t=e._rejectedTasks;e._rejectedTasks=[],t.forEach(function(e,t){e._mustHandleError&&n.config.unhandledErrorHandler(e._storedErrResolution)})},0)))},e.prototype.cancel=function(e){if(this._wasExplicitlyCanceled)throw new Error("Already Canceled");this._wasExplicitlyCanceled=!0,this._cancelInternal(e)},e.prototype._cancelInternal=function(e){var t=this;if(!this._wasCanceled){this._wasCanceled=!0,this._cancelContext=e;var n=this._cancelCallbacks;this._cancelCallbacks=[],n.length>0&&n.forEach(function(e){t._completedSuccess||t._completedFail||e(t._cancelContext)})}},e.cancelOtherInternal=function(e,t){var n=e;n._storedCallbackSets&&n._cancelInternal?n._cancelInternal(t):e.cancel(t)},e.prototype.promise=function(){return this},e.prototype._resolveSuccesses=function(){var e=this;for(this._resolving=!0;this._storedCallbackSets.length;){var t=this._storedCallbackSets;this._storedCallbackSets=[],t.forEach(function(t){t.asyncCallback?d(function(){return e._resolveSuccessCallback(t)}):e._resolveSuccessCallback(t)})}this._resolving=!1},e.prototype._resolveSuccessCallback=function(t){var n=this;t.successFunc?r(function(){var r=t.successFunc(n._storedResolution);i(r)&&(t.wasCanceled?e.cancelOtherInternal(r,t.cancelContext):t.task.onCancel(function(t){return e.cancelOtherInternal(r,t)})),a(r)?r.then(function(e){t.task.resolve(e)},function(e){t.task.reject(e)}):t.task.resolve(r)},function(e){n._handleException(e,"SyncTask caught exception in success block: "+e.toString()),t.task.reject(e)}):t.task.resolve(this._storedResolution)},e.prototype._resolveFailures=function(){var e=this;for(this._resolving=!0;this._storedCallbackSets.length;){var t=this._storedCallbackSets;this._storedCallbackSets=[],t.forEach(function(t){t.asyncCallback?d(function(){return e._resolveFailureCallback(t)}):e._resolveFailureCallback(t)})}this._resolving=!1},e.prototype._resolveFailureCallback=function(t){var n=this;t.failFunc?r(function(){var r=t.failFunc(n._storedErrResolution);i(r)&&(t.wasCanceled?e.cancelOtherInternal(r,t.cancelContext):t.task.onCancel(function(t){return e.cancelOtherInternal(r,t)})),a(r)?r.then(function(e){t.task.resolve(e)},function(e){t.task.reject(e)}):t.task.resolve(r)},function(e){n._handleException(e,"SyncTask caught exception in failure block: "+e.toString()),t.task.reject(e)}):t.task.reject(this._storedErrResolution)},e.prototype._handleException=function(e,t){n.config.exceptionsToConsole&&console.error(t),n.config.exceptionHandler&&n.config.exceptionHandler(e)},e.prototype.toEs6Promise=function(){var e=this;return new Promise(function(t,n){return e.then(t,n)})},e._rejectedTasks=[],e}();e.SyncTask=t}(o||(o={})),n.all=function(e){if(0===e.length)return f([]);var t,n=u(),r=e.length,s=Array(e.length);n.onCancel(function(t){e.forEach(function(e){i(e)&&o.SyncTask.cancelOtherInternal(e,t)})});var c=function(){0==--r&&(void 0!==t?n.reject(t):n.resolve(s))};return e.forEach(function(e,n){a(e)?e.then(function(e){s[n]=e,c()},function(e){void 0===t&&(t=void 0===e||e),c()}):(s[n]=e,c())}),n.promise()},n.Defer=u,n.Resolved=f,n.Rejected=function(e){return(new o.SyncTask).reject(e).promise()},n.race=p,n.raceTimer=function(e,t){var n=u(),a=setTimeout(function(){n.resolve({timedOut:!0})},t);return p([e.then(function(e){return clearTimeout(a),{timedOut:!1,result:e}}),n.promise()])}},95610:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__assign:()=>r,__asyncDelegator:()=>S,__asyncGenerator:()=>y,__asyncValues:()=>D,__await:()=>v,__awaiter:()=>l,__classPrivateFieldGet:()=>w,__classPrivateFieldSet:()=>E,__createBinding:()=>f,__decorate:()=>s,__exportStar:()=>p,__extends:()=>i,__generator:()=>u,__importDefault:()=>O,__importStar:()=>C,__makeTemplateObject:()=>I,__metadata:()=>d,__param:()=>c,__read:()=>_,__rest:()=>o,__spread:()=>h,__spreadArray:()=>g,__spreadArrays:()=>b,__values:()=>m});var a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var r=function(){return r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};function o(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}function s(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}function c(e,t){return function(n,a){t(n,a,e)}}function d(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})}function u(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}var f=Object.create?function(e,t,n,a){void 0===a&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]};function p(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||f(t,e,n)}function m(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],a=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function _(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,i,r=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(a=r.next()).done;)o.push(a.value)}catch(e){i={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return o}function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(_(arguments[t]));return e}function b(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a}function g(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))}function v(e){return this instanceof v?(this.v=e,this):new v(e)}function y(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,i=n.apply(e,t||[]),r=[];return a={},o("next"),o("throw"),o("return"),a[Symbol.asyncIterator]=function(){return this},a;function o(e){i[e]&&(a[e]=function(t){return new Promise(function(n,a){r.push([e,t,n,a])>1||s(e,t)})})}function s(e,t){try{(n=i[e](t)).value instanceof v?Promise.resolve(n.value.v).then(c,d):l(r[0][2],n)}catch(e){l(r[0][3],e)}var n}function c(e){s("next",e)}function d(e){s("throw",e)}function l(e,t){e(t),r.shift(),r.length&&s(r[0][0],r[0][1])}}function S(e){var t,n;return t={},a("next"),a("throw",function(e){throw e}),a("return"),t[Symbol.iterator]=function(){return this},t;function a(a,i){t[a]=e[a]?function(t){return(n=!n)?{value:v(e[a](t)),done:"return"===a}:i?i(t):t}:i}}function D(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=m(e),t={},a("next"),a("throw"),a("return"),t[Symbol.asyncIterator]=function(){return this},t);function a(n){t[n]=e[n]&&function(t){return new Promise(function(a,i){!function(e,t,n,a){Promise.resolve(a).then(function(t){e({value:t,done:n})},t)}(a,i,(t=e[n](t)).done,t.value)})}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var x=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&f(t,e,n);return x(t,e),t}function O(e){return e&&e.__esModule?e:{default:e}}function w(e,t,n,a){if("a"===n&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?a:"a"===n?a.call(e):a?a.value:t.get(e)}function E(e,t,n,a,i){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?i.call(e,n):i?i.value=n:t.set(e,n),n}},40592:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});const a={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let i;const r=new Uint8Array(16);function o(){if(!i&&(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!i))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(r)}const s=[];for(let e=0;e<256;++e)s.push((e+256).toString(16).slice(1));const c=function(e,t,n){if(a.randomUUID&&!t&&!e)return a.randomUUID();const i=(e=e||{}).random||(e.rng||o)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=i[e];return t}return function(e,t=0){return(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase()}(i)}},8156:t=>{"use strict";t.exports=e},47111:e=>{"use strict";e.exports=n}},u={};function f(e){var t=u[e];if(void 0!==t)return t.exports;var n=u[e]={id:e,loaded:!1,exports:{}};return l[e].call(n.exports,n,n.exports,f),n.loaded=!0,n.exports}f.m=l,f.amdO={},f.F={},f.E=e=>{Object.keys(f.F).map(t=>{f.F[t](e)})},f.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return f.d(t,{a:t}),t},i=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,f.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var n=Object.create(null);f.r(n);var r={};a=a||[null,i({}),i([]),i(i)];for(var o=2&t&&e;"object"==typeof o&&!~a.indexOf(o);o=i(o))Object.getOwnPropertyNames(o).forEach(t=>r[t]=()=>e[t]);return r.default=()=>e,f.d(n,r),n},f.d=(e,t)=>{for(var n in t)f.o(t,n)&&!f.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},f.f={},f.e=e=>Promise.all(Object.keys(f.f).reduce((t,n)=>(f.f[n](e,t),t),[])),f.u=e=>"chunks/"+({162:"InformationProtectionStrings48",200:"InformationProtectionStrings3",390:"webrec2-effects-stickers-sr-cyrl-rs-strings-json",912:"otlang18",950:"aRes18",1131:"en-gb-strings-jsonThinRes",1375:"hostDefaultsStrings63",1383:"onecamera-locale-id",1387:"aRes43",1421:"onecamera-locale-ms",1435:"webrec2-effects-stickers-uk-strings-json",1510:"onecamera-locale-it",1583:"hostDefaultsStrings78",1699:"webrec2-effects-music-hr-strings-json",1811:"aRes41",2090:"aRes50",2243:"aRes10",2260:"webrec2-effects-music-he-strings-json",2478:"lv-LV-comment-pane-strings-jsonOfficeOnlineStringResource",2517:"odsp1PDiagnosticTool",2555:"webrec2-effects-stickers-nn-np-strings-json",2558:"SoftTrimPluginEmptyPaneImage",2800:"notesOfficeWebHost",2905:"webrec2-effects-music-tr-strings-json",2953:"hostDefaultsStrings46",3032:"webrec2-effects-music-en-gb-strings-json",3035:"af-ZA-comment-pane-strings-jsonOfficeOnlineStringResource",3220:"webrec2-language-it",3420:"hostUxStrings6",3430:"onePlayer2",3460:"ms-strings-jsonThinRes",3528:"otlang10",3576:"hostUxStrings18",3743:"fil-ph-strings-jsonThinRes",3813:"hostUxStrings44",3908:"hostDefaultsStrings67",4212:"InformationProtectionStrings75",4221:"hostDefaultsStrings20",4346:"hostUxStrings32",4718:"webrec2-effects-music-vi-strings-json",4824:"webrec2-effects-stickers-cy-gb-strings-json",5023:"onecamera-locale-ga",5131:"otlang14",5224:"otlang13",5297:"webrec2-language-ko",5351:"it-IT-comment-pane-strings-jsonOfficeOnlineStringResource",5353:"kk-KZ-comment-pane-strings-jsonOfficeOnlineStringResource",5443:"hostUxStrings10",5630:"rumone-fci",5667:"hostDefaultsStrings29",5688:"InformationProtectionStrings20",5851:"hostDefaultsStrings25",5887:"az-latn-az-strings-jsonThinRes",5979:"webrec2-effects-stickers-et-strings-json",6366:"hostUxStrings40",6428:"webrec2-language-sq",6431:"hostUxStrings23",6470:"webrec2-effects-stickers-he-strings-json",6518:"webrec2-effects-stickers-th-strings-json",6746:"InformationProtectionStrings63",7040:"teachingMoment",7191:"hostDefaultsStrings70",7290:"zh-CN-comment-pane-strings-jsonOfficeOnlineStringResource",7351:"webrec2-language-tr",7407:"sr-Cyrl-BA-comment-pane-strings-jsonOfficeOnlineStringResource",7413:"webrec2-language-ga-ie",7447:"es-ES-comment-pane-strings-jsonOfficeOnlineStringResource",7514:"zh-hans-strings-jsonThinRes",7518:"aRes57",7687:"fluentMtcInlineStyles",7696:"webrec2-language-pt-br",7718:"kk-strings-jsonThinRes",7723:"onecamera-locale-ja",7729:"hostUxStrings52",8049:"hostUxStrings2",8535:"hostUxStrings78",8743:"ug-CN-comment-pane-strings-jsonOfficeOnlineStringResource",8819:"hostDefaultsStrings21",9050:"webrec2-language-az-latn-az",9170:"InformationProtectionStrings9",9257:"webrec2-language-bg",9265:"pluginCopilot",9469:"hostUxStrings81",9505:"hostUxStrings56",9592:"hostDefaultsStrings59",9735:"aRes46",9778:"hostUxStrings48",9820:"InformationProtectionStrings5",10066:"fluidxOdspDriver",10100:"webrec2-effects-stickers-ms-strings-json",10183:"fluidxUtilities",10190:"uk-strings-jsonThinRes",10229:"hostDefaultsStrings43",10236:"InformationProtectionStrings56",10542:"aRes14",10787:"webrec2-language-kk",11048:"onecamera-locale-ru",11125:"webrec2-effects-music-sv-strings-json",11318:"keyboardShortcutsModal",11334:"aRes37",11368:"navigationPanel",11382:"LPPLazy",11657:"onePlayer",11763:"shakaengine",11847:"InformationProtectionStrings2",12421:"webrec2-effects-music-ar-strings-json",12486:"hostUxStrings76",12502:"otlang59",12535:"hostDefaultsStrings65",12664:"packageAnalyticsMainElement",12764:"otlang7",13168:"sr-Cyrl-RS-comment-pane-strings-jsonOfficeOnlineStringResource",13311:"hostDefaultsStrings57",13723:"az-Latn-AZ-comment-pane-strings-jsonOfficeOnlineStringResource",14474:"eu-ES-comment-pane-strings-jsonOfficeOnlineStringResource",14609:"aRes42",14743:"onecamera-locale-lv",14748:"onecamera-locale-is",15064:"aRes51",15441:"InteractivityViewModel",15450:"hostDefaultsStrings52",15672:"webrec2-effects-music-ga-ie-strings-json",15815:"webrec2-effects-music-it-strings-json",15943:"InformationProtectionStrings12",16095:"hostUxStrings42",16266:"InformationProtectionStrings28",16316:"hostUxStrings53",16356:"fa-IR-comment-pane-strings-jsonOfficeOnlineStringResource",16370:"pluginReactions",16436:"ko-strings-jsonThinRes",16611:"nn-np-strings-jsonThinRes",16687:"otlang46",16734:"th-strings-jsonThinRes",16753:"webrec2-effects-stickers-sl-strings-json",16981:"InformationProtectionStrings72",17028:"webrec2-effects-music-es-strings-json",17031:"otlang11",17142:"webrec2-language-sr-latn-rs",17233:"InformationProtectionStrings54",17291:"webrec2-effects-music-pl-strings-json",17297:"onecamera-locale-da",17298:"hostDefaultsStrings41",17439:"otlang57",17495:"onecamera-locale-sr-cyrl-rs",17502:"da-DK-comment-pane-strings-jsonOfficeOnlineStringResource",17511:"webrec2-effects-stickers-zh-cn-strings-json",17557:"otlang53",17601:"onecamera-locale-fr-ca",17624:"hostUxStrings62",17743:"webrec2-effects-stickers-hi-strings-json",17844:"webrec2-language-en-gb",17876:"webrec2-effects-filters",17957:"otlang2",18168:"notesComponentUx",18254:"hostDefaultsStrings56",18406:"webrec2-effects-music-nl-strings-json",18436:"or-IN-comment-pane-strings-jsonOfficeOnlineStringResource",18484:"bg-strings-jsonThinRes",18491:"hostUxStrings21",18552:"web_recorder_transcript",18642:"onecamera-locale-kk",18797:"ro-strings-jsonThinRes",18898:"lt-strings-jsonThinRes",18950:"hostDefaultsStrings1",18952:"webrec2-effects-music-kk-strings-json",19210:"InformationProtectionStrings1",19212:"aRes48",19330:"hostUxStrings36",19476:"webrec2-effects-stickers-ca-strings-json",19707:"aRes40",19790:"webrec2-effects-stickers-ka-strings-json",19825:"webrec2-language-hr",19870:"tr-strings-jsonThinRes",19908:"InformationProtectionStrings36",19974:"onecamera-locale-pt-pt",20047:"hostUxStrings71",20155:"hostDefaultsStrings42",20356:"hostDefaultsStrings72",20464:"sharedServicesRest",20499:"otlang32",20756:"en-US-comment-pane-strings-jsonOfficeOnlineStringResource",20764:"InformationProtectionStrings25",20862:"uz-Latn-UZ-comment-pane-strings-jsonOfficeOnlineStringResource",20873:"sr-cyrl-rs-strings-jsonThinRes",20998:"webrec2-language-vi",21112:"hostUxStrings25",21247:"webrec2-language-bs-latn-ba",21264:"hostUxStrings30",21477:"InformationProtectionStrings73",21541:"pluginComment",21590:"am-ET-comment-pane-strings-jsonOfficeOnlineStringResource",21863:"webrec2-effects-stickers-es-mx-strings-json",21868:"webrec2-language-cy-gb",21985:"InformationProtectionStrings62",22073:"LazyFluidMessageBannerStack",22240:"webrec2-effects-stickers-de-strings-json",22452:"InformationProtectionStrings51",22540:"pt-BR-comment-pane-strings-jsonOfficeOnlineStringResource",22764:"onecamera-locale-cy",22938:"vi-VN-comment-pane-strings-jsonOfficeOnlineStringResource",23017:"onecamera-locale-fi",23411:"webrec2-effects-music-ka-strings-json",23675:"errorConverter",23828:"webrec2-wasmcv",23890:"hostUxStrings17",23912:"AudioFilesUpload",24014:"tt-RU-comment-pane-strings-jsonOfficeOnlineStringResource",24053:"otlang28",24182:"webrec2-effects-stickers-is-strings-json",24261:"webrec2-effects-stickers-sk-strings-json",24489:"hostDefaultsStrings14",24625:"fr-ca-strings-jsonThinRes",24632:"hostUxStrings7",24820:"hostDefaultsStrings16",24924:"id-ID-comment-pane-strings-jsonOfficeOnlineStringResource",25181:"docxDocument",25256:"tk-TM-comment-pane-strings-jsonOfficeOnlineStringResource",25409:"hostDefaultsStrings12",25447:"hostDefaultsStrings83",25702:"InformationProtectionStrings80",25901:"InformationProtectionStrings64",25930:"webrec2-effects-music-sr-latn-rs-strings-json",25938:"aRes35",26046:"webrec2-effects-music-fil-ph-strings-json",26192:"hy-AM-comment-pane-strings-jsonOfficeOnlineStringResource",26205:"hostUxStrings45",26442:"pluginMeetingCatchup",26443:"InformationProtectionStrings76",26553:"InformationProtectionStrings26",26835:"webrec2-effects-stickers-mk-strings-json",27005:"html2canvas",27013:"InformationProtectionStrings24",27029:"fr-CA-comment-pane-strings-jsonOfficeOnlineStringResource",27109:"hostDefaultsStrings51",27118:"webrec2-effects-stickers-hr-strings-json",27245:"onecamera-locale-zh-hant",27766:"webrec2-effects-music-eu-strings-json",27853:"hostDefaultsStrings73",27935:"webrec2-effects-stickers-ru-strings-json",27946:"aRes6",28010:"webrec2-effects-music",28242:"hostDefaultsStrings5",28281:"webrec2-language-ka",28299:"oneTranscriptPluginRoot",28453:"webrec2-effects-stickers-tr-strings-json",28471:"otlang56",28497:"hostUxStrings79",28779:"webrec2-effects-stickers-es-strings-json",29e3:"kok-IN-comment-pane-strings-jsonOfficeOnlineStringResource",29185:"webrec2-effects-stickers-fi-strings-json",29188:"ka-strings-jsonThinRes",29323:"InformationProtectionStrings78",29533:"hostUxStrings38",29735:"uiManager",29844:"webrec2-language-lt",29851:"webrec2-effects-music-uk-strings-json",29881:"InformationProtectionStrings46",29942:"hostDefaultsStrings11",29945:"ca-Es-VALENCIA-comment-pane-strings-jsonOfficeOnlineStringResource",30174:"hostDefaultsStrings35",30206:"hostDefaultsStrings9",30313:"InformationProtectionStrings70",30318:"hostDefaultsStrings27",30384:"ImmerES5Plugin",30480:"InformationProtectionStrings45",30702:"hostUxStrings0",30778:"repIssue",30817:"pluginAboutVideo",31044:"es-mx-strings-jsonThinRes",31210:"pluginShare",31251:"file-hasher",31538:"InformationProtectionStrings22",31552:"webrec2-effects-music-sq-strings-json",31702:"nb-no-strings-jsonThinRes",31835:"pt-PT-comment-pane-strings-jsonOfficeOnlineStringResource",31986:"hostUxStrings74",32323:"onecamera-locale-sl",32647:"is-IS-comment-pane-strings-jsonOfficeOnlineStringResource",33172:"pluginChaptering",33642:"hostUxStrings3",33829:"oneTranscriptSettings",33942:"webrec2-effects-music-fr-ca-strings-json",34e3:"hostDefaultsStrings0",34067:"prs-af-strings-jsonThinRes",34096:"mi-NZ-comment-pane-strings-jsonOfficeOnlineStringResource",34129:"webrec2-effects-music-sl-strings-json",34258:"es-MX-comment-pane-strings-jsonOfficeOnlineStringResource",34542:"webrec2-effects-music-lv-strings-json",34544:"webrec2-language-sv",34667:"postRollUi",34697:"sv-strings-jsonThinRes",34744:"InteractivityForms",34871:"hostDefaultsStrings64",35024:"webrec2-language-eu",35066:"onecamera-locale-gl",35107:"webrec2-effects-stickers-zh-tw-strings-json",35108:"pluginOT",35132:"onecamera-locale-nn-no",35169:"webrec2-effects-music-az-latn-az-strings-json",35240:"webrec2-effects-music-zh-cn-strings-json",35364:"InformationProtectionStrings39",35575:"onecamera-locale-en-gb",35587:"aRes31",35592:"otlang54",35668:"InformationProtectionStrings47",35795:"gl-strings-jsonThinRes",36037:"webrec2-language-lv",36058:"InformationProtectionStrings31",36133:"otlang23",36173:"hostDefaultsStrings32",36291:"fixWebmDuration",36391:"ta-IN-comment-pane-strings-jsonOfficeOnlineStringResource",36477:"azuremediaplayer",36665:"InformationProtectionStrings16",36730:"cy-GB-comment-pane-strings-jsonOfficeOnlineStringResource",36759:"onecamera-locale-hi",36793:"DeleteConfirmationDialog",36897:"webrec2-effects-music-mk-strings-json",36902:"webrec2-effects-stickers-da-strings-json",37102:"InformationProtectionStrings18",37156:"webrec2-effects-stickers-kk-strings-json",37209:"hostUxStrings77",37232:"webrec2-effects-music-is-strings-json",37409:"InteractivityLoading",37425:"InformationProtectionStrings17",37559:"onecamera-locale-fil",37591:"hostDefaultsStrings69",38138:"webrec2-effects-music-ca-strings-json",38139:"timelineDraggableMarker",38174:"as-IN-comment-pane-strings-jsonOfficeOnlineStringResource",38257:"ga-IE-comment-pane-strings-jsonOfficeOnlineStringResource",38299:"onecamera-locale-sk",38398:"noiseSuppressionMediaSettings",38416:"webrec2-effects-music-en-strings-json",38430:"sv-SE-comment-pane-strings-jsonOfficeOnlineStringResource",38542:"pluginChat",38564:"FluidFramework-HashFallback",38576:"hostDefaultsStrings74",38685:"webrec2-effects-stickers-ko-strings-json",38746:"hu-HU-comment-pane-strings-jsonOfficeOnlineStringResource",38860:"webrec2-language-uk",38883:"es-strings-jsonThinRes",38968:"hostDefaultsStrings36",39007:"aRes0",39098:"flipcamera",39317:"webrec2-effects-stickers-ar-strings-json",39396:"onePlayerAmp",39412:"hostUxStrings80",39541:"hostDefaultsStrings6",39724:"onecamera-locale-ar",39872:"onecamera-locale-sq",39874:"otlang43",40285:"otlang44",40355:"hostDefaultsStrings13",40596:"hostDefaultsStrings48",40684:"nl-strings-jsonThinRes",40953:"prs-AF-comment-pane-strings-jsonOfficeOnlineStringResource",41007:"hostUxStrings41",41071:"hostUxStrings63",41272:"hostDefaultsStrings3",41992:"hostDefaultsStrings44",42061:"hostDefaultsStrings2",42330:"pluginHelp",42495:"pluginCustomOptions",42588:"webrec2-effects-stickers-eu-strings-json",42918:"webrec2-effects-stickers-nl-strings-json",42971:"webrec2-effects-music-id-strings-json",42981:"webRecorderLoader",43214:"aRes55",43347:"webrec2-language-is",43364:"hostUxStrings19",43579:"hr-strings-jsonThinRes",43583:"InformationProtectionStrings30",43839:"webrec2-effects-music-es-mx-strings-json",44053:"webrec2-effects-stickers-sq-strings-json",44129:"InformationProtectionStrings61",44157:"webrec2-effects-music-cs-strings-json",44283:"aRes30",44334:"closedCaptionsTeachingMoment",44357:"hostUxStrings33",44402:"webrec2-effects-music-el-strings-json",44476:"aRes45",44481:"CommentPluginComponent",44551:"webrec2-language-gl",44559:"onePlayerPlaygroundWebAppModule",44584:"pl-PL-comment-pane-strings-jsonOfficeOnlineStringResource",44596:"hostDefaultsStrings40",44690:"InformationProtectionStrings74",44731:"hostUxStrings75",44741:"webrec2-language-pt-pt",44871:"aRes32",44942:"otlang5",44999:"te-IN-comment-pane-strings-jsonOfficeOnlineStringResource",45170:"zh-cn-strings-jsonThinRes",45419:"InformationProtectionStrings77",45500:"sl-SI-comment-pane-strings-jsonOfficeOnlineStringResource",45610:"ResponseItem",45742:"hostUxStrings43",45805:"ga-ie-strings-jsonThinRes",45816:"otlang47",45920:"webrec2-effects-music-de-strings-json",46118:"otlang37",46534:"webrec2-language-nb-no",46789:"hostUxStrings73",46838:"aRes34",46916:"otlang33",46918:"ha-Latn-NG-comment-pane-strings-jsonOfficeOnlineStringResource",46949:"aRes4",47080:"webrec2-effects-music-ro-strings-json",47162:"hostDefaultsStrings10",47188:"webrec2-effects-music-pt-br-strings-json",47280:"aRes38",47339:"hostUxStrings11",47423:"webrec2-language-mk",47461:"otlang52",47540:"InformationProtectionStrings42",47632:"pluginDebug",47834:"hostDefaultsStrings82",48025:"InformationProtectionStrings32",48140:"aRes52",48166:"english strings",48219:"fi-strings-jsonThinRes",48345:"webrec2-effects-stickers-sr-latn-rs-strings-json",48421:"onecamera-locale-zh-hans",48447:"InformationProtectionStrings34",48462:"transcriptTranslateButton",48522:"webrec2-language-th",48606:"sl-strings-jsonThinRes",48627:"webrec2-language-en",48678:"InformationProtectionStrings83",48715:"hostUxStrings5",48904:"aRes12",49098:"webrec2-effects-music-fi-strings-json",49209:"lo-LA-comment-pane-strings-jsonOfficeOnlineStringResource",49378:"hostDefaultsStrings33",49576:"AshaUtils",49619:"InformationProtectionStrings85",49761:"InformationProtectionStrings21",49782:"webrec2-language-sk",50067:"hostDefaultsStrings26",50206:"kn-IN-comment-pane-strings-jsonOfficeOnlineStringResource",50284:"hostUxStrings16",50378:"pluginLastWatchedPosition",50547:"ms-MY-comment-pane-strings-jsonOfficeOnlineStringResource",50615:"zh-hant-strings-jsonThinRes",50771:"InformationProtectionStrings11",50801:"otlang50",50845:"webrec2-effects-stickers-lt-strings-json",50912:"InformationProtectionStrings55",50961:"hostDefaultsStrings18",50992:"hr-HR-comment-pane-strings-jsonOfficeOnlineStringResource",51060:"InformationProtectionStrings59",51070:"webrec2-language-pl",51072:"navigationPanelShimmer",51159:"webrec2-effects-music-nn-np-strings-json",51246:"el-GR-comment-pane-strings-jsonOfficeOnlineStringResource",51397:"webrec2-language-ms",51404:"InformationProtectionStrings52",51452:"webrec2-language-sl",51534:"onecamera-locale-az",51744:"InformationProtectionStrings79",51796:"ru-RU-comment-pane-strings-jsonOfficeOnlineStringResource",51914:"InformationProtectionStrings29",52107:"mr-IN-comment-pane-strings-jsonOfficeOnlineStringResource",52281:"onecamera-locale-nb",52574:"onecamera-locale-eu",52589:"teamsHighContrastTheme",52648:"ka-GE-comment-pane-strings-jsonOfficeOnlineStringResource",52797:"hostDefaultsStrings55",52866:"InformationProtectionStrings57",52890:"webrec2-effects-stickers-ja-strings-json",52933:"otlang58",53046:"hostUxStrings84",53236:"webrec2-language-he",53326:"hostUxStrings67",53393:"webrec2-language-zh-cn",53484:"hi-strings-jsonThinRes",53681:"gu-IN-comment-pane-strings-jsonOfficeOnlineStringResource",53857:"otlang1",53871:"cs-CZ-comment-pane-strings-jsonOfficeOnlineStringResource",53922:"webrec2-effects-music-bs-latn-ba-strings-json",54018:"webrec2-language-sr-cyrl-rs",54266:"webrec2-effects-stickers-fr-strings-json",54281:"nb-strings-jsonThinRes",54556:"aRes7",54572:"onecamera-locale-hu",54603:"otlang34",54730:"hostDefaultsStrings50",54739:"otlang36",54835:"webrec2-language-el",54866:"aRes29",54936:"webrec2-language-hu",55091:"hostDefaultsStrings71",55151:"onecamera-locale-uk",55439:"webrec2-language-ja",55549:"InformationProtectionStrings23",55579:"mediaSettingsEditEmptyState",55678:"hostDefaultsStrings76",55856:"webrec2-effects-stickers-pt-pt-strings-json",56046:"en-GB-comment-pane-strings-jsonOfficeOnlineStringResource",56097:"nn-NO-comment-pane-strings-jsonOfficeOnlineStringResource",56244:"hostUxStrings9",56330:"hostDefaultsStrings66",56387:"InformationProtectionStrings65",56532:"hostDefaultsStrings23",56580:"webrec2-effects-frames",56693:"aRes8",56802:"webrec2-effects-music-hi-strings-json",56809:"onecamera-locale-et",56947:"aRes27",56970:"InformationProtectionStrings53",57088:"InformationProtectionStrings15",57239:"th-TH-comment-pane-strings-jsonOfficeOnlineStringResource",57245:"hostDefaultsStrings75",57298:"vi-strings-jsonThinRes",57368:"webrec2-language-fr-ca",57432:"transcriptTranslateModal",57549:"InformationProtectionStrings19",57625:"ca-strings-jsonThinRes",57628:"is-strings-jsonThinRes",57796:"webrec2-language-nn-np",57824:"ro-RO-comment-pane-strings-jsonOfficeOnlineStringResource",57896:"nb-NO-comment-pane-strings-jsonOfficeOnlineStringResource",57912:"InformationProtectionStrings7",57964:"onecamera-locale-es-mx",58146:"ko-KR-comment-pane-strings-jsonOfficeOnlineStringResource",58267:"webrec2-language-fi",58377:"pa-IN-comment-pane-strings-jsonOfficeOnlineStringResource",58549:"InformationProtectionStrings67",58659:"webrec2-effects-stickers-fr-ca-strings-json",58699:"webrec2-effects-music-ms-strings-json",58820:"onecamera-locale-el",59238:"InformationProtectionStrings71",59323:"sharedCommentsLazy",59362:"onecamera-locale-cs",59513:"webrec2-effects-stickers-nb-no-strings-json",59514:"onecamera-locale-lt",59529:"otlang25",59571:"webrec2-language-cs",59662:"webrec2-effects-music-ja-strings-json",59753:"hostUxStrings70",59959:"hostDefaultsStrings79",60088:"fr-strings-jsonThinRes",60123:"hostUxStrings27",60332:"onecamera-locale-de",60390:"tr-TR-comment-pane-strings-jsonOfficeOnlineStringResource",60441:"webrec2-effects-stickers-cs-strings-json",60494:"hostDefaultsStrings8",60500:"hostDefaultsStrings60",60506:"fluidxOfficeFluidTypes",60509:"InformationProtectionStrings43",60778:"hostDefaultsStrings53",60963:"webrec2-effects-stickers-lv-strings-json",60982:"it-strings-jsonThinRes",61033:"hostUxStrings24",61045:"webrec2-language-fil-ph",61118:"hostDefaultsStrings58",61203:"InformationProtectionStrings35",61286:"hostUxStrings1",61330:"hostUxStrings8",61459:"otlang30",61518:"aRes26",62115:"InformationProtectionStrings60",62198:"hostUxStrings28",62293:"qps-ploc-comment-pane-strings-jsonOfficeOnlineStringResource",62315:"InformationProtectionStrings68",62387:"webrec2-effects-stickers-az-latn-az-strings-json",62520:"uk-UA-comment-pane-strings-jsonOfficeOnlineStringResource",62678:"aRes39",62793:"pluginAudioFiles",62939:"hostDefaultsStrings37",63009:"pluginAnalytics",63184:"hostUxStrings66",63311:"bs-latn-ba-strings-jsonThinRes",63337:"aRes3",63364:"he-IL-comment-pane-strings-jsonOfficeOnlineStringResource",63402:"hostUxStrings57",63451:"webrec2-effects-music-gl-strings-json",63563:"AtMentionLazy",63894:"webrec2-effects-stickers-bg-strings-json",63993:"webrec2-effects-music-pt-pt-strings-json",64068:"playbackRegion",64089:"InformationProtectionStrings44",64139:"gl-ES-comment-pane-strings-jsonOfficeOnlineStringResource",64145:"hostDefaultsStrings85",64258:"sr-Latn-RS-comment-pane-strings-jsonOfficeOnlineStringResource",64502:"hi-IN-comment-pane-strings-jsonOfficeOnlineStringResource",64574:"ca-ES-comment-pane-strings-jsonOfficeOnlineStringResource",64729:"messageBar",64750:"InformationProtectionStrings58",64944:"km-KH-comment-pane-strings-jsonOfficeOnlineStringResource",65028:"mk-strings-jsonThinRes",65054:"webrec2-effects-stickers-id-strings-json",65129:"ur-PK-comment-pane-strings-jsonOfficeOnlineStringResource",65378:"aRes49",65414:"bn-IN-comment-pane-strings-jsonOfficeOnlineStringResource",65630:"pt-pt-strings-jsonThinRes",65656:"shareDialog",65677:"hostDefaultsStrings77",65785:"aRes16",65851:"chr-Cher-US-comment-pane-strings-jsonOfficeOnlineStringResource",66159:"SWACSAT",66178:"aRes23",66326:"otlang29",66424:"webrec2-language-hi",66450:"sq-strings-jsonThinRes",66482:"hostDefaultsStrings34",66963:"qps-ploca-comment-pane-strings-jsonOfficeOnlineStringResource",67099:"hostDefaultsStrings84",67142:"pt-br-strings-jsonThinRes",67288:"hostDefaultsStrings45",67322:"InteractivityPanel",67644:"ne-NP-comment-pane-strings-jsonOfficeOnlineStringResource",67738:"el-strings-jsonThinRes",68018:"otlang38",68318:"shareCallout",68341:"hostUxStrings51",68446:"hostDefaultsStrings80",68452:"InformationProtectionStrings33",68677:"hostUxStrings59",68748:"sd-Arab-PK-comment-pane-strings-jsonOfficeOnlineStringResource",68771:"otlang22",68810:"mt-MT-comment-pane-strings-jsonOfficeOnlineStringResource",68880:"hostUxStrings55",68889:"onecamera-locale-sv",69198:"InformationProtectionStrings69",69369:"WSETFoundInPlaces",69387:"webrec2-effects-stickers-it-strings-json",69417:"packageAnalyticsAssets",69663:"pskin",69957:"aRes33",69983:"aRes17",70152:"tti-polyfill",70500:"aRes56",70577:"webrec2-effects-boards",70582:"otlang6",70872:"hostDefaultsStrings17",71161:"aRes13",71451:"quz-PE-comment-pane-strings-jsonOfficeOnlineStringResource",71546:"SharepointInformationProtectionService",71782:"otlang0",71805:"otlang15",71856:"InformationProtectionStrings84",71980:"cy-gb-strings-jsonThinRes",72069:"si-LK-comment-pane-strings-jsonOfficeOnlineStringResource",72136:"hostDefaultsStrings54",72371:"InformationProtectionStrings41",72572:"otlang39",72925:"sq-AL-comment-pane-strings-jsonOfficeOnlineStringResource",72936:"hostDefaultsStrings47",72944:"be-BY-comment-pane-strings-jsonOfficeOnlineStringResource",73206:"officeFluidOneDsSink",73217:"webrec2-effects-stickers-el-strings-json",73349:"aRes15",73404:"ar-SA-comment-pane-strings-jsonOfficeOnlineStringResource",73442:"otlang8",73460:"bs-Latn-BA-comment-pane-strings-jsonOfficeOnlineStringResource",73649:"otlang31",73661:"hostDefaultsStrings22",73698:"otlang35",73890:"onecamera-locale-pl",73973:"mk-MK-comment-pane-strings-jsonOfficeOnlineStringResource",73998:"webrec2-language-ca",74006:"otlang51",74180:"hostDefaultsStrings4",74186:"InformationProtectionStrings0",74361:"onecamera-locale-tr",74580:"InformationProtectionStrings13",74691:"sk-strings-jsonThinRes",74747:"onecamera-locale-ko",74833:"onecamera-locale-bs",74863:"hostUxStrings12",74934:"hostUxStrings35",75125:"aRes25",75182:"pluginSoftTrim",75229:"MeetingNotesComponent",75238:"ml-IN-comment-pane-strings-jsonOfficeOnlineStringResource",75292:"hostUxStrings4",75707:"otSearchFeedbackButton",75769:"webrec2-effects-stickers-hu-strings-json",75833:"hostUxStrings37",75873:"webrec2-language-ru",75985:"webrec2-language-prs-af",76003:"hostDefaultsStrings31",76007:"onecamera-locale-ro",76025:"hu-strings-jsonThinRes",76027:"CopilotPlugin",76378:"aRes21",76441:"fi-FI-comment-pane-strings-jsonOfficeOnlineStringResource",76476:"webrec2-language-nl",76513:"buttonCollection",76688:"webrec2-effects-music-hu-strings-json",76738:"hostUxStrings68",76843:"onecamera-locale-bg",76912:"hostUxStrings31",77078:"hostDefaultsStrings30",77397:"ru-strings-jsonThinRes",77431:"webrec2-effects-music-lt-strings-json",77459:"InformationProtectionStrings6",77550:"bn-BD-comment-pane-strings-jsonOfficeOnlineStringResource",77570:"pl-strings-jsonThinRes",77639:"ar-strings-jsonThinRes",77741:"hostDefaultsStrings49",77793:"hostUxStrings64",77808:"aRes2",78026:"zh-TW-comment-pane-strings-jsonOfficeOnlineStringResource",78092:"hostUxStrings85",78117:"InformationProtectionStrings49",78641:"webrec2-effects-stickers-en-strings-json",78713:"onecamera-locale-hr",78729:"hostUxStrings13",78858:"otlang41",78910:"InformationProtectionStrings82",78932:"webrec2-effects-stickers-ga-ie-strings-json",79235:"webrec2-effects-stickers-sv-strings-json",79307:"webrec2-language-es-mx",79358:"webrec2-effects-music-nb-no-strings-json",79533:"otlang9",79537:"aRes20",79629:"hostUxStrings15",79737:"hostUxStrings29",80024:"lv-strings-jsonThinRes",80126:"ja-JP-comment-pane-strings-jsonOfficeOnlineStringResource",80129:"hostUxStrings82",80243:"hostUxStrings47",80319:"otlang27",80403:"lt-LT-comment-pane-strings-jsonOfficeOnlineStringResource",80664:"zh-tw-strings-jsonThinRes",80707:"cs-strings-jsonThinRes",80735:"nl-NL-comment-pane-strings-jsonOfficeOnlineStringResource",80798:"webrec2-effects-stickers-pt-br-strings-json",80799:"webrec2-effects-music-ru-strings-json",80809:"onecamera-locale-nl",80907:"InformationProtectionStrings66",81439:"hostUxStrings20",81698:"InformationProtectionStrings14",81802:"otlang12",81844:"otlang45",81900:"otlang55",81916:"InformationProtectionStrings4",81933:"otlang4",81939:"otlang42",82009:"onecamera-locale-ka",82175:"pluginInteractivity",82303:"webrec2-effects-stickers-ro-strings-json",82387:"webrec2-effects-music-zh-tw-strings-json",82409:"webrec2-effects-backdrops",82453:"aRes47",82596:"hostDefaultsStrings61",82787:"aRes5",82850:"onecamera-locale-mk",82880:"onecamera-locale-sr-latn-rs",82927:"otlang24",83314:"aRes44",83328:"webrec2-effects-music-ko-strings-json",83607:"de-strings-jsonThinRes",83750:"onecamera-locale-vi",84057:"gd-gb-comment-pane-strings-jsonOfficeOnlineStringResource",84539:"onecamera-locale-he",84860:"packageFileAnalytics",84910:"eu-strings-jsonThinRes",84956:"sw-KE-comment-pane-strings-jsonOfficeOnlineStringResource",85082:"webrec2-effects-stickers-pl-strings-json",85597:"webrec2-effects-stickers-en-gb-strings-json",85653:"aRes36",85819:"webrec2-language-fr",85976:"onecamera-locale-fr",86264:"bg-BG-comment-pane-strings-jsonOfficeOnlineStringResource",86354:"onecamera-locale-th",86380:"InformationProtectionStrings8",86395:"hostUxStrings22",86474:"webrec2-effects-stickers-gl-strings-json",86657:"webrec2-effects-stickers-fil-ph-strings-json",86793:"hostUxStrings83",86892:"pluginWebAppAboutVideo",86910:"hostUxStrings34",87150:"otlang49",87311:"hostUxStrings39",87384:"webrec2-language-et",87584:"aRes28",87809:"aRes22",88094:"otlang48",88120:"otlang3",88453:"aRes9",88771:"InformationProtectionStrings50",88891:"InformationProtectionStrings27",88951:"InformationProtectionStrings38",89010:"de-DE-comment-pane-strings-jsonOfficeOnlineStringResource",89051:"InteractivityAnnotations",89086:"otlang16",89104:"otlang21",89220:"fr-FR-comment-pane-strings-jsonOfficeOnlineStringResource",89499:"aRes1",89526:"hostDefaultsStrings81",89537:"hostDefaultsStrings7",89979:"et-EE-comment-pane-strings-jsonOfficeOnlineStringResource",90080:"InformationProtectionStrings37",90082:"aRes11",90134:"webrec2-language-ro",90250:"onecamera-locale-ca",90262:"webrec2-effects-music-da-strings-json",90500:"hostDefaultsStrings28",90534:"InformationProtectionStrings81",90618:"webrec2-effects-music-et-strings-json",90740:"webrec2-effects-stickers-vi-strings-json",90774:"SoftTrimPlugin",91360:"InteractivityLoader",91546:"otlang40",91600:"otlang20",91752:"streamWebApp",92037:"onecamera-locale-pt-br",92168:"mn-MN-comment-pane-strings-jsonOfficeOnlineStringResource",92230:"postPlaybackCore",92326:"hostUxStrings46",92621:"aRes24",92729:"hostUxStrings54",93011:"webrec2-effects-music-th-strings-json",93088:"et-strings-jsonThinRes",93186:"hostUxStrings58",93196:"AboutVideoRichTextEditor",93258:"webrec2-language-ar",93308:"webrec2-effects-music-sr-cyrl-rs-strings-json",93371:"otlang26",93510:"webrec2-effects-music-cy-gb-strings-json",93564:"webrec2-language-da",93718:"hostDefaultsStrings39",93746:"lpcBootstrapper",93800:"he-strings-jsonThinRes",94119:"aRes19",94125:"onecamera-locale-es",94157:"web_recorder_v2",94159:"hostUxStrings65",94341:"webrec2-language-de",94431:"watermarkContainer",94581:"webrec2-effects-stickers-bs-latn-ba-strings-json",94623:"hostDefaultsStrings62",95195:"qps-plocm-comment-pane-strings-jsonOfficeOnlineStringResource",95322:"pluginMeetingNotes",95341:"hostUxStrings26",95378:"fluidxInfProtection",95468:"otlang17",95551:"webrec2-effects-stickers",95746:"da-strings-jsonThinRes",95862:"InformationProtectionStrings10",95875:"hostDefaultsStrings24",95954:"fluentMtc",96008:"hostUxStrings14",96078:"hostDefaultsStrings68",96728:"hostUxStrings50",96807:"webrec2-effects-music-sk-strings-json",97153:"webrec2-language-zh-tw",97213:"ja-strings-jsonThinRes",97265:"InformationProtectionStrings40",97431:"hostDefaultsStrings19",97437:"aRes53",97810:"ky-KG-comment-pane-strings-jsonOfficeOnlineStringResource",97962:"hostDefaultsStrings15",97979:"hostDefaultsStrings38",98091:"webrec2-language-es",98156:"webrec2-language-id",98176:"hostUxStrings61",98278:"hostUxStrings72",98487:"lb-LU-comment-pane-strings-jsonOfficeOnlineStringResource",98498:"hostUxStrings69",98523:"fil-PH-comment-pane-strings-jsonOfficeOnlineStringResource",98926:"webrec2-effects-music-bg-strings-json",99017:"otlang19",99240:"hostUxStrings49",99306:"hostUxStrings60",99641:"sr-latn-rs-strings-jsonThinRes",99666:"id-strings-jsonThinRes",99728:"sk-SK-comment-pane-strings-jsonOfficeOnlineStringResource",99918:"aRes54",99948:"nextGenEngine",99968:"webrec2-effects-music-fr-strings-json"}[e]||e)+".js",f.miniCssF=e=>"media/"+{66159:"SWACSAT",69663:"pskin",95954:"fluentMtc"}[e]+".css",f.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),f.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r={},o="@ms/stream-bundle:",f.l=(e,t,n,a)=>{if(r[e])r[e].push(t);else{var i,s;if(void 0!==n)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var l=c[d];if(l.getAttribute("src")==e||l.getAttribute("data-webpack")==o+n){i=l;break}}i||(s=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,f.nc&&i.setAttribute("nonce",f.nc),i.setAttribute("data-webpack",o+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous")),r[e]=[t];var u=(t,n)=>{i.onerror=i.onload=null,clearTimeout(p);var a=r[e];if(delete r[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},p=setTimeout(u.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=u.bind(null,i.onerror),i.onload=u.bind(null,i.onload),s&&document.head.appendChild(i)}},f.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},f.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),f.p="/",Object.defineProperty(f,"p",{get:function(){try{if("string"!=typeof streamFullStaticPath)throw new Error("WebpackRequireFrom: 'streamFullStaticPath' is not a string or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");return streamFullStaticPath}catch(e){return"/"}},set:function(e){console.warn("WebpackRequireFrom: something is trying to override webpack public path. Ignoring the new value"+e+".")}}),s=e=>new Promise((t,n)=>{var a=f.miniCssF(e),i=f.p+a;if(((e,t)=>{for(var n=document.getElementsByTagName("link"),a=0;a<n.length;a++){var i=(o=n[a]).getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(i===e||i===t))return o}var r=document.getElementsByTagName("style");for(a=0;a<r.length;a++){var o;if((i=(o=r[a]).getAttribute("data-href"))===e||i===t)return o}})(a,i))return t();((e,t,n,a,i)=>{var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",r.onerror=r.onload=n=>{if(r.onerror=r.onload=null,"load"===n.type)a();else{var o=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.href||t,c=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");c.code="CSS_CHUNK_LOAD_FAILED",c.type=o,c.request=s,r.parentNode.removeChild(r),i(c)}},r.href=t,0!==r.href.indexOf(window.location.origin+"/")&&(r.crossOrigin="anonymous"),document.head.appendChild(r)})(e,i,0,t,n)}),c={81110:0},f.f.miniCss=(e,t)=>{c[e]?t.push(c[e]):0!==c[e]&&{66159:1,69663:1,95954:1}[e]&&t.push(c[e]=s(e).then(()=>{c[e]=0},t=>{throw delete c[e],t}))},(()=>{var e={81110:0};f.f.j=(t,n)=>{var a=f.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=f.p+f.u(t),o=new Error;f.l(r,n=>{if(f.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}},f.F.j=t=>{if(!f.o(e,t)||void 0===e[t]){e[t]=null;var n=document.createElement("link");n.crossOrigin="anonymous",f.nc&&n.setAttribute("nonce",f.nc),n.rel="prefetch",n.as="script",n.href=f.p+f.u(t),document.head.appendChild(n)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)f.o(o,a)&&(f.m[a]=o[a]);s&&s(f)}for(t&&t(n);c<r.length;c++)i=r[c],f.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunk_ms_stream_bundle=self.webpackChunk_ms_stream_bundle||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),f.nc=void 0,d={48673:[68318,65656]},f.f.prefetch=(e,t)=>Promise.all(t).then(()=>{var t=d[e];Array.isArray(t)&&t.map(f.E)});var p={};return(()=>{"use strict";f.r(p),f.d(p,{ALLOWED_HOST_REFERRAL_APPS:()=>b.eB,ALLOWED_HOST_REFERRAL_MODES:()=>b.lS,ALLOWED_HOST_REFERRAL_VIEWS:()=>b.XA,CreateOdspSourceProvider:()=>I.a,EcsRemoteProvider:()=>i.N,FoRProvider:()=>a,InteractivityEngineAdapter:()=>d.J,MISSING_TELEMETRY_VALUE:()=>u.Y,Observable:()=>g.y,ObservableProperty:()=>v.m,OdspPlaybackSourceProvider:()=>S.PK,getEcsSettingPayloadViaRemoteCall:()=>r.L,getHighResolutionVideoNotReadyErrorObjects:()=>c,getMappedStreamCultureName:()=>l.N,getPermissionsFromFlags:()=>C.A,initializeEcsProvider:()=>y,loadOnePlayerBundle:()=>w,loadOnePlayerBundle2:()=>E,loadOnePlayerPlaygroundBundle:()=>L,loadStreamWebAppBundle:()=>O,loadWebRecorderLoaderBundle:()=>A,markStartOfWebRecorderLoad:()=>_,onePlayerVersion:()=>D._,registerOnePlayerBasicTrustedTypePolicies:()=>x.u});var e=f(95610);window.streamFullStaticPath=window.require.toUrl("@ms/stream-bundle/").replace(/\/$/g,"")+"/";var t=f(51621),n={edog:"P",spdf:"P",prodbubble:"P",prod:"P",chn:"P",deu:"P",gcc:"P",gcch:"G",dod:"D"},a=function(){function e(e,t,n,a,i,r,o,s){if(this.isOverride=!1,this.id=e,this.allowFeatureOverrides=t,this.featureOverridesMap=n,this.pagecontext=a,this.getExperiment=i,this.getRollout=r,this.queryStringExperimentOverrides=this.parseQueryStringForExpOverrides(o),this.loggingService=s,this.loggingService){var c={providerId:this.id,isOverrideProvider:this.isOverride};this.loggingService.logEvent("AppLogic","SettingsProviderInitialized",c)}}return e.prototype.tryGetSetting=function(e,n,a){var i;try{var r=Number(e);isNaN(r)||("boolean"===n?i=this.getSafeRolloutValue(r,a):"number"===n&&(i=this.getExperimentVariantValue(r,a)))}catch(n){var o={providerId:this.id,isOverrideProvider:this.isOverride,name:"GetSettingError",reason:"TryGetSetting failed to retrieve a setting with name: ".concat(e),message:n.message};this.loggingService?this.loggingService.logEvent("Fatal","SettingsProviderError",(0,t.rN)(o)):a&&a.OnProviderError&&a.OnProviderError(o)}return i},e.prototype.getProviderInfo=function(){var e=new Map;return e.set(this.id,new Set),{providerId:this.id,configIdData:{providerKeyToConfigIdsMap:e,allConfigIds:[]}}},e.prototype.getSafeRolloutValue=function(e,n){var a;if(this.allowFeatureOverrides&&e.toString()in this.featureOverridesMap)a={isOverride:!0,value:i=this.featureOverridesMap[e.toString()],configIds:this.constructMakeshiftConfigId(e.toString(),i)};else try{var i;a={isOverride:!1,value:i=this.getRollout({ODB:e,Fallback:!1},this.pagecontext.ExpFeatures),configIds:this.constructMakeshiftConfigId(e.toString(),i)}}catch(a){var r={providerId:this.id,isOverrideProvider:this.isOverride,name:"GetSettingError",reason:"GetSafeRolloutValue failed to retrieve flightId: ".concat(e,"."),message:a.message};this.loggingService?this.loggingService.logEvent("Fatal","SettingsProviderError",(0,t.rN)(r)):n&&n.OnProviderError&&n.OnProviderError(r)}return a},e.prototype.getExperimentVariantValue=function(e,n){var a;try{a=this.getExperiment(e,this.pagecontext)}catch(a){var i={providerId:this.id,isOverrideProvider:this.isOverride,name:"GetSettingError",reason:"GetExperimentVariantValue failed to retrieve experiment variant for flight: ".concat(e,"."),message:a.message};return void(this.loggingService?this.loggingService.logEvent("Fatal","SettingsProviderError",(0,t.rN)(i)):n&&n.OnProviderError&&n.OnProviderError(i))}var r,o=a.logExposure.bind(a),s=a.variantToDisplay,c=this.constructMakeshiftConfigId(e.toString(),s);if(void 0===window.ODSP_EXPERIMENTS||void 0===window.ODSP_EXPERIMENTS[e])this.queryStringExperimentOverrides.has(e)&&(r={isOverride:!0,value:s,configIds:c});else{var d=window.ODSP_EXPERIMENTS[e],l=d._isOverride,u=d._variantToLog;l?r={isOverride:!0,value:s,configIds:c}:void 0!==u&&(r={isOverride:!1,value:s,configIds:c})}if(r)try{o()}catch(a){i={providerId:this.id,isOverrideProvider:this.isOverride,name:"LogExposureError",reason:"GetExperimentVariantValue failed to log exposure for flight: ".concat(e,"."),message:a.message},this.loggingService?this.loggingService.logEvent("Fatal","SettingsProviderError",(0,t.rN)(i)):n&&n.OnProviderError&&n.OnProviderError(i)}return r},e.prototype.parseQueryStringForExpOverrides=function(e){var n=new Set,a=(0,t.aD)(e).expOverrides;if(a){var i=void 0;try{i=JSON.parse(a)}catch(e){i=[]}for(var r=0,o=i;r<o.length;r++){var s=o[r];n.add(s[0])}}return n},e.prototype.constructMakeshiftConfigId=function(e,t){return["FOR:"+[n[this.pagecontext.CloudType]||"missing","boolean"==typeof t?"R":"E",e,"boolean"==typeof t?t?1:0:t,0].join("-")]},e}(),i=f(66092),r=f(19822),o=f(31924),s=f(41362);function c(t,n,a){var i;return(0,e.__awaiter)(this,void 0,void 0,function(){var r,c,d,l;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,a()];case 1:return r=e.sent(),c=null!==(i=r.locale.value)&&void 0!==i?i:"",d=(0,s.G)(null!=c?c:""),l="https://go.microsoft.com/fwlink/?linkid=2246917".concat(d?"&clcid=".concat(d):""),[2,{error:new o.g("fatal",!0,"createSession","serverInjectedDataError",new Error("Premium resolution video is still processing and not ready for playback"),"Premium resolution video is still processing and not ready for playback",t,n.hostContext.sessionId),errorBoxInfo:{titleStrLocKey:"PremiumVideo.NotReadyError.Title",messageStrLocKey:"PremiumVideo.NotReadyError.Message",secondaryButtonInfo:{locKey:"PremiumVideo.NotReadyError.ActionButton",onClicked:function(){return window.open(l,"_blank")}}}}]}})})}var d=f(63741),l=f(33379),u=f(79002),m=f(44385);function _(){return{WebRecorderStart:h("WebRecorderStart"),TimeToLoad:h("TimeToLoad"),TimeToInteractive:h("TimeToInteractive"),TimeToStableInteractive:h("TimeToStableInteractive"),FirstContentfulPaint:h("FirstContentfulPaint")}}var h=function(e){var t,n="".concat(e,"-").concat(m.generate().toString());return performance&&performance.mark&&performance.getEntriesByName?(performance.mark(n),t=performance.getEntriesByName(n)[0]):t=new Date,t},b=f(72480),g=f(13331),v=f(38267);function y(t,n,a){return(0,e.__awaiter)(this,void 0,void 0,function(){var i;return(0,e.__generator)(this,function(e){return i=[{providerId:"OnePlayerECSProvider",ecsProject:"OnePlayer"},{providerId:"OneTranscriptECSProvider",ecsProject:"OneTranscript"},{providerId:"SegmentationECSProvider",ecsProject:"Segmentation"}],[2,(0,r.L)(i,t,"OneDriveSharePoint","1.0.0.0",n,a)]})})}var S=f(16131),D=f(85954),I=f(99419),x=f(78987),C=f(72216);function O(){return(0,e.__awaiter)(this,void 0,void 0,function(){var t;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([f.e(70180),f.e(17278),f.e(57626),f.e(64555),f.e(35759),f.e(43285),f.e(86636),f.e(65615),f.e(67909),f.e(24281),f.e(49102),f.e(77512),f.e(92016),f.e(53458),f.e(36965),f.e(2450),f.e(78261),f.e(71117),f.e(53829),f.e(91752)]).then(f.bind(f,50343))];case 1:return[2,{createStreamWebApp:(t=e.sent()).createStreamWebApp,onePlayerVersion:t.onePlayerVersion,prewarmResources:t.prewarmResources,loadMtcManager:t.loadMtcManager,prefetchManifest:t.prefetchManifest,prefetchManifestLite:t.prefetchManifestLite,stringToMediaVisibility:t.stringToMediaVisibility}]}})})}function w(){return(0,e.__awaiter)(this,void 0,void 0,function(){var t;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([f.e(70180),f.e(17278),f.e(57626),f.e(64555),f.e(35759),f.e(43285),f.e(86636),f.e(65615),f.e(67909),f.e(24281),f.e(49102),f.e(77512),f.e(92016),f.e(53458),f.e(36965),f.e(2450),f.e(78261),f.e(71117),f.e(53829),f.e(11657)]).then(f.bind(f,36920))];case 1:return[2,{createOnePlayer:(t=e.sent()).createOnePlayer,onePlayerVersion:t.onePlayerVersion,prewarmResources:t.prewarmResources,loadMtcManager:t.loadMtcManager,prefetchManifest:t.prefetchManifest,prefetchManifestLite:t.prefetchManifestLite,stringToMediaVisibility:t.stringToMediaVisibility}]}})})}function E(){return(0,e.__awaiter)(this,void 0,void 0,function(){var t;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([f.e(57626),f.e(50535),f.e(64555),f.e(35759),f.e(44367),f.e(86636),f.e(34844),f.e(65615),f.e(67909),f.e(72859),f.e(49686),f.e(82346),f.e(86966),f.e(42094),f.e(91042),f.e(98695),f.e(49102),f.e(77512),f.e(92016),f.e(53458),f.e(36965),f.e(2450),f.e(95954),f.e(28684),f.e(3430)]).then(f.bind(f,74283))];case 1:return[2,{createMsOdspOnePlayerLoader:(t=e.sent()).createMsOdspOnePlayerLoader,createDeferredMsOdspOnePlayerLoader:t.createDeferredMsOdspOnePlayerLoader,stringToMediaVisibility:t.stringToMediaVisibility,getMsOdspEngineHeuristicSettings:t.getMsOdspEngineHeuristicSettings}]}})})}function A(){return(0,e.__awaiter)(this,void 0,void 0,function(){var t;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([f.e(57626),f.e(64555),f.e(67909),f.e(68043),f.e(24281),f.e(49102),f.e(92016),f.e(53458),f.e(42981)]).then(f.bind(f,15854))];case 1:return[2,{createDeferredWebRecorder:(t=e.sent()).createDeferredWebRecorder,createWebRecorderContext:t.createWebRecorderContext,initializeSettingsStore:t.initializeSettingsStore,getNpmPackageVersion:t.getNpmPackageVersion,OneTranscriptAddon:t.OneTranscriptAddon}]}})})}function L(){return(0,e.__awaiter)(this,void 0,void 0,function(){var t;return(0,e.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([f.e(57626),f.e(64555),f.e(24281),f.e(49102),f.e(44559)]).then(f.bind(f,98575))];case 1:return[2,{createOnePlayer:(t=e.sent()).createOnePlayer,getHostAppConfiguration:t.getHostAppConfiguration}]}})})}})(),p})(),e.exports=a(n("react-lib"),n("react-dom-lib"))}).call(this,n(3937).setImmediate)},2921:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(222),i=n(192),r=n(31),o=n(3638),s=n(498),c=n(4);function d(e,t,n,d,l){if(!d)return[!1,void 0];var u=c.t.isActivated("86df932c-b7c1-4f77-a7a1-03b1b41176bf","03/17/2023","Swtiching to use CloudType instead of env or env2")?Object(s.e)(d):Object(s.t)(d.cloudType);if(Object(s.r)(u)||Object(s.a)(u))return[!1,void 0];var f=Object(r.isFeatureEnabled)(n);if(Object(s.o)(u)&&!f)return[!1,void 0];var p=Object(r.isFeatureEnabled)(e),m={experimentId:"number"==typeof e.ODB?e.ODB:void 0,variant:p?1:0,isAATest:!1,isOverride:a.a.isFeatureEnabled(e),correlationId:d?d.CorrelationId:"",cloudType:d?String(d.cloudType):""},_=0;p||(_=Object(i.n)(t,d));var h=function(e,t){if(!t)return{experimentId:e,variant:void 0,isAATest:!1,isOverride:!1,correlationId:"",cloudType:""};var n=Object(i.t)(e,t);return{experimentId:n._experimentId,variant:n._variantToLog,isAATest:n._isAATest,isOverride:n._isOverride,correlationId:t.CorrelationId,cloudType:String(t.cloudType)}}(t,d),b=p?m:h,g=p||_>0;return void 0!==b.variant?[g,b=function(e,t){var n=o.e();return void 0===e.variant||t&&JSON.stringify(t)===JSON.stringify(e)||(o.t(n,e),t=e),t}(b,l)]:[g,void 0]}},2976:function(e,t,n){"use strict";var a,i;function r(e){return e===i.htmlMp4||e===i.htmlFallback||e===i.flashMp4?a.mp4:e===i.htmlHls||e===i.htmlHlsMediaFoundationFallback||e===i.htmlHlsFFMPEGFallback?a.hls:e===i.htmlHlsV6||e===i.htmlHlsV6MediaFoundationFallback||e===i.htmlHlsV6FFMPEGFallback?a.hlsV6:a.dash}n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"a",function(){return r}),function(e){e.hls="hls",e.hlsV6="hlsV6",e.dash="dash",e.mp4="htmlMp4"}(a||(a={})),function(e){e.none="none",e.flashDash="flashDash",e.flashMp4="flashMp4",e.flashPending="flashPending",e.htmlMp4="htmlMp4",e.htmlDashling="htmlDashling",e.htmlDashlingMediaFoundationFallback="htmlDashlingMediaFoundationFallback",e.htmlHls="htmlHls",e.htmlHlsMediaFoundationFallback="htmlHlsMediaFoundationFallback",e.htmlFallback="htmlFallback",e.htmlDashlingFFMPEGFallback="htmlDashlingFFMPEGFallback",e.htmlHlsFFMPEGFallback="htmlHlsFFMPEGFallback",e.htmlHlsV6="htmlHlsV6",e.htmlHlsV6MediaFoundationFallback="htmlHlsV6MediaFoundationFallback",e.htmlHlsV6FFMPEGFallback="htmlHlsV6FFMPEGFallback"}(i||(i={})),t.n=i},3080:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"n",function(){return s});var a=n(6),i=new a.t("video.context"),r=new a.t("video.playbackPanelProvider"),o=new a.t("video.deepLinkProvider"),s=new a.t("video.pauseEvent")},3327:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"n",function(){return c});var a=n(33),i=n(227),r=n(146),o=function(e){var t="".concat(e,"-").concat(r.generate());return performance.mark(t)||performance.getEntriesByName(t)[0]},s=function(e,t,n){var a,i;return void 0!==(i=e)&&"mark"===i.entryType?(performance.measure(e.name,e.name),a=performance.getEntriesByName(e.name,"measure")[0]):a=[e,new Date],{measure:a,result:t,data:n}},c=function(e,t,n){var r=new a.e({name:e});return t().then(function(e){return r.end({resultType:a.t.Success,extraData:n}),e}).catch(function(e){var t=e instanceof Error?e:void 0;throw r.end(Object(i.e)(t)),e})}},3638:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n(41),i=n(346);function r(){return Object(i.e)({eventName:"OnePlayerAndECSLogExposure,",shortEventName:"OnePlayerAndECSLogExposure"},{experimentId:{isPrefixingDisabled:!0,type:a.e.Number},variant:{isPrefixingDisabled:!0,type:a.e.Number},isAATest:{isPrefixingDisabled:!0,type:a.e.Boolean},isOverride:{isPrefixingDisabled:!0,type:a.e.Boolean},correlationId:{isPrefixingDisabled:!0,type:a.e.String},cloudType:{isPrefixingDisabled:!0,type:a.e.String}})}function o(e,t){e.logData(t)}},3683:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(31),i=function(e){var t=r("cdn",e),n=r("videoUseCdnTeam",e);return"1"===t||"0"===t?t:"true"===n?"1":""},r=function(e,t){return t?t[e]:null},o={getBlockDownloadParam:function(e){return"true"===r("blockDownload",e)},getForcedCdnParam:i,isPlaybackCDNEnabled:function(e){var t,n=i(e),r=!Object(a.isFeatureEnabled)(a.OnePlayerDisableCdn);return(!n&&r&&Object(a.isFeatureEnabled)(a.VideoUseCdn)||"1"===n)&&(void 0===(t=window&&window._spPageContextInfo&&window._spPageContextInfo.farmSettings&&window._spPageContextInfo.farmSettings.ExternalService_videousecdnenabled)||"1"===t)},isForcedMeta:function(){return"undefined"!=typeof URLSearchParams&&"1"===new URLSearchParams(window.location.search).get("forceMeta")},additionalMetaQsps:function(e){var t=r("additionalMetaQsps",e);return null===t?null:function(e){var t=new Map;return e.split(";").forEach(function(e){var n=e.split(":");2===n.length&&t.set(n[0].trim(),n[1].trim())}),t}(t)},isDisableHybrid:function(e){try{var t=r("embed",e);if(t){var n=JSON.parse(t);return!!n.disableHybrid&&n.disableHybrid}return!1}catch(e){return console.log("Cannot decode URI"+e),!1}},isSwaEditMode:function(e){var t=r("mode",e);return!!t&&"Edit"===t}}},3871:function(e,t,n){"use strict";function a(e){var t=e.serverRelativeItemUrl,n=e.dataRequestor,a=e.webApiUrl,i=e.duration,r=void 0===i?1:i,o=e.authToken,s=a;return s=(s=s.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t})).method("GetPreAuthorizedAccessUrl",r),n.getData({url:s.toString(),method:"GET",authToken:o,qosName:"ItemDataSource.getDownloadUrl"}).then(function(e){return e.d.GetPreAuthorizedAccessUrl})}n.d(t,"e",function(){return a})},3937:function(e,t,n){(function(e){var a=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function r(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new r(i.call(setTimeout,a,arguments),clearTimeout)},t.setInterval=function(){return new r(i.call(setInterval,a,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(a,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(4300),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(2324))},3938:function(e,t,n){"use strict";n.d(t,"n",function(){return f}),n.d(t,"t",function(){return p}),n.d(t,"e",function(){return m});var a=n(6),i=n(248),r=n(192),o=n(51),s=n(2719),c=n(31),d=n(52),l=n(4),u=(new a.t("Stream.WebApp.ItemPromise"),new a.t("stream.deepLinkProvider"),new a.t("Stream.WebApp.View.Load"),new a.t("Stream.WebApp.View.PageLoad"),new a.t("Stream.WebApp.View.EnhancedPageLoad"),new a.t({name:"Stream.WebApp.View.TimeInBackground"}),new a.t({name:"Stream.WebApp.View.CanUserEdit",factory:{dependencies:{},create:function(){var e,t=!1;if(void 0!==(null===(e=null===window||void 0===window?void 0:window.g_fileInfo)||void 0===e?void 0:e.PermMask)){var n=s.t.fromHexString(window.g_fileInfo.PermMask);t=o.e.hasPermission(n,o.e.editListItems)}return{instance:t}}}})),f=new a.t({name:"Stream.WebApp.View.IsViewMode",factory:{dependencies:{userCanEditItem:u},create:function(e){var t,n=e.userCanEditItem,a=new URLSearchParams(window.location.search),i=a.get("mode"),r=a.get("referrerScenario"),c="Edit"!==i;if("UPLOAD"!==(null==r?void 0:r.toUpperCase())&&"MEDIASETTINGSEDITINSTREAM"!==(null==r?void 0:r.toUpperCase())&&"NEWRECORDING"!==(null==r?void 0:r.substring(0,12).toUpperCase())&&"NAVEDITINSTREAM"!==(null==r?void 0:r.toUpperCase())||(c=!1),n){if(!l.e.isActivated("5cb6c71b-c482-4cd4-b596-e97b60c00ecb","9/28/2023","Enables edit mode by default for video owners in SWA")&&(null===(t=null===window||void 0===window?void 0:window.g_fileInfo)||void 0===t?void 0:t.PermMask)){var d=s.t.fromHexString(window.g_fileInfo.PermMask);o.e.hasPermission(d,o.e.fullMaskWithoutACP)&&"View"!==i&&(c=!1)}}else c=!0;return{instance:c}}}}),p=new a.t({name:"Stream.WebApp.View.IsViewEditModeEnabled",factory:{dependencies:{pageContext:d.p},create:function(e){var t=e.pageContext,n=!1;return Object(c.isFeatureEnabled)(c.SWAViewEditMode)?n=!0:Object(i.c)(t)?n=!1:1===Object(r.n)(90188,t)&&(n=!0),{instance:n}}}}),m=(new a.t({name:"Stream.WebApp.View.IsHomeButtonEnabled",factory:{dependencies:{pageContext:d.p},create:function(e){var t=e.pageContext,n=!1;return Object(c.isFeatureEnabled)(c.HomeButton)?n=!0:Object(i.c)(t)?n=!1:1===Object(r.n)(90104,t)&&(n=!0),{instance:n}}}}),new a.t({name:"Stream.WebApp.View.IsSidePanelEnabled",factory:{dependencies:{pageContext:d.p},create:function(e){var t=e.pageContext,n=!1;return Object(c.isFeatureEnabled)(c.SWAMultiPanel)?n=!0:Object(i.c)(t)?n=!1:1===Object(r.n)(90133,t)&&(n=!0),{instance:n}}}}))},4073:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"r",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"n",function(){return d}),n.d(t,"e",function(){return a}),n.d(t,"t",function(){return l});var a,i=n(498),r=n(4),o=function(e,t){void 0===t&&(t=!1);var n=r.t.isActivated("86df932c-b7c1-4f77-a7a1-03b1b41176bf","03/17/2023","Swtiching to use CloudType instead of env or env2")?Object(i.e)(e):Object(i.t)(e.cloudType);return Object(i.r)(n)||Object(i.a)(n)||Object(i.o)(n)||t&&Object(i.i)(e.farmLabel)},s=function(e){return"".concat("<safe>").concat(e).concat("</safe>")},c=function(e,t){if(e){var n=e.match(/[^.]+/g);if(n){var a,i,r=void 0,o=void 0,s=void 0;if(a=n[0],i=n[1],t){var c=t.split(".").map(function(e){return e.length?e:void 0});c&&(r=c[0],o=c[1],s=c[2])}return{referralApp:a,referralAppPlatform:i,referralView:r,referralMode:null==o?void 0:o.toLowerCase(),referralPlaybackSessionId:s}}}},d=function(e){return void 0!==e.transcripts};!function(e){e[e.Transcripts=0]="Transcripts",e[e.TranscriptsAndAudioFiles=1]="TranscriptsAndAudioFiles",e[e.None=2]="None"}(a||(a={}));var l=function(e,t,n){if(t){var a=new URL(t),i=a.searchParams;return i.has("referrer")||i.append("referrer","".concat((null==n?void 0:n.referralApp)||"mis",".").concat((null==n?void 0:n.referralAppPlatform)||"mis")),i.has("referrerScenario")||i.append("referrerScenario","".concat(e,".").concat((null==n?void 0:n.referralMode)||"mis",".").concat((null==n?void 0:n.referralPlaybackSessionId)||"mis")),a.toString()}return t}},4299:function(e,t,n){"use strict";var a=n(94);Object(a.n)([{rawString:'.OnePlayer-container{width:100%;height:100%;position:relative;background-color:#000}.OnePlayer-container .video-player-container{width:100%;height:100%;opacity:1}.OnePlayer-container .preloaded-thumbnail-poster{width:100%;height:100%;position:absolute;background-color:#000;cursor:pointer;border:none;padding:0}.OnePlayer-container .preloaded-thumbnail-poster.player-ready{display:none}.OnePlayer-container .preloaded-thumbnail-poster .delay-play-button{position:absolute;top:50%;left:50%;transform:translate(-57%,-50%)}:hover .OnePlayer-container .preloaded-thumbnail-poster .delay-play-button{transform:translate(-57%,-50%) scale(1.15);transition-duration:.15s}.OnePlayer-container .preloaded-thumbnail-poster .delay-play-button>img{width:auto;height:14vh}.OnePlayer-container .preloaded-thumbnail-poster .delay-play-button-v2{width:20%;height:20%;min-width:56px;min-height:56px;position:absolute;top:50%;left:50%;transform:translate(-57%,-50%);filter:drop-shadow(rgba(0, 0, 0, .4) 0px 0px 5px)}:hover .OnePlayer-container .preloaded-thumbnail-poster .delay-play-button-v2{transform:translate(-57%,-50%) scale(1.15);transition-duration:.15s}.OnePlayer-container .preloaded-thumbnail-poster .delay-play-button-v2>img{width:100%;height:100%;-o-object-fit:contain;object-fit:contain}.OnePlayer-container .preloaded-thumbnail{display:inline;vertical-align:middle;height:100%;width:100%;-o-object-fit:contain;object-fit:contain}.StreamWebApp-container{width:100%;height:100%;position:relative}.StreamWebApp-container .swa-stack{height:100%;opacity:1;display:flex;flex-direction:column;align-items:stretch}.StreamWebApp-container .swa-side-panel-container{flex:1;display:flex;justify-content:stretch}.StreamWebApp-container.swa-sidepanel-enabled .swa-main-area-container{flex:1;min-width:0}.StreamWebApp-container .swa-messagebar-container{flex-grow:0;flex-shrink:1}.StreamWebApp-container .oneplayer-root{overflow:hidden;flex-grow:1;background-color:#000;aspect-ratio:16/9}.StreamWebApp-container .swa-below-video-container::-webkit-scrollbar{width:"9px";background:"transparent"}.StreamWebApp-container .swa-below-video-container::-webkit-scrollbar-thumb{min-height:50px;border-width:4px;border-style:solid;border-color:transparent;border-image:initial;background:content-box #323130;border-radius:10px}.StreamWebApp-container .swa-below-video-container{min-height:164px;display:flex;overflow:hidden}.StreamWebApp-container .swa-navigation-container-closed,.StreamWebApp-container .swa-navigation-container-open{margin-bottom:8px}@media (min-width:1024px){.StreamWebApp-container.swa-sidepanel-enabled .swa-main-area-container{margin:0 0 8px 8px;display:flex;align-items:stretch;flex:1;min-height:0}.StreamWebApp-container.swa-sidepanel-enabled .swa-video-stack{flex:3;display:flex;flex-direction:column;height:100%;align-items:stretch;min-width:0}.StreamWebApp-container.swa-sidepanel-enabled .oneplayer-root{border-radius:4px;aspect-ratio:unset}.StreamWebApp-container.swa-sidepanel-enabled .swa-below-video-container{min-height:190px;max-height:200px;max-width:1267px;height:33%}.StreamWebApp-container.swa-sidepanel-enabled .swa-navigation-container-open{margin:0;flex:1;min-width:436px;max-width:736px}.StreamWebApp-container.swa-sidepanel-enabled .swa-navigation-container-closed{width:84px;margin:0;flex:none}}@media (width > 640px) and (width < 1024px){.StreamWebApp-container.swa-sidepanel-enabled.swa-side-panel-open .oneplayer-root{border-radius:4px}.StreamWebApp-container.swa-sidepanel-enabled.swa-side-panel-open .swa-main-area-container{margin:0 0 8px 8px}}@media (min-width:950px){.StreamWebApp-container:not(.swa-sidepanel-enabled) .swa-main-area-container{margin:0 0 8px 8px;display:flex;align-items:stretch;flex:1;min-height:0}.StreamWebApp-container:not(.swa-sidepanel-enabled) .swa-video-stack{flex:3;display:flex;flex-direction:column;height:100%;align-items:stretch;min-width:0}.StreamWebApp-container:not(.swa-sidepanel-enabled) .oneplayer-root{border-radius:4px;aspect-ratio:unset}.StreamWebApp-container:not(.swa-sidepanel-enabled) .swa-below-video-container{min-height:190px;max-height:200px;max-width:1267px;height:33%}.StreamWebApp-container:not(.swa-sidepanel-enabled) .swa-navigation-container-open{margin:0;flex:1;min-width:436px;max-width:736px}.StreamWebApp-container:not(.swa-sidepanel-enabled) .swa-navigation-container-closed{width:84px;margin:0;flex:none}}'}])},4300:function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var a,i,r,o,s,c=1,d={},l=!1,u=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?a=function(e){t.nextTick(function(){m(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(o="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&m(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),a=function(t){e.postMessage(o+t,"*")}):e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){m(e.data)},a=function(e){r.port2.postMessage(e)}):u&&"onreadystatechange"in u.createElement("script")?(i=u.documentElement,a=function(e){var t=u.createElement("script");t.onreadystatechange=function(){m(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):a=function(e){setTimeout(m,0,e)},f.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return d[c]=i,a(c),c++},f.clearImmediate=p}function p(e){delete d[e]}function m(e){if(l)setTimeout(m,0,e);else{var t=d[e];if(t){l=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{p(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(2324),n(2553))},4301:function(e,t,n){"use strict";n.d(t,"e",function(){return h});var a=n(0),i=n(356),r=n(31),o=n(2921),s=n(105),c=n(2976),d=n(3327),l=n(3683),u=n(4),f=n(85),p=n(5621),m=n(3938),_=new Set(["m4s2"]),h=function(){function e(e,t){var n,c,d,p,_,h,b,g,v,y,S,D,I=this;this.getRequestParameters=function(e,t){return Object(a.__awaiter)(I,void 0,void 0,function(){var n,i,r;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return i=this._dataSource.getRequestParametersAsync(this._oneDriveItem,e,void 0,void 0,t),u.t.isActivated("02709ec1-b51c-4889-b2b5-43f70c0fecf9","10/6/2022","Add timeout to getRequestParams")?[3,2]:(r=new Promise(function(e,t){return window.setTimeout(function(){return t(new Error("getRequestParameters timed out"))},3e4)}),[4,Promise.race([i,r])]);case 1:return n=a.sent(),[3,4];case 2:return[4,i];case 3:n=a.sent(),a.label=4;case 4:return n?[2,{url:n.url,headers:n.headers}]:[2,{url:e}]}})})},this.getSourceUrl=function(e){return Object(a.__awaiter)(I,void 0,void 0,function(){var t,n,i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this._dataSource.getDownloadUrl(e)];case 1:return t=a.sent(),u.t.isActivated("482f1d8d-eb3d-4b5d-a3de-8b48bff015ec","10/31/2022","Engine 2.0 Source Type Telemetry")||"htmlMp4"===e.playbackType?[2,{url:t}]:(n=e.useBetaTranscode?"Ffmpeg":"Mf",i=e.forcedCdnParam?e.forcedHybridPlayback?"HybridCdn":"Cdn":"Origin",[2,{url:t,sourceType:{cdnTech:i,transcodingTech:n}}])}})})},this.decorateLegacyUrls=function(e,t,n){return e.then(function(e){return null==e?void 0:e.map(function(e){return{url:n(e,t,I._playbackHelper.hasTMRProgId())}})})};var x=t.itemProvider.getOneDriveItem();Object(r.isFeatureEnabled)(r.RemoveKoViewParamKillswitch)||e.isExposed(i.P)?this._params=e.consume(i.P).peek():this._params=e.consume(f.e).viewParams,!u.t.isActivated("98f42fb6-3016-4706-8aef-76c20d87364c","11/2/2023","Fix how we determine if user is in edit or view mode")&&e.isExposed(m.n)?this._isSwaEditMode=!e.consume(m.n):this._isSwaEditMode=l.e.isSwaEditMode(this._params),this._dataSource=t.dataSource,this._playbackHelper=t.playbackHelper,this._platformDetection=t.platformDetection;var C=Object(o.e)(r.HigherMeTAMaxBitrateEnabled,90200,r.HigherMeTAMaxBitrateEnabled,t.pageContext),O=C[0];C[1],this._metaBitrateThreshold=O?2e8:5e7,this._featuresPromise=this.getFeaturesEarlyPrewarm(x),this._playbackItemPromise=t.itemProvider.getOnePlayerPlaybackItem(),this._enableBootstrapping=!u.t.isActivated("64b2e846-c54d-4314-93d7-40e29d32e76b","3/6/2023","Enable media bootstrapping feature"),this._enableTechChoiceLog=!u.t.isActivated("009fee04-a0e9-4080-8e97-986752f23941","3/21/2023","Enable tech choice debug telemetry"),this._isNSEnabledInFileInfo=!u.t.isActivated("42445e88-82e2-4110-906b-faeb62c45eb3","5/15/2023","Use NoiseSuppressionEnabledByDefault from g_fileInfo"),this._isCheckFileInfoDefinedForGetItemCallEnabled=!u.t.isActivated("e254d0db-120d-41e6-9c44-f63830f3bd32","6/23/2023","when g_fileInfo is available, remove get item call dependency for playerenginerender"),this._isWatermarkEnabled=!u.t.isActivated("8cb0e8d7-9db1-4192-b98f-41ff33b93be0","6/12/2023","Use isWatermarkEnabled from g_fileInfo"),this._is4kFallbackFixEnabled=!u.t.isActivated("c3eb87a2-8cf8-4430-b46a-193f77966dbc","10/11/2023","Fix for 4k, removes progressive source for fallback"),this._isExternalSharingFallbackEnabled=!u.t.isActivated("36dae75e-a704-4570-b530-aa29cacdd2dc","10/25/2023","removes progressive source for fallback for users entitled to external sharing"),this._isHlsAllowedFixEnabled=!u.t.isActivated("944f75b9-7db2-43a1-ba2e-bc32f2d7b8b7","5/18/2023","Feature to remove check to see if hlspretranscodeenabled is enabled");var w=window;if(this.shouldUseBootstrapResources()){var E=null!==(n=w.g_streamBootstrapContent)&&void 0!==n?n:w.g_onePlayerData;if(E)this._playbackSessionId=null!==(d=null!==(c=w.g_playbackSessionId)&&void 0!==c?c:E.playbackSessionId)&&void 0!==d?d:void 0,this._parsedManifestBootstrapped=null!==(p=E.parsedVideoManifest)&&void 0!==p?p:void 0,this._segmentsBootstrapped=null!==(_=E.segments)&&void 0!==_?_:void 0,this._videoElementBootstrapped=null!==(h=E.videoElement)&&void 0!==h?h:void 0,this._enableTechChoiceLog&&(this._bootstrapTechChoice=E.techChoice),this._bootstrapMediaEditInfo=E.mediaEditInfo;else if(w.g_streamBootstrapContent={playbackSessionId:"",disable:!0},u.t.isActivated("59ad2d62-e5c0-4138-8c57-38c6cfaa6b70","3/30/2023","Enable telemetry to reason why bootstrap not working"))s.e.log("Bootstrapping disabled due to delayed inine script execution","OneUpPlaybackSourceProvider.DisableDelayedBootstrapping");else{var A=null===(g=void 0===(null===(b=null===window||void 0===window?void 0:window.g_fileInfo)||void 0===b?void 0:b.MediaServiceFastMetadata))||void 0===g||g;this._bootstrapTechChoice={reason:A?"MM":"LT"}}}var L=Object(o.e)(r.StreamEmbedRemoveGetItemDependencyEnabled,90179,r.StreamEmbedRemoveGetItemDependencyEnabled,t.pageContext),k=L[0];L[1],this._isNSEnabledInFileInfo=!!(null===(v=null===window||void 0===window?void 0:window.g_fileInfo)||void 0===v?void 0:v.NoiseSuppressionEnabledByDefault)&&k&&this._isNSEnabledInFileInfo,this._isCheckFileInfoDefinedForGetItemCallEnabled=this._isCheckFileInfoDefinedForGetItemCallEnabled&&k&&void 0!==(null===window||void 0===window?void 0:window.g_fileInfo),this._isWatermarkEnabled=!!(null===(y=null===window||void 0===window?void 0:window.g_fileInfo)||void 0===y?void 0:y.isWatermarkEnabled)&&this._isWatermarkEnabled;var M=Object(o.e)(r.OnePlayerRefactoredSourceProviderEnabled,90151,r.OnePlayerRefactoredSourceProviderEnabled,t.pageContext),P=M[0],T=(M[1],Object(o.e)(r.OnePlayerCdnOnlyEnabled,90138,r.OnePlayerCdnOnlyEnabled,t.pageContext)),U=T[0],F=(T[1],Object(o.e)(r.isPremiumVideoStreamingFeatureEnabled,90121,r.isPremiumVideoStreamingFeatureEnabled,t.pageContext)),H=F[0],R=(F[1],!u.t.isActivated("81544f08-a1e3-4c11-884e-55996b8e5ff9","07/04/2023","Enables hybrid CDN playback")&&!l.e.isDisableHybrid(this._params)),N=!u.t.isActivated("adf9dc5d-b5ac-4834-ad2f-479a6b610445","08/11/2023","Enables Toggling CDN for Anon Users")&&t.pageContext.isAnonymousGuestUser;this._enableRefactor=P,this._itemProvider=t.itemProvider,this._mediaType=t.mediaType,this._startTimeInSeconds=null!==(S=t.startTimeInSeconds)&&void 0!==S?S:0,this._enableCdnOnly=!R||U&&void 0!==(null===(D=w.g_fileInfo)||void 0===D?void 0:D.EncKey)&&!N,this._isPremiumVideoStreamingEnabled=H,this._premiumProcessingStatusPromise=this.getPremiumProcessingStatus(x),this._context=t.pageContext}return Object.defineProperty(e.prototype,"itemProvider",{get:function(){return this._itemProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mediaType",{get:function(){return this._mediaType},enumerable:!1,configurable:!0}),e.prototype.getSimplePlaybackSources=function(e){var t=this._playbackHelper.shouldFavorProgressive(this._mediaType),n=this._playbackHelper.getPlaybackUrls(),a={urls:this.decorateLegacyUrls(n.progressiveUrlPromise,!1,e),playbackFormat:"PROGRESSIVE",mimeType:"video/mp4"},i={urls:this.decorateLegacyUrls(n.hlsUrlPromise,!0,e),playbackFormat:"HLS",mimeType:"application/vnd.apple.mpegurl"},o={urls:this.decorateLegacyUrls(n.dashUrlPromise,!0,e),playbackFormat:"DASH",mimeType:"application/dash+xml"};return this.isSafariOrIos()&&"video"===this._mediaType&&!Object(r.isFeatureEnabled)(r.ForceHlsForSafariOnePlayerKillswitch)?[i,a,o]:t?[a,i,o]:[o,i,a]},e.prototype.getFeatures=function(){return this._featuresPromise},e.prototype.getBaseFeatures=function(){var e=!u.t.isActivated("f473854a-928b-4103-ad66-561568d9efee","8/28/2023","Killswitch for source provider soft trim support");return{enableRefactoredLogics:this._enableRefactor,isFetchOperationErrorLogKillswitchEnabled:Object(r.isFeatureEnabled)(r.FetchOperationErrorLogKillswitch),isMinVideoBandwidthKillswitchEnabled:Object(r.isFeatureEnabled)(r.MinVideoBandwithKillswitch),isHEVCFavorAdaptiveEnabled:!u.t.isActivated("88445ad7-b9f8-4b34-b20a-f4706ff6ec0b","08/24/2023","Favor adaptive when video codec is HEVC"),isMaxUrlLengthEnabled:!u.t.isActivated("896a60ff-7e39-495a-9ba0-e56ea7753123","01/30/2023","Enable check for max url length"),isDupPbSrcFixDisabled:u.t.isActivated("cb528897-1423-4b17-9061-0f3a86f633a7","02/14/2023","Disable the fix to prevent duplicated pb src creation"),playbackSessionId:this._playbackSessionId,isTechChoiceLogEnabled:this._enableTechChoiceLog,startTimeInSeconds:this._startTimeInSeconds,isPlayerNameHeaderEnabled:!u.t.isActivated("906c2a10-a759-4538-9c0e-4932f914aade","09/21/2023","Adds the play name header"),isNSEnabledInFileInfo:this._isNSEnabledInFileInfo,isCheckFileInfoDefinedForGetItemCallEnabled:this._isCheckFileInfoDefinedForGetItemCallEnabled,isWatermarkEnabled:this._isWatermarkEnabled,enableCdnOnly:this._enableCdnOnly,enablePrefetchPromise:this._premiumProcessingStatusPromise.then(function(e){return"PendingProxy"!==e}),premiumProcessingStatusPromise:this._premiumProcessingStatusPromise,enableOif:!u.t.isActivated("0ec66ed7-ed26-4a9a-ac2f-dc501e198f62","9/20/2023","Append oif(opt-in features) qsp to manifest url for 4k support"),isSoftTrimEnabled:e,isSwaEditMode:e?this._isSwaEditMode:void 0,isCdnFallbackFixEnabled:!u.t.isActivated("0967308b-2dd1-4361-a60e-815616d726d1","10/23/2023","Killswitch for hybrid cdn fallback fix"),useEngineLogger:!0,isHlsAllowedFixEnabled:this._isHlsAllowedFixEnabled}},e.prototype.getPlatformContext=function(){var e,t;return{isSafariOrIos:this.isSafariOrIos(),isWindowsAndEdge:(null===(e=this._platformDetection)||void 0===e?void 0:e.isWindows)&&(null===(t=this._platformDetection)||void 0===t?void 0:t.isEdge)}},e.prototype.getUrlsForParametersList=function(e,t){var n=this,a=this.PlaybackFormatToVideoPlaybackTypeMapper(t);return Promise.all(e.map(function(e){var i=e;return i.item=n._oneDriveItem,i.playbackType=a,i.useBetaTranscode=!0,i.enhanceAudio=!0,e.forcedHybridCdn?(i.forcedCdnParam="1",i.forcedHybridPlayback=!0):e.preferEncryption&&(i.forcedCdnParam="1"),Object(d.n)("OnePlayer.OneUpSourceProvider.Get".concat(t,"Url"),function(){return n.getSourceUrl(i)},{item:n._oneDriveItem,forcedHybridCdn:e.forcedHybridCdn,enhanceAudio:!0,playbackType:a,preferEncryption:e.preferEncryption,useBetaTranscode:!0})}))},e.prototype.getBootstrappedResources=function(){if(this.shouldUseBootstrapResources())return{mediaManifest:this._parsedManifestBootstrapped,mediaSegments:this._segmentsBootstrapped,mediaElement:this._videoElementBootstrapped,techChoice:this._bootstrapTechChoice,mediaEditInfo:this._bootstrapMediaEditInfo}},e.prototype.isSafariOrIos=function(){var e,t,n;return u.t.isActivated("9e5c421e-d0f9-4096-95a1-d2c23ef45c31","10/18/2023","Favors HLS if the OS is iOS or Safari")?null===(e=this._platformDetection)||void 0===e?void 0:e.isSafari:(null===(t=this._platformDetection)||void 0===t?void 0:t.isSafari)||(null===(n=this._platformDetection)||void 0===n?void 0:n.isIOS)},e.prototype.PlaybackFormatToVideoPlaybackTypeMapper=function(e){switch(e){case"DASH":return c.n.htmlDashling;case"PROGRESSIVE":return c.n.htmlMp4;case"HLS":return c.n.htmlHlsV6;default:return c.n.none}},e.prototype.getFeaturesEarlyPrewarm=function(e){var t,n,i,o,c;return Object(a.__awaiter)(this,void 0,void 0,function(){var d,f,p,m,_,h,b,g,v,y,S,D,I,x;return Object(a.__generator)(this,function(a){switch(a.label){case 0:d={},a.label=1;case 1:return a.trys.push([1,5,,6]),f=!u.t.isActivated("944f75b9-7db2-43a1-ba2e-bc32f2d7b8b7","5/18/2023","Feature to add to telemetry if dash playback is possible by window.MediaSource"),p=this,[4,e];case 2:return p._oneDriveItem=a.sent(),[4,this.getPremiumProcessingStatus(e)];case 3:return m=a.sent(),_=(null===(t=this._oneDriveItem.video)||void 0===t?void 0:t.bitrate)&&(null===(n=this._oneDriveItem.video)||void 0===n?void 0:n.bitrate)>this._metaBitrateThreshold&&(!m||"NotApplicable"===m),h=document.createElement("video"),b=h.canPlayType("application/vnd.apple.mpegurl"),h.remove(),g=this.isSafariOrIos(),v=void 0!==window.MediaSource&&void 0!==MediaSource.isTypeSupported,y=this._dataSource.isStreamingSupported(this._oneDriveItem),S=(S="maybe"===b||"probably"===b)&&!((null===(i=this._platformDetection)||void 0===i?void 0:i.isWindows)&&(null===(o=this._platformDetection)||void 0===o?void 0:o.isEdge)),f&&(d.isMediaSourceAvailable=v,d.isVideoBitrateAllowed=!_),d.ProgressiveUrlQspStreamClient=Object(r.isFeatureEnabled)(r.ProgressiveUrlQspStreamClient),d.isHlsPlaybackAllowed=(this._isHlsAllowedFixEnabled||this._dataSource.isHlsPlaybackSupported()&&S)&&y,d.isStreamingSupported=y,D=d,I="isProgressivePlaybackAllowed",[4,this.isProgressivePlaybackAllowed()];case 4:return D[I]=a.sent(),d.shouldPrioritizeHls=g&&void 0!==(null===(c=this._oneDriveItem)||void 0===c?void 0:c.video),d.additionalMetaQsps=u.t.isActivated("82bd67bf-de89-447b-9882-62083fbc41bb","09/23/2022","Forward arbitrary QSPs to MeTA")?null:l.e.additionalMetaQsps(this._params),[3,6];case 5:return x=a.sent(),s.e.log(x instanceof Error?x.message:void 0,"OneUpPlaybackSourceProviderInitFeaturesFailed"),[3,6];case 6:return[2,d]}})})},e.prototype.shouldUseBootstrapResources=function(){var e,t;return this._enableBootstrapping&&(null!==(t=null===(e=null===window||void 0===window?void 0:window.g_fileInfo)||void 0===e?void 0:e.StreamBootstrapOptions)&&void 0!==t?t:0)>0},e.prototype.isProgressivePlaybackAllowed=function(){var e,t,n;return Object(a.__awaiter)(this,void 0,void 0,function(){var i,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this._playbackItemPromise];case 1:return i=a.sent(),Object(r.isFeatureEnabled)(r.VideoEnableForceMeta)&&l.e.isForcedMeta()||this._dataSource.isDownloadBlocked(this._oneDriveItem)||l.e.getBlockDownloadParam(this._params)||"ConditionalAccessViewOnly"===i.itemStatus||this._isExternalSharingFallbackEnabled&&Object(p.e)(this._context.syntexStreamOptions)?[2,!1]:this._is4kFallbackFixEnabled?[4,this._premiumProcessingStatusPromise]:[3,3];case 2:if("FullEncode"===(o=a.sent())||"Proxy"===o)return[2,!1];a.label=3;case 3:return null!==(n=null==_?void 0:_.has(null===(t=null===(e=i.video)||void 0===e?void 0:e.codec)||void 0===t?void 0:t.toLowerCase()))&&void 0!==n&&n&&Object(r.isFeatureEnabled)(r.CheckIfCodecCanBePlayedNativelyKillswitch)?[2,!1]:[2,!0]}})})},e.prototype.getPremiumProcessingStatus=function(e){var t;return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(n){switch(n.label){case 0:if(!this._isPremiumVideoStreamingEnabled)return[2,Promise.resolve(void 0)];if(window.g_fileInfo)try{return[2,Promise.resolve(JSON.parse(null===(t=window.g_fileInfo)||void 0===t?void 0:t.MediaServiceFastMetadata).video.premiumProcessingStatus)]}catch(e){return[2,Promise.resolve(void 0)]}return[4,e.then(function(e){var t;return null===(t=e.video)||void 0===t?void 0:t.premiumProcessingStatus})];case 1:return[2,n.sent()]}})})},e}()},4302:function(e,t,n){"use strict";n.d(t,"e",function(){return S});var a=n(0),i=n(183),r=n(181),o=n(4),s=n(2921),c=n(356),d=n(120),l=n(52),u=n(31),f=n(2976),p=n(3327),m=n(145),_=n(105),h=n(2748),b=n(3683),g=n(85),v=new Set(["m4s2"]),y=[".webm"],S=function(){function e(e,t,n){var a,i,o,s,l=this;this._useProgIdForContentCategory=!1,this._favorAdaptiveForLongTMR=!1,this._favorAdaptiveForLongNonTMR=!1,this._codecUnsupportedNatively=!1,this._onePlayerAlwaysUseFFMPEG=!1,this.getPlaybackUrls=function(){return{dashUrlPromise:l._getDashUrls(),hlsUrlPromise:l._getHlsUrl(),progressiveUrlPromise:l._getProgressiveUrl()}},Object(u.isFeatureEnabled)(u.RemoveKoViewParamKillswitch)||e.isExposed(c.P)?this._viewParams=e.consume(c.P).peek():this._viewParams=e.consume(g.e).viewParams,this._videoItemDataSource=e.consume(d.De),this._platform=e.consume(r.e),this._item=t,this._forcedCdnParam=b.e.getForcedCdnParam(this._viewParams),this._isDownloadBlocked=b.e.getBlockDownloadParam(this._viewParams),this._audioEnhancementInOnePlayerEnabled=Object(u.isFeatureEnabled)(u.IncludeAudioEnhancementInVideoManifestFile),this._videoMetadataPromise=n,this._codecUnsupportedNatively=null!==(s=null==v?void 0:v.has(null===(o=null===(i=null===(a=this._item)||void 0===a?void 0:a.video)||void 0===i?void 0:i.fourCC)||void 0===o?void 0:o.toLowerCase()))&&void 0!==s&&s,this.initializeExperiments(e)}return e.getABRLimit=function(){return Object(u.isFeatureEnabled)(u.VideoABRQualityThrottle240)?240:Object(u.isFeatureEnabled)(u.VideoABRQualityThrottle360)?360:Object(u.isFeatureEnabled)(u.VideoABRQualityThrottle480)?480:Object(u.isFeatureEnabled)(u.VideoABRQualityThrottle720)?720:void 0},e.prototype.getItemUrl=function(){return this._item.itemFromServer&&this._item.itemFromServer.webUrl?this._item.itemFromServer.webUrl:this._item.openUrl||this.policyAllowsNative()&&this._item.openUrl?this._item.openUrl+"?web=1":void 0},e.prototype.getItemThumbnailUrl=function(){var e=(this._item.orientedThumbnail||this._item).thumbnail,t=null==e?void 0:e.url;if(t&&t.indexOf("width")<0&&t.indexOf("height")<0&&(t=e.getAligned({width:e.width,height:e.height},void 0).url),t&&this._item.eTag){var n="eTag=".concat(encodeURIComponent(this._item.eTag)),a=t.indexOf("cTag");if(a>=0){var i=t.indexOf("&",a),r=t.substring(a,i<0?void 0:i);t=t.replace(r,n)}else{var o=t.indexOf("?")<0?"?":"&";t="".concat(t).concat(o).concat(n)}}return t},e.prototype.isDownloadBlocked=function(){return this._videoItemDataSource.isDownloadBlocked(this._item)||this._isDownloadBlocked},e.prototype.policyAllowsNative=function(){return!this.isDownloadBlocked()},e.prototype.shouldFavorProgressive=function(e){var t,n,a,r,o=this._item.video,s=(void 0===o?{}:o).bitrate,c=void 0===s?void 0:s;if(this._item.itemStatus===i.t.ConditionalAccessViewOnly)return!1;if(this.isDownloadBlocked())return!1;if(this._item.video&&this.isSafariOrIOs()&&!Object(u.isFeatureEnabled)(u.ForceHlsForSafariOnePlayerKillswitch))return!0;var d=this.hasTMRProgId();if((null===(t=this._item.video)||void 0===t?void 0:t.duration)>36e5&&d&&this._favorAdaptiveForLongTMR)return!1;if((null===(n=this._item.video)||void 0===n?void 0:n.duration)>72e5&&!1===d&&this._favorAdaptiveForLongNonTMR)return!1;var l=(this._item.extension||"").toLowerCase();return!(".webm"===l||this._codecUnsupportedNatively&&Object(u.isFeatureEnabled)(u.CheckIfCodecCanBePlayedNativelyKillswitch)||(!this._item.audio||".mp3"!==l)&&"audio"!==e&&!(c&&c<=3e6)&&(c||".mp4"!==this._item.extension||!(this._item.size<=5242880))&&((null===(a=this._item.photo)||void 0===a?void 0:a.isLivePhoto)&&Object(u.isFeatureEnabled)(u.EnableLivePhotoVideos)?!Object(u.isFeatureEnabled)(u.EnableLivePhotoVideos_NativePlayback)||this._platform.isChrome:!(null===(r=this._item.photo)||void 0===r?void 0:r.isSamsungMotionPhoto)||!Object(u.isFeatureEnabled)(u.EnableSamsungMotionPhotoVideos)))},e.prototype.preloadOnePlayerNativeVideo=function(e,t,n){if(n&&0!==n.length&&n[0]){var a=document.createElement("video");if(!this._videoItemDataSource.isHlsPlaybackSupported()||!this._canPlayHls(a)){var i=t;return o.e.isActivated("da3528c7-c0d0-42f1-a576-7a40651b3ead","4/1/2022","fix preloadOnePlayerNative for fluent MTC")||Object(u.isFeatureEnabled)(u.EnableFluentMtcPreloadNativeKillswitch)||(i=t.querySelector(".video-engine-container")||t),this._initializeVideoElement({backgroundColor:e,container:i,videoElement:a}),Object(u.isFeatureEnabled)(u.AddCrossOriginAnonymousForProgressiveVideoKillswitch)||(a.crossOrigin="anonymous"),a.src=n[0],a.load(),a}}},e.prototype.prefetchManifest=function(e,t,n,a){var i=this.getPrefetchManifestParams(this._item,a);return this._useProgIdForContentCategory?e.prefetchManifestLite(t,i):e.prefetchManifest(n,i)},e.prototype.hasTMRProgId=function(){var e=this._item&&this._item.properties&&this._item.properties.ProgId;if(void 0!==e)return"Media.Meeting"===e},e.prototype.shouldUseProgIdForContentType=function(){return this._useProgIdForContentCategory},e.prototype.getPrefetchManifestParams=function(e,t){var n=this,a=function(e){return{getDownloadRequestParameters:t,contentType:e,enableHybridPlayback:!0,enableNoiseSuppression:n._audioEnhancementInOnePlayerEnabled}};return this._useProgIdForContentCategory?a(this.hasTMRProgId()?"Meeting":h.MISSING_TELEMETRY_VALUE):this._videoMetadataPromise.then(function(e){var t,n;return a(null===(n=null===(t=null==e?void 0:e.media)||void 0===t?void 0:t.mediaSource)||void 0===n?void 0:n.contentCategory)})},e.prototype._getHlsUrl=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return this._videoItemDataSource.isHlsPlaybackSupported()&&this._videoItemDataSource.isStreamingSupported(this._item)&&!this._isWindowsEdge()?(e=!Object(u.isFeatureEnabled)(u.OnePlayerEnableHlsFFMPEGKillSwitch)||this.shouldForceAltTranscode(y),t={item:this._item,playbackType:f.n.htmlHlsV6,enhanceAudio:this._audioEnhancementInOnePlayerEnabled,useBetaTranscode:e},[4,Object(p.n)("OnePlayer.PlaybackHelper.GetHlsUrl",this._videoItemDataSource.getDownloadUrl.bind(this._videoItemDataSource,t))]):[2,void 0];case 1:return[2,[n.sent()]]}})})},e.prototype._getProgressiveUrl=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,r,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return Object(u.isFeatureEnabled)(u.VideoEnableForceMeta)&&b.e.isForcedMeta()||this.isDownloadBlocked()||this._item.itemStatus===i.t.ConditionalAccessViewOnly||this._codecUnsupportedNatively&&Object(u.isFeatureEnabled)(u.CheckIfCodecCanBePlayedNativelyKillswitch)?[2,void 0]:(e={item:this._item,playbackType:f.n.htmlMp4},[4,Object(p.n)("OnePlayer.PlaybackHelper.GetProgressiveUrl",this._videoItemDataSource.getDownloadUrl.bind(this._videoItemDataSource,e))]);case 1:return t=a.sent(),n=m.e.generate().toString(),r=t.indexOf("?")>=0?"&":"?",t+=r+"correlationid="+n,Object(u.isFeatureEnabled)(u.ProgressiveUrlQspStreamClient)&&(o=t.indexOf("?")>=0?"&":"?",t+=o+"client=streamvideoplayer"),[2,[t]]}})})},e.prototype.shouldForceAltTranscode=function(e){var t=(this._item.extension||"").toLowerCase();return e.indexOf(t)>=0},e.prototype._getDashUrls=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,i,r,o,s=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return this._videoItemDataSource.isStreamingSupported(this._item)?[4,this._shouldPreferStreamingForTMR()]:[2];case 1:return e=a.sent()||!1,t=b.e.isPlaybackCDNEnabled(this._viewParams),n=Object(u.isFeatureEnabled)(u.UseAltTranscodeForDashManifests),i=Object(u.isFeatureEnabled)(u.ForceTMRToMediaFoundation),r=f.n.htmlDashling,o=[],this.shouldForceAltTranscode(y)||this._onePlayerAlwaysUseFFMPEG||o.push({item:this._item,playbackType:r,enhanceAudio:this._audioEnhancementInOnePlayerEnabled}),this._onePlayerAlwaysUseFFMPEG||n&&(!e||!i)?(o.unshift({item:this._item,useBetaTranscode:!0,playbackType:r,enhanceAudio:this._audioEnhancementInOnePlayerEnabled}),t&&o.unshift({item:this._item,useBetaTranscode:!0,preferEncryption:!0,forcedCdnParam:this._forcedCdnParam,playbackType:r,enhanceAudio:this._audioEnhancementInOnePlayerEnabled})):!t||this.shouldForceAltTranscode(y)||this._onePlayerAlwaysUseFFMPEG||o.unshift({item:this._item,preferEncryption:!0,forcedCdnParam:this._forcedCdnParam,playbackType:r,enhanceAudio:this._audioEnhancementInOnePlayerEnabled}),o&&0===o.length?[2]:[2,Promise.all(o.map(function(e){return Object(p.n)("OnePlayer.PlaybackHelper.GetDashUrl",s._videoItemDataSource.getDownloadUrl.bind(s._videoItemDataSource,e),{preferEncryption:e.preferEncryption,forcedCdnParam:e.forcedCdnParam,enhanceAudio:e.enhanceAudio})}))]}})})},e.prototype._shouldPreferStreamingForTMR=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return Object(u.isFeatureEnabled)(u.TMRMetaRedirect)&&Object(u.isFeatureEnabled)(u.ForceTMRToMediaFoundation)?[4,this._isTeamsMeetingRecording()]:[3,2];case 1:return[2,e.sent()];case 2:return[2,!1]}})})},e.prototype._isTeamsMeetingRecording=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return e=this.hasTMRProgId(),this._useProgIdForContentCategory&&void 0!==e?[2,e]:[4,this._videoMetadataPromise];case 1:return[2,(t=n.sent())&&t.media&&t.media.mediaSource&&"Meeting"===t.media.mediaSource.contentCategory&&t.source&&"Teams"===t.source.application]}})})},e.prototype._isWindowsEdge=function(){return this._platform.isWindows&&this._platform.isEdge},e.prototype._initializeVideoElement=function(e){var t=e.videoElement?e.videoElement:document.createElement("video");if(t.className="azuremediaplayer amp-big-play-centered one-player-skin",t.style.width="100%",t.style.height="100%",e.backgroundColor&&(t.style.backgroundColor=e.backgroundColor),t.setAttribute("playsInline",""),o.e.isActivated("3ec370d3-bca4-496d-8428-44733c4606b9","12/05/2022","avoid creating global style element")){var n=document.createElement("style");o.e.isActivated("8c4686ab-184b-438b-af90-ead1f8eb1aae","03/05/2020","fix outline for mouse clicks in the player")?n.innerHTML=".azuremediaplayer .vjs-player .vjs-tech:focus { outline: 2px solid white; outline-offset: -2px; }":n.innerHTML=".azuremediaplayer .vjs-player .vjs-tech:focus-visible { outline: 2px solid white; outline-offset: -2px; }",document.head.appendChild(n)}return e.container.innerHTML="",e.container.appendChild(t),t.setAttribute("preload","auto"),t},e.prototype._canPlayHls=function(e){var t=e.canPlayType("application/vnd.apple.mpegurl");return"maybe"===t||"probably"===t},e.prototype.initializeExperiments=function(e){var t,n;try{var a=e.consume(l.p);this._useProgIdForContentCategory=void 0!==this.hasTMRProgId();var i=Object(s.e)(u.OnePlayerFavorAdaptiveForLongerTMRVideo,90135,u.OnePlayerFavorAdaptiveForLongerTMRVideo,a),r=i[0];i[1],this._favorAdaptiveForLongTMR=r,t=Object(s.e)(u.OnePlayerFavorAdaptiveForLongerNonTMRVideo,90136,u.OnePlayerFavorAdaptiveForLongerNonTMRVideo,a),this._favorAdaptiveForLongNonTMR=t[0],t[1],n=Object(s.e)(u.OnePlayerAlwaysUseFFMPEG,90149,u.OnePlayerAlwaysUseFFMPEG,a),this._onePlayerAlwaysUseFFMPEG=n[0],n[1]}catch(e){_.e.log(e instanceof Error?e.message:void 0,"OnePlayerPlaybackHelperInitExperimentFailed")}},e.prototype.isSafariOrIOs=function(){var e,t,n;return o.e.isActivated("9e5c421e-d0f9-4096-95a1-d2c23ef45c31","10/18/2023","Favors HLS if the OS is iOS or Safari")?null===(e=this._platform)||void 0===e?void 0:e.isSafari:(null===(t=this._platform)||void 0===t?void 0:t.isSafari)||(null===(n=this._platform)||void 0===n?void 0:n.isIOS)},e}()},4303:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(0),i=n(4);function r(e,t,n,r){return Object(a.__awaiter)(this,void 0,void 0,function(){var o,s,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return s=e.getRequestParametersAsync(t.item,n,void 0,void 0,r),i.e.isActivated("02709ec1-b51c-4889-b2b5-43f70c0fecf9","10/6/2022","Add timeout to getRequestParams")?[3,2]:(c=new Promise(function(e,t){return window.setTimeout(function(){return t(new Error("getRequestParameters timed out"))},3e4)}),[4,Promise.race([s,c])]);case 1:return o=a.sent(),[3,4];case 2:return[4,s];case 3:o=a.sent(),a.label=4;case 4:return[2,{url:o.url,headers:o.headers}]}})})}},4304:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(0),i=n(183),r=n(4),o=function(){function e(e){this._oneDriveItemPromise=e}return e.itemStatusMapper=function(e){switch(e){case i.e.Active:return"Active";case i.e.ConditionalAccessViewOnly:return"ConditionalAccessViewOnly";case i.e.Restricted:return"Restricted";case i.e.RestrictedICN:return"RestrictedICN";default:return"ConditionalAccessBlocked"}},e.prototype.getOnePlayerItem=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return this._onePlayerItem?[3,2]:[4,Promise.all([this._oneDriveItemPromise])];case 1:e=t.sent()[0],this._onePlayerItem={fileName:e.name},t.label=2;case 2:return[2,this._onePlayerItem]}})})},e.prototype.getOnePlayerPlaybackItem=function(){var t,n,i,o,s,c,d;return Object(a.__awaiter)(this,void 0,void 0,function(){var l,u;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return l=!r.t.isActivated("4a36605c-6de4-44dc-8cb0-1fd00a932049","11/8/2023","Get edit information from RLDAS for soft trim"),this._playbackItem?[3,2]:[4,this._oneDriveItemPromise];case 1:u=a.sent(),this._playbackItem={id:u.id,extension:u.extension,isDownloadAllowed:!1,itemStatus:e.itemStatusMapper(u.itemStatus),bitrate:null===(t=u.video)||void 0===t?void 0:t.bitrate,sizeInBytes:u.size,isLivePhoto:null===(n=u.photo)||void 0===n?void 0:n.isLivePhoto,isSamsungMotionPhoto:null===(i=u.photo)||void 0===i?void 0:i.isSamsungMotionPhoto,isItemTMR:"Media.Meeting"===(null===(o=u.properties)||void 0===o?void 0:o.ProgId),altManifestMetadata:null===(s=u.video)||void 0===s?void 0:s.altManifestMetadata,edits:null!==(d=null===(c=null===window||void 0===window?void 0:window.g_fileInfo)||void 0===c?void 0:c.edits)&&void 0!==d?d:l&&u.mediaEdits?JSON.stringify(u.mediaEdits):void 0},u.video&&(this._playbackItem.video={durationInMs:u.video.duration,codec:u.video.fourCC}),u.audio&&(this._playbackItem.audio={durationInMs:u.audio.duration}),a.label=2;case 2:return[2,this._playbackItem]}})})},e.prototype.getOneDriveItem=function(){return this._oneDriveItemPromise},e}()},4305:function(e,t,n){"use strict";n.r(t),n.d(t,"getOnePlayerContext",function(){return g}),n.d(t,"onePlayerLoaderResourceKey",function(){return v}),n.d(t,"getMediaServiceUrl",function(){return I}),n.d(t,"getMediaStorageServiceName",function(){return A}),n.d(t,"getFileNameWithoutExtension",function(){return L});var a=n(6),i=n(52),r=n(2268),o=n(146),s=n(830),c=n(498),d=n(2748),l=n(50),u=n(51),f=n(4),p=n(31),m=n(105),_=n(5621),h=n(2921),b=["onebox","edog"],g=new a.t({name:"OnePlayerResourceKeys",factory:{dependencies:{pageContext:i.p.optional,itemParentHelper:r.e.optional},create:function(e){var t=e.pageContext,n=e.itemParentHelper;return{instance:function(e){return function(e,t,n){var a,i,r,u,m,g,v,k,M,P,T,U,F,H,R=t.siteId,N=t.webId;if(!f.t.isActivated("c494a991-c0db-420a-8a9e-f7d1f7918fe9","07/15/2022","check for siteId/webId from parent in case item is shared")&&n){var B=null===(a=n.getFacetedAncestorOrSelf(e.item,"subsite"))||void 0===a?void 0:a.peek();B&&B.subsite&&B.subsite.serverRelativeUrl!==t.webAbsoluteUrl&&(R=B.subsite.siteCollectionId,N=B.subsite.id)}var j,V,z=Object(o.normalizeLower)(R),G=Object(o.normalizeLower)(t.siteSubscriptionId),K=e.item.urls?new l.e(e.item.urls[s.t.itemUrl]).authority:void 0,W=f.t.isActivated("86df932c-b7c1-4f77-a7a1-03b1b41176bf","03/17/2023","Swtiching to use CloudType instead of env or env2")?Object(c.e)(t):Object(c.t)(t.cloudType),q=function(e){var t,n=window._spModuleLink&&"dev"===window._spModuleLink.buildNumber,a=e.siteAbsoluteUrl&&-1!==(null===(t=e.siteAbsoluteUrl)||void 0===t?void 0:t.indexOf("a830edad9050849")),i=new Set(["054b50dc-8bea-4940-bd0e-271be5928608","0ebe4f4d-3e45-4fdf-80bc-aeb7816c3ab5","1cb53b26-fd5c-4c08-b117-b20c90912359","2c1b5888-bfae-48ff-9c26-39fd5d4a2fe9","2d0164c4-a960-45c6-8509-300064ce9b55","4a2be99d-1040-45b3-be99-87688abfee1a","579c6055-008e-4162-b26b-252b2fd6b744","60bcdb18-3e8b-4c8d-8e03-c9bd0a442378","632899f8-2ea1-4604-8413-27bd2892079f","697d52b0-356e-464c-bcc2-d4535c56516e","6aea4a71-c5c5-4e33-9fad-a3ac52092039","6cf30ed2-ba6a-4183-a7a9-69aeab90c069","a0783b62-a438-4df4-b01a-1922ce21ddbe","ac4dbc32-815c-48d8-8350-7e3de69af9d1","b6338c92-533e-4f6d-a327-994263712399","c0c7df8b-da15-4a6d-85b0-cf0b289bf8da","cc95c0e3-ad6d-42cf-8954-37a6eb011802"]);return a||n||i.has(e.siteSubscriptionId)||i.has(e.aadTenantId)}(t),Q=function(e){return(e=e&&e.replace("{",""))&&e.replace("}","")},Y=f.t.isActivated("c5b8ab39-8e01-4de0-911a-b788172c7d74","08/09/2022","use IOneDriveItem FileLeafRef property instead of name"),J=!f.t.isActivated("3b864931-6d7c-4de4-b7b2-db7366eadf34","08/17/2022","Use isAnonymousGuestUser flag in pageContext to determine user type"),X=!f.t.isActivated("32bd3100-5bbd-4f3a-99c5-03eb3069592a","7/27/2023","Get syntexStreamOptions from pageContext"),Z=Object(h.e)(p.isPremiumVideoStreamingFeatureEnabled,90121,p.isPremiumVideoStreamingFeatureEnabled,t),$=Z[0],ee=(Z[1],$?null===(r=null===(i=e.item)||void 0===i?void 0:i.video)||void 0===r?void 0:r.premiumProcessingStatus:void 0);return j=J?t.isAnonymousGuestUser?"BusinessAnonymous":"Business":t.userLoginName?"Business":"BusinessAnonymous",V=!f.t.isActivated("5ec031b1-e270-4bdd-8c72-638a99a62d60","10/23/2023","Get edits information from RLDAS infromation for Soft trim")&&(null===(u=e.item)||void 0===u?void 0:u.mediaEdits)?null===(m=e.item)||void 0===m?void 0:m.mediaEdits:window&&window.g_fileInfo&&window.g_fileInfo.edits&&JSON.parse(window.g_fileInfo.edits),{flightingContext:{flightSessionId:e.flightSessionId,filters:e.filters,eTag:String(e.eTag),ring:String(e.ring),flightDataIsFromCache:e.flightDataIsFromCache},userContext:{principalId:t.systemUserKey||d.MISSING_TELEMETRY_VALUE,tenantId:C(t),resourceTenantId:O(t),userId:t.aadUserId?t.aadUserId:d.MISSING_TELEMETRY_VALUE,userEmail:t.userEmail?t.userEmail:d.MISSING_TELEMETRY_VALUE,accountType:j,language:t.currentUICultureName||d.MISSING_TELEMETRY_VALUE,displayName:t.userDisplayName,isExternalGuestUser:t.isExternalGuestUser},hostContext:{app:x(e)||d.MISSING_TELEMETRY_VALUE,integrationType:e.integrationType,platform:e.platform,environment:q||b.indexOf(W)>=0?"Dev":"Prod",correlationId:e.hostCorrelationId,view:e.hostView||d.MISSING_TELEMETRY_VALUE,version:e.hostVersion||d.MISSING_TELEMETRY_VALUE,component:e.hostComponent||d.MISSING_TELEMETRY_VALUE,mode:e.hostMode||d.MISSING_TELEMETRY_VALUE,sessionId:e.hostSessionId||d.MISSING_TELEMETRY_VALUE,extraTelemetry:e.extraTelemetry,referralApp:e.referralApp,referralAppPlatform:e.referralAppPlatform,referralView:e.referralView,referralMode:e.referralMode,referralPlaybackSessionId:e.referralPlaybackSessionId},odspContext:{siteSubscriptionId:G||d.MISSING_TELEMETRY_VALUE,siteId:z||d.MISSING_TELEMETRY_VALUE,farmName:t.farmName||d.MISSING_TELEMETRY_VALUE,farmLabel:t.farmLabel||d.MISSING_TELEMETRY_VALUE,correlationId:t.CorrelationId?t.CorrelationId:d.MISSING_TELEMETRY_VALUE,workload:d.MISSING_TELEMETRY_VALUE,ring:q?"o365test":W,itemId:(null===(g=e.item.graph)||void 0===g?void 0:g.itemId)||d.MISSING_TELEMETRY_VALUE,itemPath:D(e.item),driveId:(null===(v=e.item.graph)||void 0===v?void 0:v.driveId)||d.MISSING_TELEMETRY_VALUE,fileDuration:(null===(k=e.item.video)||void 0===k?void 0:k.duration)||-1,vroomRouteUrl:K||d.MISSING_TELEMETRY_VALUE,webTitle:t.webTitle||d.MISSING_TELEMETRY_VALUE,listTitle:t.listTitle||d.MISSING_TELEMETRY_VALUE,tenantInstanceId:X?y(t,K):void 0,syntextStreamOptions:X?t.syntexStreamOptions:void 0},itemMetadata:{fileName:new d.ObservableProperty(L(!Y&&(null===(M=e.item.properties)||void 0===M?void 0:M.FileLeafRef)?null===(P=e.item.properties)||void 0===P?void 0:P.FileLeafRef:e.item.name)||d.MISSING_TELEMETRY_VALUE),itemSizeInBytes:e&&e.item&&e.item.size||void 0,mediaType:e.mediaType,itemUrl:e.playbackHelper.getItemUrl(),itemThumbnailUrl:e.playbackHelper.getItemThumbnailUrl()||d.MISSING_TELEMETRY_VALUE,userCanEditItem:w(e),itemWidth:null===(U=null===(T=e.item)||void 0===T?void 0:T.video)||void 0===U?void 0:U.width,itemHeight:null===(H=null===(F=e.item)||void 0===F?void 0:F.video)||void 0===H?void 0:H.height,codec:E(e),mediaEdits:V,premiumProcessingStatus:ee},mediaServiceContext:{extension:e.item.extension,mediaService:A(e.item),mediaServiceUrl:I(e.item),documentId:e.item.urls&&e.item.urls[s.t.itemUrl]||d.MISSING_TELEMETRY_VALUE,listItemUniqueId:e.item.properties&&Q(e.item.properties.uniqueId)||d.MISSING_TELEMETRY_VALUE,graphId:e.item.itemId||d.MISSING_TELEMETRY_VALUE,webId:Q(N)||d.MISSING_TELEMETRY_VALUE,bitrate:e.item.video&&e.item.video.bitrate||-1,isTeamsMeetingRecording:S(e.playbackHelper),isExternalVideoSharingEnabled:X?Object(_.e)(t.syntexStreamOptions):void 0}}}(e,t,n)}}}}}),v=new a.t({name:"".concat("OnePlayerResourceKeys",".onePlayerLoader"),factory:{dependencies:{pageContext:i.p.optional},create:function(e){var t=!1,n=Object(p.isFeatureEnabled)(p.EnableOnePlayerFluentMtcOptimization);return{instance:function(){t||(t=!0,Object(d.loadOnePlayerBundle)().then(function(t){t.prewarmResources(e.pageContext.currentUICultureName,n,Object(p.isFeatureEnabled)(p.OnePlayerFastNextGenEngineEnabled),!f.t.isActivated("e7942b2c-b40e-4c46-a945-05af00813af0","11/03/2022","optimization not to load AMP resources in prewarm"))}).catch(function(){t=!1}))}}}}});function y(e,t){var n,a="OnePlayerResourceKeysInstanceIdFailure";if(e.webAbsoluteUrl&&e.multiGeoInfo&&e.multiGeoInfo.length)try{var i=new URL(t||e.webAbsoluteUrl).host,r=e.multiGeoInfo.find(function(e){return e.MySiteHostUrl&&new URL(e.MySiteHostUrl).host===i||e.RootSiteUrl&&new URL(e.RootSiteUrl).host===i||e.PortalUrl&&new URL(e.PortalUrl).host===i}),o=null==r?void 0:r.InstanceId;return o||m.e.log("Not found. MultiGeoInfo.length=".concat(null===(n=e.multiGeoInfo)||void 0===n?void 0:n.length),a),o}catch(e){m.e.log(e instanceof Error?e.message:void 0,a)}else m.e.log("missing context info",a)}function S(e){if(e.shouldUseProgIdForContentType())return e.hasTMRProgId()}function D(e){if(e.UNSAFE_parent){for(var t=[],n=e;n;n=n.UNSAFE_parent){if(!n.name)return;t.unshift(n.name)}return t}}function I(e){return e.urls&&e.urls[s.t.video]?new l.e(e.urls[s.t.video]).authority:d.MISSING_TELEMETRY_VALUE}function x(e){return"OneUpEmbedPage"!==e.integrationType||e.app?e.app:"DirectEmbedPage"}function C(e){return e.homeTenantId?e.homeTenantId:e.aadTenantId?e.aadTenantId:d.MISSING_TELEMETRY_VALUE}function O(e){if(e.homeTenantId)return e.aadTenantId}function w(e){var t=!f.t.isActivated("12ffbaad-899c-43ce-87a7-32d36ef95af1","04/20/2022","Check permMask for ODSPOnePlayerHost integration type");if("OneUp"===e.integrationType||"OneUpEmbedPage"===e.integrationType||t&&"ODSPOnePlayerHost"===e.integrationType)return u.e.hasItemPermission(e.item,u.e.editListItems)}function E(e){var t,n;return f.t.isActivated("159a05d2-f9f5-4e70-9d0b-a1cfe7116caf","07/20/2022","Add codec to item metadata")||null===(n=null===(t=e.item)||void 0===t?void 0:t.video)||void 0===n?void 0:n.fourCC}function A(e){var t,n=null===(t=e.graph)||void 0===t?void 0:t.driveType;if(!n)return d.MISSING_TELEMETRY_VALUE;switch(n){case"business":return"ODB";case"personal":return"ODC";case"documentLibrary":return"SPO";default:return"unknown"}}var L=function(e){return(null==e?void 0:e.substring(0,null==e?void 0:e.lastIndexOf(".")))||e}},4306:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(85),r=n(2748),o=n(10);function s(e,t,n,s,c){var d,l,u,f,p,m,_,h,b,g,v,y,S,D,I,x,C,O,w,E,A,L,k,M,P,T,U,F,H,R,N,B,j,V,z,G,K,W;return Object(a.__awaiter)(this,void 0,void 0,function(){var q,Q,Y,J,X;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return q=void 0,e&&(Q=t.consume(i.e).viewParams,q=Q?Q.commentId:void 0),[4,s];case 1:return Y=a.sent(),J=!o.e.isActivated("95772c85-97e8-41f2-81f5-86b37479fbbb","08/01/2022","Disable checking page context to determine if comments are disabled on the tenant level"),X=!o.e.isActivated("0d5f621c-e32b-49ef-8c9f-6e34568987d1","06/22/2023","Disable checking media.viewpoint.isTranscriptionTranslationAllowed"),[2,{contentType:(null===(l=null===(d=null==Y?void 0:Y.media)||void 0===d?void 0:d.mediaSource)||void 0===l?void 0:l.contentCategory)||"File",contentSubtype:(null===(f=null===(u=null==Y?void 0:Y.media)||void 0===u?void 0:u.mediaSource)||void 0===f?void 0:f.contentType)||"",contentSourceApplication:(null===(p=null==Y?void 0:Y.source)||void 0===p?void 0:p.application)||r.MISSING_TELEMETRY_VALUE,meetingRecordingMetadata:{externalId:(null===(m=null==Y?void 0:Y.source)||void 0===m?void 0:m.externalId)||r.MISSING_TELEMETRY_VALUE,threadId:(null===(_=null==Y?void 0:Y.source)||void 0===_?void 0:_.threadId)||r.MISSING_TELEMETRY_VALUE,meetingOrganizerId:(null===(h=null==Y?void 0:Y.source)||void 0===h?void 0:h.meetingOrganizerId)||r.MISSING_TELEMETRY_VALUE,meetingOrganizerTenantId:(null===(b=null==Y?void 0:Y.source)||void 0===b?void 0:b.meetingOrganizerTenantId)||r.MISSING_TELEMETRY_VALUE,iCalUId:(null===(g=null==Y?void 0:Y.source)||void 0===g?void 0:g.iCalUid)||r.MISSING_TELEMETRY_VALUE,recordingStartTime:(null===(v=null==Y?void 0:Y.media)||void 0===v?void 0:v.recordingStartDateTime)||r.MISSING_TELEMETRY_VALUE,recordingEndTime:(null===(y=null==Y?void 0:Y.media)||void 0===y?void 0:y.recordingEndDateTime)||r.MISSING_TELEMETRY_VALUE,groupId:(null===(S=null==Y?void 0:Y.source)||void 0===S?void 0:S.groupId)||r.MISSING_TELEMETRY_VALUE},mediaSettings:{areAlternateStreamsSupported:null===(D=null==Y?void 0:Y.media)||void 0===D?void 0:D.areExtendedFeaturesEnabled,isTranscriptionShown:null===(I=null==Y?void 0:Y.media)||void 0===I?void 0:I.isTranscriptionShown,isTranscriptionAllowed:null===(C=null===(x=null==Y?void 0:Y.media)||void 0===x?void 0:x.viewpoint)||void 0===C?void 0:C.isTranscriptionAllowed,isTranscriptionTranslationAllowed:X&&(null===(w=null===(O=null==Y?void 0:Y.media)||void 0===O?void 0:O.viewpoint)||void 0===w?void 0:w.isTranscriptionTranslationAllowed),spokenLanguageTag:null===(E=null==Y?void 0:Y.media)||void 0===E?void 0:E.spokenLanguageTag,isNoiseSuppressionControlShown:null===(A=null==Y?void 0:Y.media)||void 0===A?void 0:A.isNoiseSuppressionControlShown,noiseSuppressionEnabledByDefault:null===(L=null==Y?void 0:Y.media)||void 0===L?void 0:L.noiseSuppressionEnabledByDefault,tableOfContentsVisibility:c(null===(k=null==Y?void 0:Y.media)||void 0===k?void 0:k.tableOfContentsVisibility),aboutVisibility:c(null===(M=null==Y?void 0:Y.media)||void 0===M?void 0:M.aboutVisibility),analyticsVisibility:c(null===(P=null==Y?void 0:Y.media)||void 0===P?void 0:P.analyticsVisibility),notesVisibility:c(null===(T=null==Y?void 0:Y.media)||void 0===T?void 0:T.notesVisibility),chatVisibility:c(null===(U=null==Y?void 0:Y.media)||void 0===U?void 0:U.chatVisibility),commentsOptions:{areCommentsEnabled:!1===(null===(H=null===(F=null==Y?void 0:Y.commentSettings)||void 0===F?void 0:F.commentingDisabled)||void 0===H?void 0:H.isDisabled),targetCommentId:e?q:void 0,commentsDisabledOnTenant:J?n.CommentsOnFilesDisabled:void 0,viewersCanCommentDisabledOnTenant:J?n.ViewersCanCommentOnMediaDisabled:void 0},interactivityOptions:o.e.isActivated("b66215b0-cae8-45ef-af60-9e333cf92a7e","06/10/2023","KillSwitch for reading firstInteractiveContentOffset from g_fileInfo")?void 0:{firstInteractivityPoint:null===(N=null===(R=null==Y?void 0:Y.media)||void 0===R?void 0:R.interactivity)||void 0===N?void 0:N.firstInteractiveContentOffset,isInteractiveContentShown:null===(j=null===(B=null==Y?void 0:Y.media)||void 0===B?void 0:B.interactivity)||void 0===j?void 0:j.isInteractiveContentShown}},sharePointLocator:{siteUrl:(null===(V=null==Y?void 0:Y.sharepointIds)||void 0===V?void 0:V.siteUrl)||r.MISSING_TELEMETRY_VALUE,listId:(null===(z=null==Y?void 0:Y.sharepointIds)||void 0===z?void 0:z.listId)||r.MISSING_TELEMETRY_VALUE,listItemId:(null===(G=null==Y?void 0:Y.sharepointIds)||void 0===G?void 0:G.listItemId)||r.MISSING_TELEMETRY_VALUE,ctag:(null==Y?void 0:Y.cTag)||r.MISSING_TELEMETRY_VALUE,etag:(null==Y?void 0:Y.eTag)||r.MISSING_TELEMETRY_VALUE},sharePointTitle:(null===(W=null===(K=null==Y?void 0:Y.listItem)||void 0===K?void 0:K.fields)||void 0===W?void 0:W.Title)||void 0,errorCode:null==Y?void 0:Y.errorCode}]}})})}},4307:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n(4723);function i(e){if(!e)return a.e;switch(e){case"business":return"ODB";case"personal":return"ODC";case"documentLibrary":return"SPO";default:return"unknown"}}function r(e){if("OneUpEmbedPage"===e||"OneUpMicroservice"===e||"StreamEmbedPage"===e||"XplatPackage"===e){var t=function(e){if("function"==typeof URL&&"function"==typeof URLSearchParams){var t=new URL(e);if(t.searchParams&&"function"==typeof t.searchParams.set)return t}}(window.location.href);return!!t&&"readwrite"===t.searchParams.get("auth")}return!0}},4308:function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"t",function(){return c}),n.d(t,"n",function(){return d});var a=n(0),i=n(105),r=n(2921),o=n(31),s=function(e){var t=Object(r.e)(o.SyntexWebVideoWatchedMetering,90189,o.SyntexWebVideoWatchedMetering,e),n=t[0];return t[1],n},c=function(e){var t=Object(r.e)(o.PlayerEngineProgressiveServiceWorker,90120,o.PlayerEngineProgressiveServiceWorker,e),n=t[0];return t[1],n};function d(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,r;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,n.ee(86,4497)];case 1:e=a.sent().default,t=new e,a.label=2;case 2:return a.trys.push([2,4,,5]),[4,t.register()];case 3:return a.sent(),i.e.log("RegisterOnePlayerServiceWorker"),[3,5];case 4:return r=a.sent(),i.e.log(r,"RegisterOnePlayerServiceWorkerFailed"),[3,5];case 5:return[2]}})})}},4309:function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n(4),i=function(e,t,n,i,r){var s=!a.t.isActivated("73d035d9-17bc-4123-a86d-9b48099e4fd1","16/2/2023","Provide performance related values to hosts through post messages"),c=0;e.currentTimeInSeconds.subscribe(function(e){if(e&&!isNaN(e)){var n=e-c;Math.abs(n)>=.5&&(t.sendNotification({notification:"one-player-current-time",currentTime:e}),c=e)}}),e.playState.subscribe(function(n){c=0;var a=e.playerStats?e.playerStats.ttirMs:void 0;s?t.sendNotification({notification:"one-player-play-state",playState:n,ttirMs:a}):t.sendNotification({notification:"one-player-play-state",playState:n})}),e.isPlayerReady.subscribe(function(n){c=0;var a=e.playerStats?e.playerStats.ttlMs:void 0;s?t.sendNotification({notification:"one-player-player-ready",isReady:n,ttlMs:a,pbsid:r}):t.sendNotification({notification:"one-player-player-ready",isReady:n}),n&&!i&&o(t,performance.now())}),e.playbackRate.subscribe(function(e){t.sendNotification({notification:"one-player-playback-rate",playbackRate:e})}),e.volume.subscribe(function(e){t.sendNotification({notification:"one-player-volume",volume:e})}),e.muted.subscribe(function(e){t.sendNotification({notification:"one-player-muted",isMuted:e})}),e.requestReconnect&&e.requestReconnect.subscribe(function(){t.sendNotification({notification:"one-player-reconnect-host"})},{ignoreCurrentValue:!0}),e.title.subscribe(function(e){t.sendNotification({notification:"one-player-title-updated",title:e})},{ignoreCurrentValue:!0}),n&&n.subscribe(function(e){t.sendNotification({notification:"one-player-fatal-playback-error",error:e.error,pbsid:e.playbackSessionId})})};function r(e,t){switch(t.command){case"one-player-pause":return e.playState.value="Paused",{};case"one-player-play":return e.playState.value="Playing",{};case"one-player-seek":var n=t.position;return!isNaN(n)&&n>=0&&(e.currentTimeInSeconds.value=n),{};case"one-player-stop":return e.playState.value="Paused",e.currentTimeInSeconds.value=0,{};case"one-player-mute":return e.muted.value=!0,{};case"one-player-unmute":return e.muted.value=!1,{};case"one-player-get-mute":return{isMute:e.muted.value};case"one-player-get-volume":return{volume:e.volume.value};case"one-player-set-volume":var a=t.volumeLevel;return!isNaN(a)&&a>=0?(e.volume.value=a,{volume:e.volume.value}):{result:"error",isExpected:!1,error:{code:"BadCommandOrData",message:"bad command or data"}};case"one-player-get-playback-rate":return{playbackRate:e.playbackRate.value};case"one-player-set-playback-rate":var i=t.playbackRate;return!isNaN(i)&&i>=0?(e.playbackRate.value=i,{playbackRate:e.playbackRate.value}):{result:"error",isExpected:!1,error:{code:"BadCommandOrData",message:"bad command or data"}};case"one-player-get-loop":return{isLoop:e.loop.value};case"one-player-set-loop":var r=t.isLoop;return e.loop.value=r,{isLoop:e.loop.value};case"one-player-get-duration":return{durationInSeconds:e.mediaDurationInSeconds};case"one-player-get-current-time":return{currentTimeInSeconds:e.currentTimeInSeconds.value};case"one-player-get-playback-state":return{playbackState:e.playState.value};case"one-player-get-playback-rates":return{playbackRates:e.playbackRates}}}function o(e,t){!a.t.isActivated("a5f51e2b-af39-46fb-9e2f-b1006b8b32ee","2023/06/05","Send OnePlayer first interactive timestamp to embed host")&&e.sendNotification({notification:"one-player-first-interactive",timestamp:t,timestampTimeOrigin:performance.timeOrigin})}},4388:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(6).t)("CrossWindowClient")},4700:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(830),i=n(154),r=n(25);function o(e,t,n){return!(e.type===i.t.OneNote||e.list||e.subsite||(n||!e.urls[a.e.downloadAsZip]||!e.urls[a.e.itemUrl]||0===e.childCount||e.type!==i.t.Folder)&&(e.isRootFolder||!t||t&&t.list&&t.list.templateType===r.n.webPageLibrary||e.type!==i.t.File&&e.type!==i.t.Media&&e.type!==i.t.Unknown))}},4723:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i});var a="mis",i="n/a"},4978:function(e,t,n){"use strict";n.r(t),n.d(t,"downloadDataSourceKey",function(){return f});var a=n(4984),i=n(53),r=n(949);function o(e){if(void 0!==e)return e}var s=n(698),c=n(160),d=n(277),l=n(45),u=function(){function e(e,t){this._common=new a.e(t.pageContext),this._dataRequestor=new t.dataRequestorType({}),this._itemUrlHelper=t.itemUrlHelper,this._identityDataSource=t.identityDataSource}return e.prototype.getDownloadUrl=function(e,t){return void 0===t&&(t={}),this._common.getDownloadUrl(o(e),o(void 0),t)},e.prototype.getItemClassicDownloadLink=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl+"?avcmd=1"},e.prototype.downloadItems=function(e){var t=this,n=e.items[0];return this.getDownloadRequestParameters(n,0).then(function(e){var n=t._initIframe(e.url);setTimeout(function(){window.document.body.removeChild(n)},2e4)})},e.prototype.getItemContents=function(e){var t=this;return this.getDownloadRequestParameters(e,2).then(function(e){var n=e.headers,a=n&&n.Authorization,i=a&&a.slice(7);return t._dataRequestor.getData({url:e.url,method:"GET",noRedirect:!0,qosName:"ItemDataSource.getItemContents",responseType:"blob",needsRequestDigest:!1,authToken:i})})},e.prototype.getDownloadRequestParameters=function(e,t,n){var a=this,i=this._itemUrlHelper.getItemUrlParts(e.key),r=new c.e(i.normalizedItemUrl);return i.isCrossDomain?this._identityDataSource.getSharePointToken(r.authority).then(function(n){var i=n.accessToken;return a.getDownloadUrl(e,{downloadType:t,authToken:i}).then(function(e){return{url:e,headers:{Authorization:"bearer ".concat(i)}}})}):this.getDownloadUrl(e,{downloadType:t}).then(function(e){return{url:e,withCredentials:!0}})},e.prototype._initIframe=function(e){var t=document.createElement("iframe");return t.src=e,t.style.display="none",window.document.body.appendChild(t),t},e}(),f=(t.default=u,Object(i.r)("DownloadDataSource",u,{dataRequestorType:r.n,pageContext:l.e,itemUrlHelper:s.s,identityDataSource:d.resourceKey}))},4984:function(e,t,n){"use strict";var a,i=n(0),r=n(1353),o=n(111);!function(e){e[e.download=0]="download",e[e.view=1]="view",e[e.load=2]="load",e[e.share=3]="share"}(a||(a={}));var s=a,c=n(182),d=n(129),l=n(497),u=n(213),f=n(204),p=n(3871),m=n(1209),_=n(4),h=function(e){function t(t){var n=e.call(this,{},{pageContext:t})||this;return n._itemUrlHelper=new c.e({},{pageContext:t}),n._apiUrlHelper=new l.e({},{pageContext:t,itemUrlHelper:n._itemUrlHelper}),n}return Object(i.__extends)(t,e),t.prototype.downloadItems=function(e){var t=e.items[0];return this.getDownloadUrl(t,null,{downloadType:s.download}).then(function(e){window.location.href=e})},t.prototype.getDownloadUrl=function(e,t,n){var a=this;void 0===n&&(n={});var i=n.downloadType,r=void 0===i?s.download:i,c=this._itemUrlHelper.getItemUrlParts(e.key);if(r===s.view)return o.n.resolve(Object(m.e)(c.fullItemUrl));if(r===s.share){var l;l=e.video?24:1;var h=this._apiUrlHelper.build().webByItemUrl(c);return Object(p.e)({dataRequestor:this.dataRequestor,webApiUrl:h,duration:l,serverRelativeItemUrl:c.serverRelativeItemUrl})}if(r===s.load)return c.isCrossDomain&&n.authToken?this.dataRequestor.getData({url:this._apiUrlHelper.contextInfoUrl(c.fullItemUrl),method:"POST",qosName:"GetContextInfo",authToken:n.authToken}).then(function(e){var t=e.d.GetContextWebInformation.WebFullUrl,n=new u.t({webAbsoluteUrl:t}).build().segment("web").methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:c.serverRelativeItemUrl}).segment("OpenBinaryStream");return o.n.resolve(n.toString())}):o.n.resolve(this.getBinaryStreamApiUrl(c).toString());var b=void 0;if(t||c.siteRelation===d.a.sameSite){var g;g=t?this._itemUrlHelper.getItemUrlParts(t.key).fullItemUrl:this._pageContext.webAbsoluteUrl,b=o.n.resolve(g)}else b=!_.t.isActivated("3dd660dc-b6bd-411f-ae14-1f8134830f62","03/08/2023","Add feature to allow adding auth to getDownloadUrl for download type: Download.download scenario")&&n&&n.authToken&&c.isCrossDomain?this.dataRequestor.getData({url:this._apiUrlHelper.contextInfoUrl(c.fullItemUrl),method:"POST",qosName:"GetContextInfo",authToken:n.authToken}).then(function(e){return e.d.GetContextWebInformation.WebFullUrl}):this.dataRequestor.getData({url:this._apiUrlHelper.contextInfoUrl(c.fullItemUrl),method:"POST",qosName:"GetContextInfo"}).then(function(e){return e.d.GetContextWebInformation.WebFullUrl});return b.then(function(e){return"".concat(e,"/").concat(a._pageContext.layoutsUrl,"/download.aspx?").concat(Object(f.e)({SourceUrl:c.serverRelativeItemUrl}))})},t.prototype.getBinaryStreamApiUrl=function(e){var t=this._apiUrlHelper.build().webByItemUrl(e);t=(t=t.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:e.serverRelativeItemUrl})).segment("OpenBinaryStream");var n=this._pageContext.authToken;return n&&(t=t.oDataParameter("access_token",n)),t},t}(r.t);t.e=h},5621:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return i}),function(e){e[e.None=0]="None",e[e.ExternalVideoSharing=1]="ExternalVideoSharing",e[e.PlaybackTranscriptTranslation=2]="PlaybackTranscriptTranslation",e[e.MediaAnalytics=4]="MediaAnalytics",e[e.HighResolutionPlayback=8]="HighResolutionPlayback"}(a||(a={}));var i=function(e){if(void 0!==e)return(e&a.ExternalVideoSharing)===a.ExternalVideoSharing}},5622:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return i}),function(e){e[e.None=0]="None",e[e.ExternalVideoSharing=1]="ExternalVideoSharing",e[e.PlaybackTranscriptTranslation=2]="PlaybackTranscriptTranslation",e[e.MediaAnalytics=4]="MediaAnalytics",e[e.HighResolutionPlayback=8]="HighResolutionPlayback"}(a||(a={}));var i="OnePlayer.lastWatchedPositionData"},6422:function(e,t,n){"use strict";n.r(t),n.d(t,"OnePlayerHost",function(){return K});var a=n(0),i=n(18),r=n(85),o=n(111),s=n(4),c=n(33),d=n(186),l=n(4307),u=n("react-lib"),f=n(120),p=n(52),m=n(31),_=n(84),h=n(2551),b=n(3684),g=n(2748),v=n(192),y=n(222);function S(e,t,i,r){return Object(a.__awaiter)(this,void 0,void 0,function(){var o,s,c,d,l;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,i.measureQos("PlayerEndQos",{name:"getOCPSCodeLazyLoaded"},function(){return n.ee([485],5171)})];case 1:return o=a.sent().default,[4,i.measureQos("PlayerEndQos",{name:"getOCPSAuthToken"},function(){return t("ocps")})];case 2:return s=a.sent(),c=new o(e,function(e){return Promise.resolve(s)}),[4,i.measureQos("PlayerEndQos",{name:"getOCPSData"},function(){return c.getPolicies()})];case 3:if(d=a.sent(),r)l=d&&d.value&&d.value.length>0&&d.value[0].policiesPayload?d.value[0].policiesPayload:[];else if(!(l=d&&d.value&&d.value.length>0&&d.value[0].policiesPayload?d.value[0].policiesPayload:void 0))throw new Error("Retrieved OCPS data is malformed");return[2,l]}})})}var D=n(4073),I=n(3327),x=n(105),C=(n(4299),n(4302)),O=n(181),w=n(145),E=n(4388),A=n(10),L=n(498),k=n(2921),M=n(3080),P=n(4309),T=n(4304),U=n(4301),F=function(e){var t=e.currentTimeInSeconds;if(t&&void 0!==t.value&&0!==t.value)return Math.round(100*t.value)/100;x.e.logError("Current time deep link is requested before the player is created",{eventName:"OnePlayerDeepLinkProviderFailure"})},H=function(e,t,n){return Object(a.__assign)(Object(a.__assign)({},(!n||!n.isReferralInfoDisabled)&&{referralInfo:{referralApp:e}}),n&&n.isCurrentTimeRequired&&{playbackOptions:{startTimeInSeconds:F(t)}})},R=n(92),N=n(3938),B=n(4306),j=n(4303),V=n(80),z=n(4308),G=n(5622),K=function(e){var t=Object(_.n)(),F=u.useRef(),K=u.useRef(),W=u.useRef(),q=u.useRef(),Q=u.useRef(),Y=u.useRef(function(e){}),J=t.consume(f.De),X=t.consume(f.D.optional),Z=t.consume(h.resourceKey.optional),$=t.consume(E.e.optional),ee=u.useMemo(function(){return"playLoaded"+w.e.generate()},[e.item.key]),te=u.useMemo(function(){return"thumbnailLoaded"+w.e.generate()},[e.item.key]),ne=u.useMemo(function(){return"thumbnailFailed"+w.e.generate()},[e.item.key]),ae=void 0,ie={},re=u.useState(e.defaultNavigationPanel),oe=re[0],se=re[1],ce=u.useState(void 0),de=ce[0],le=ce[1],ue=u.useState(void 0),fe=ue[0],pe=ue[1],me=u.useState(void 0),_e=me[0],he=me[1],be=u.useState(void 0),ge=be[0],ve=be[1],ye=u.useState(!0),Se=ye[0],De=ye[1],Ie=window.self!==window.top,xe=u.lazy(function(){return n.ee([641],5288)}),Ce=u.lazy(function(){return n.ee([659],7783)}),Oe=s.e.isActivated("17716019-6e47-4a91-971e-cb43401e8169","7/28/2022","Add referral telemetry data")?void 0:Object(D.i)(e.referrer,e.referrerScenario),we=!A.e.isActivated("3993ab2e-e8fd-477f-8991-8be390d727c7","1/4/2022","Disable Aria bugfix for deferred load scenario")&&!Object(m.isFeatureEnabled)(m.OnePlayerBugfixAriaDeferredLoadKillswitch),Ee=!A.e.isActivated("d1be88b6-e0d3-4ffc-954a-7ae5519fe826","07/15/2022","Disable consuming commentId from URL and opening the Comments panel by default"),Ae=!A.e.isActivated("709547ed-e830-4de0-90b8-e132dbf0475a","05/24/2023","Adds the new deferred load pre-roll"),Le=!A.e.isActivated("ea23f391-2861-48a8-b5ab-0ee14b6f99a4","11/24/2023","Adds the new deferred load pre-roll with branded pop out button"),ke=void 0;if(Ee){var Me=t.consume(r.e).viewParams;ke=Me?Me.commentId:void 0}var Pe,Te=!!e.deferLoading,Ue=u.useRef(function(e){Pe&&Pe(e)}),Fe=function(t,n,a){a.CorrelationId=n;var i={resultType:t,extraData:a};e.loadResult(i)};function He(e,t,n){void 0===n&&(n=!1);var a=Object(I.e)(e),i=Object(I.n)("OnePlayerHost."+e,t,void 0);return ie[e]=i.then(function(){return Object(I.t)(a,{result:"Success"},{name:e})}).catch(function(t){var i=t instanceof Error?t.message:void 0;return Object(I.t)(a,{result:"Fatal",isExpected:n,message:i},{name:e})}),i}var Re=e.isPlaylistPaneOpen,Ne=e.onNavigationPanelStateChanged,Be=e.isSmallScreen;u.useEffect(function(){Object(m.isFeatureEnabled)(m.PlaylistPreview)&&Ne&&!s.e.isActivated("5215ED5F-3707-4C3F-8018-EBC19C0582DF","05/30/2022","Enable playlist toggle command for mobile screens and zoomed in screens")&&Ne(ge,Be)},[ge]),u.useEffect(function(){Object(m.isFeatureEnabled)(m.PlaylistPreview)&&_e&&Re&&ge&&!s.e.isActivated("5215ED5F-3707-4C3F-8018-EBC19C0582DF","05/30/2022","Enable playlist toggle command for mobile screens and zoomed in screens")&&_e.ui.hideNavigationPanel()},[_e,Re]),u.useEffect(function(){var n=!0;Te&&He("TimeToInteractive",function(){return new Promise(function(e,t){Pe=function(n){n?t(new Error(n)):e()}})},!1);var r,u,_,h,b,E,M,H,V,re,oe=void 0,ce=void 0,de=void 0,ue=void 0,fe=void 0;ie.FetchTranscriptData=new Promise(function(e,t){E=e,M=t}).catch(function(e){return e}),ie.FetchTranscriptAndAudioFilesData=new Promise(function(e,t){H=e,V=t}).catch(function(e){return e});var me=function(){if(ue)return ue;var t="FetchTranscriptAndAudioFilesData",n=Object(I.e)(t),i={name:t};return ue=J.fetchTranscriptsAndAudioFiles(e.item).then(function(e){if(e)return H(Object(I.t)(n,{result:"Success"},Object(a.__assign)({},i))),e}).catch(function(e){if(s.e.isActivated("0d786424-9fc5-4d07-93ec-76128154bd05","3/07/2023","Add validation to getTranscriptsAudioFilesAndLogQos log"))r=Object(a.__assign)(Object(a.__assign)({},i),{backendCorrelationId:e.error.correlationId}),t={message:e.error.message||"",errorCode:e.error.code,isExpected:400===e.error.code||401===e.error.code||404===e.error.code||429===e.error.code||!!e.error.isExpected,result:"Fatal"},V(Object(I.t)(n,t,r));else{var t=void 0,r=Object(a.__assign)(Object(a.__assign)({},i),{backendCorrelationId:""});if(null==e?void 0:e.error)r.backendCorrelationId=e.error.correlationId,t={message:e.error.message||"Error message is empty",errorCode:e.error.code,isExpected:400===e.error.code||401===e.error.code||404===e.error.code||429===e.error.code||!!e.error.isExpected,result:e.error.code<=0?"Warning":"Fatal"};else{var o="object"==typeof e?JSON.stringify(e):e;t={message:"Unknown error for getTranscriptsAudioFilesAndLogQos OnePlayerHost, ".concat(o),isExpected:!1,result:"Fatal"}}V(Object(I.t)(n,t,r))}return{transcripts:[],audioTracks:[]}})},_e=function(){if(de)return de;var t="FetchTranscriptData",n=Object(I.e)(t),i={name:t};return de=J.fetchTranscripts(e.item).then(function(e){if(e)return E(Object(I.t)(n,{result:"Success"},Object(a.__assign)({},i))),e}).catch(function(e){if(s.e.isActivated("02542d99-ce17-4864-859e-482871d7e93b","3/07/2023","Add validation to getTranscriptsAndLogQoS log"))r=Object(a.__assign)(Object(a.__assign)({},i),{backendCorrelationId:e.error.correlationId}),t={message:e.error.message||"",errorCode:e.error.code,isExpected:400===e.error.code||401===e.error.code||404===e.error.code||429===e.error.code||!!e.error.isExpected,result:"Fatal"},M(Object(I.t)(n,t,r));else{var t=void 0,r=Object(a.__assign)(Object(a.__assign)({},i),{backendCorrelationId:""});if(null==e?void 0:e.error)r.backendCorrelationId=e.error.correlationId,t={message:e.error.message||"Error message is empty",errorCode:e.error.code,isExpected:400===e.error.code||401===e.error.code||404===e.error.code||429===e.error.code||!!e.error.isExpected,result:e.error.code<=0?"Warning":"Fatal"};else{var o="object"==typeof e?JSON.stringify(e):e;t={message:"Unknown error for getTranscriptsAndLogQoS OnePlayerHost. ".concat(o),isExpected:!1,result:"Fatal"}}M(Object(I.t)(n,t,r))}return[]})};function be(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return J.getDriveAccessTokenVroom2_1?[4,Object(I.n)("OnePlayerHost.GetVroomToken",J.getDriveAccessTokenVroom2_1.bind(J,e.item))]:[3,2];case 1:return[2,t.sent()];case 2:throw new Error("UseVroomV21 QSP is not enabled")}})})}function ge(t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,r,o,s,c,d,l,u,f;return Object(a.__generator)(this,function(a){switch(a.label){case 0:switch(t){case"ocps":return[3,1];case"Graph":return[3,5];case"InformationProtection":return[3,9];case"Loki":return[3,13];case"SharePointOnline":return[3,17];case"PushChannel":return[3,21];case"TeamsCMD":return[3,25];case"MeetingCatchup":return[3,29];case"Substrate":return[3,33];case"SubstrateTenantFeedback":return[3,37]}return[3,41];case 1:return X&&X.getOCPSToken?[4,Object(I.n)("OnePlayerHost.getOcpsToken",X.getOCPSToken.bind(X,{}))]:[3,3];case 2:return n=a.sent().accessToken,[3,4];case 3:n=Promise.reject("Unable to retrieve ocps token for the item"),a.label=4;case 4:return[2,n];case 5:return X&&X.getGraphToken?[4,Object(I.n)("OnePlayerHost.getGraphToken",X.getGraphToken.bind(X,{}))]:[3,7];case 6:return i=a.sent().accessToken,[3,8];case 7:i=Promise.reject("Unable to retrieve Graph token for the item"),a.label=8;case 8:return[2,i];case 9:return X&&X.getGraphToken?[4,Object(I.n)("OnePlayerHost.getGraphToken",X.getGraphToken.bind(X,{resource:"https://graph.microsoft.com",scopes:["InformationProtectionPolicy.Read"]}))]:[3,11];case 10:return r=a.sent().accessToken,[3,12];case 11:r=Promise.reject("Unable to retrieve Graph token for the item"),a.label=12;case 12:return[2,r];case 13:return X&&X.getLokiToken?[4,Object(I.n)("OnePlayerHost.getLokiToken",X.getLokiToken.bind(X))]:[3,15];case 14:return o=a.sent().accessToken,[3,16];case 15:o=Promise.reject("Unable to retrieve Loki token for the item"),a.label=16;case 16:return[2,o];case 17:return X&&X.getSharePointToken?[4,Object(I.n)("OnePlayerHost.getSharePointToken",X.getSharePointToken.bind(X,e.item.openUrl))]:[3,19];case 18:return s=a.sent().accessToken,[3,20];case 19:s=Promise.reject("Unable to retrieve SharePoint Online token for the item"),a.label=20;case 20:return[2,s];case 21:return X&&X.getPushChannelToken?[4,Object(I.n)("OnePlayerHost.getPushChannelToken",X.getPushChannelToken.bind(X))]:[3,23];case 22:return c=a.sent().accessToken,[3,24];case 23:c=Promise.reject("Unable to retrieve PushChannel token for the item"),a.label=24;case 24:return[2,c];case 25:return X&&X.getTeamsCMDToken?[4,Object(I.n)("OnePlayerHost.getTeamsCMDToken",X.getTeamsCMDToken.bind(X))]:[3,27];case 26:return d=a.sent().accessToken,[3,28];case 27:d=Promise.reject("Unable to retrieve Teams CMD token for the item"),a.label=28;case 28:return[2,d];case 29:return X&&X.getMeetingCatchupToken?[4,Object(I.n)("OnePlayerHost.getMeetingCatchupToken",X.getMeetingCatchupToken.bind(X))]:[3,31];case 30:return l=a.sent().accessToken,[3,32];case 31:l=Promise.reject("Unable to retrieve Meeting Catchup token"),a.label=32;case 32:return[2,l];case 33:return X&&X.getSubstrateToken?[4,Object(I.n)("OnePlayerHost.getSubstrateToken",X.getSubstrateToken.bind(X))]:[3,35];case 34:return u=a.sent().accessToken,[3,36];case 35:u=Promise.reject("Unable to retrieve Substrate token for the item"),a.label=36;case 36:return[2,u];case 37:return X&&X.getSubstrateTenantFeedbackToken?[4,Object(I.n)("OnePlayerHost.getSubstrateTenantFeedbackToken",X.getSubstrateTenantFeedbackToken.bind(X))]:[3,39];case 38:return f=a.sent().accessToken,[3,40];case 39:f=Promise.reject("Unable to retrieve Substrate Tenant Feedback token for the item"),a.label=40;case 40:return[2,f];case 41:throw new Error("Access Tokens are not implemented")}})})}function ye(){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return(s.e.isActivated("413b2694-abf1-49ed-866b-6a363f3fb66d","02/16/2022","Removing_VideoItemDataSource.getToken")||Object(m.isFeatureEnabled)(m.EnableOnePlayerVideoDataSourceVROOMTokenKillswitch))&&J.getToken?[4,J.getToken(e.item)]:[3,2];case 1:return[2,a.sent()];case 2:return(n=t.consume(f.y.optional))?n.refreshAccessToken?[4,n.refreshAccessToken(e.item,{apiVersion:"v2.0"})]:[3,4]:[3,5];case 3:a.sent(),a.label=4;case 4:if(i=n.getAccessToken(e.item,{apiVersion:"v2.0"}))return[2,o.n.resolve(i.accessToken)];a.label=5;case 5:return[2,Promise.reject("Unable to retrieve Vroom v2.0 token through Graph")]}})})}function Se(n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o;return Object(a.__generator)(this,function(a){return(r=e.item).properties.listId=n,r.properties.ID=i,ae||(ae=t.consume(f.ie.optional)),o=s.e.isActivated("f9386258-e5f4-442f-8aac-5d5e73a8d76f","10/28/2022","Using stream item url for chapter list share")?"embed":"stream",ae?[2,ae.getSharingInformation(r).then(function(e){return(null==e?void 0:e.webUrl)+"/_layouts/15/".concat(o,".aspx?UniqueId=").concat(e.itemUniqueId)})]:[2,void 0]})})}function Ie(r,o,f){var E,M,F,H,V,Y,X,ee,ae,de,ue,Ie,xe,Ce;return Object(a.__awaiter)(this,void 0,void 0,function(){var Le,Me,Pe,Ue,Re,Be,je,Ve,Ge,Ke,We,qe,Qe,Ye,Je,Xe,Ze,$e,et,tt,nt,at,it,rt,ot,st,ct,dt,lt,ut,ft,pt,mt,_t,ht,bt,gt,vt,yt,St,Dt,It,xt,Ct,Ot,wt,Et,At,Lt,kt,Mt,Pt,Tt,Ut,Ft,Ht,Rt,Nt,Bt,jt,Vt,zt,Gt,Kt,Wt=this;return Object(a.__generator)(this,function(qt){switch(qt.label){case 0:Le=t.consume(p.p),qt.label=1;case 1:return qt.trys.push([1,5,,6]),Me=Te?"TimeToInteractionResponse":"TimeToInteractive",Pe=Object(I.e)("OnePlayerStart"),(Gt={OnePlayerStart:Pe,TimeToLoad:Object(I.e)("TimeToLoad"),TimeToStableInteractive:Object(I.e)("TimeToStableInteractive")})[Me]=Object(I.e)(Me),Ue=Gt,s.e.isActivated("3b4be220-469c-42da-8bc2-0dc6ce96d3bc","07/15/2022","enable Fluent FCP telemetry")||(Ue.FirstContentfulPaint=Object(I.e)("FirstContentfulPaint")),!A.e.isActivated("248edbd9-4add-4747-8d67-d01f2fdffc23","02/28/2023","Disable the creation of Trusted Type policies")&&Object(g.registerOnePlayerBasicTrustedTypePolicies)(),Re="streamWebApp"===e.experience?He("LoadBundle",function(){return Object(g.loadStreamWebAppBundle)()},!1):He("LoadBundle",function(){return Object(g.loadOnePlayerBundle)()},!1),Be=Object(a.__awaiter)(void 0,void 0,void 0,function(){var t,n,i,r;return Object(a.__generator)(this,function(o){switch(o.label){case 0:return t="FetchMetadata",n=Object(I.e)(t),i=J.fetchVideoMetaData(e.item,Object(m.isFeatureEnabled)(m.EnableCTagFetch)),ie[t]=i.then(function(e){var i,r,o={name:t,backendName:"VROOM"};if(null==e?void 0:e.error){var s={message:d=e.error.message||"",errorCode:e.error.code},c=Object(a.__assign)(Object(a.__assign)({},o),{backendCorrelationId:e.error.correlationId});return(null===(i=e.error)||void 0===i?void 0:i.code)>0?(x.e.logError(d,{eventName:"OnePlayerHostVideoMetadataFailure",backendCorrelationId:(null===(r=null==e?void 0:e.error)||void 0===r?void 0:r.correlationId)||""}),Object(I.t)(n,Object(a.__assign)(Object(a.__assign)({},s),{result:"Fatal",isExpected:!1}),c)):(x.e.verbose(d,"OnePlayerHostVideoMetadataFailure"),Object(I.t)(n,Object(a.__assign)(Object(a.__assign)({},s),{result:"Warning",isExpected:!0}),c))}if(!(null==e?void 0:e.data)){var d=Object(D.r)("undefined video metadata value");return x.e.log(d,"OnePlayerHostVideoMetadataFailure"),Object(I.t)(n,{message:d,result:"Warning",isExpected:!1},o)}return Object(I.t)(n,{result:"Success"},Object(a.__assign)(Object(a.__assign)({},o),{backendRequestDuration:e.data&&e.data.spRequestDuration,isCdnHit:e.data&&e.data.isCdnHit}))}),[4,i];case 1:return(r=o.sent())&&!r.error&&r.data?[2,r.data]:(null==r?void 0:r.error)?[2,{errorCode:r.error.code}]:[2,void 0]}})}),je=new C.e(t,e.item,Be),Ve=!1,Ge=r.current,Ke="transparent",We=t.consume(O.e),qe=function(e){var t=Object(k.e)(m.OnePlayerFastNextGenEngineEnabled,90118,m.OnePlayerFastNextGenEngineGovEnabled,e),n=t[0];return t[1],n}(Le),Qe=function(e){var t=Object(k.e)(m.isGfileinfoTranscriptAndAudioEnabled,90199,m.isGfileinfoTranscriptAndAudioGovEnabled,e),n=t[0];return t[1],n}(Le),Ye=function(e){var t,n,a,i,r,o;return e&&void 0!==(null===(t=null===window||void 0===window?void 0:window.g_fileInfo)||void 0===t?void 0:t.hasTranscripts)&&void 0!==(null===(n=null===window||void 0===window?void 0:window.g_fileInfo)||void 0===n?void 0:n.hasAlternateAudioTracks)?(null===(a=null===window||void 0===window?void 0:window.g_fileInfo)||void 0===a?void 0:a.hasTranscripts)&&!(null===(i=null===window||void 0===window?void 0:window.g_fileInfo)||void 0===i?void 0:i.hasAlternateAudioTracks)?D.e.Transcripts:(null===(r=null===window||void 0===window?void 0:window.g_fileInfo)||void 0===r?void 0:r.hasTranscripts)||(null===(o=null===window||void 0===window?void 0:window.g_fileInfo)||void 0===o?void 0:o.hasAlternateAudioTracks)?D.e.TranscriptsAndAudioFiles:D.e.None:D.e.TranscriptsAndAudioFiles}(Qe),Je=!A.e.isActivated("0961e391-7114-450f-9fa1-ca647a04587b","10/23/2023","Disable use of last watched position as start time when creating sourceGenerator"),Xe=Je?function(e,t,n){var a,i=function(e,t){return"PowerPoint"===e||"Teams"===e&&"PowerPointLive"===t||"Teams"===e&&"cowatch"===(null==t?void 0:t.toLowerCase())}(e,t);if(n&&function(e){var t;try{t=window.localStorage;var n="__stream_bootstrap_storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(e){return!1}}()&&!i){var r=JSON.parse(window.localStorage.getItem(G.e)||"{}");return null!==r?null===(a=r[n])||void 0===a?void 0:a.lastWatchedPositionInSeconds:void 0}}(e.hostApp,e.hostView,null===(E=e.item.graph)||void 0===E?void 0:E.itemId):void 0,qe?(Ze=new U.e(t,{itemProvider:new T.e(Promise.resolve(e.item)),dataSource:J,playbackHelper:je,mediaType:e.mediaType,pageContext:Le,platformDetection:We,startTimeInSeconds:void 0!==(null===(M=e.playbackOptions)||void 0===M?void 0:M.startTimeInSeconds)?null===(F=e.playbackOptions)||void 0===F?void 0:F.startTimeInSeconds:void 0!==Xe?Xe:0}),(re=new g.OdspPlaybackSourceProvider(Ze)).getPlaybackSources()):(Ve=je.shouldFavorProgressive(e.mediaType),_=Promise.resolve(Ve),b=je.getPlaybackUrls(),h=Promise.all([b.dashUrlPromise,b.hlsUrlPromise,b.progressiveUrlPromise]).then(function(e){return{dashUrl:e[0],hlsUrl:e[1],progressiveUrl:e[2]}}),Ve&&(fe=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o;return Object(a.__generator)(this,function(s){return i="PrefetchProgressiveByHost",r=Object(I.e)(i),o=b.progressiveUrlPromise.then(function(a){return e.preloadOnePlayerNativeVideo(n,t,a)}).catch(function(e){x.e.log(e.message,"OnePlayerHostPrefetchProgressiveFailed")}),ie[i]=o.then(function(e){var t={name:i};return e?Object(I.t)(r,{result:"Success"},Object(a.__assign)({},t)):Object(I.t)(r,{result:"Warning"},Object(a.__assign)({},t))}),[2,o]})})}(je,Ge,Ke))),$e=function(e){var t=y.a.CanOverride,n=y.a.Overrides,a=v.t,i=y.a.isFeatureEnabled,r=window.location.search;if(e&&e.ExpFeatures&&e.experimentData&&e.experimentDataLookup&&e.serverTime&&e.cloudType){var o={ExpFeatures:e.ExpFeatures,experimentData:e.experimentData,experimentDataLookup:e.experimentDataLookup,serverTime:e.serverTime,CloudType:e.cloudType};return Promise.resolve(new g.FoRProvider("FoRProviderOnePlayer",t,n,o,a,i,r))}return Promise.resolve(void 0)}(Le),et=[Re,$e],tt=w.e.generate().toString(),nt={app:e.hostApp,view:e.hostView,version:e.hostVersion,integrationType:e.oneUpFlow,platform:"Web"},at=He("LoadEcsSettings",function(){var e;try{var t=function(e,t,n){var a,i,r,o=null===(a=e.OfficeMediaFlightingConfiguration)||void 0===a?void 0:a.Cloud,s={rolloutEnvironment:null!==(r=null===(i=e.OfficeMediaFlightingConfiguration)||void 0===i?void 0:i.ClientRolloutEnvironment)&&void 0!==r?r:"",cloud:o};return e.aadUserId&&(s.aadUserId=e.aadUserId),e.aadTenantId&&(s.aadTenantId=e.aadTenantId),s.flightSessionId=t,e.currentUICultureName&&(s.currentCultureName=e.currentUICultureName),s.hostName=n.app,n.view&&(s.hostView=n.view),n.integrationType&&(s.hostIntegrationType=n.integrationType),s}(Le,tt,nt);return Object(g.initializeEcsProvider)(null===(e=Le.OfficeMediaFlightingConfiguration)||void 0===e?void 0:e.ClientToServiceEndpoint,t,function(){return{isFlightEnabled:!1}})}catch(e){return Promise.resolve({})}}).catch(function(e){return{}}),et.push(at),le(je.getItemThumbnailUrl()),we&&pe(e.item.displayName),rt=void 0,ot=void 0,dt=function(t,n){return Object(j.e)(J,e,t,n)},qe?[3,3]:[4,Re];case 2:it=qt.sent(),!Ve&&b.dashUrlPromise&&(ct=je.prefetchManifest(it,b.dashUrlPromise,h,dt))&&ct.prefetchManifestPromise&&(lt=je.shouldUseProgIdForContentType()?"PrefetchManifestByHostLite":"PrefetchManifestByHost",ct.prefetchManifestPromise=He(lt,function(){return ct.prefetchManifestPromise},!1)),qt.label=3;case 3:return(ut=C.e.getABRLimit())&&(e.ampParams.maxStreamingResolutionLimit=ut),ft=!s.e.isActivated("aa18b1ba-52cf-495b-aec4-d0ab64e69767","11/22/2022","Open media settings when referral View is upload or create"),pt=void 0,pt=Ee&&ke?{pluginName:"Comment"}:!ft||"UPLOAD"!==(null===(H=null==Oe?void 0:Oe.referralView)||void 0===H?void 0:H.toUpperCase())&&"CREATE"!==(null===(V=null==Oe?void 0:Oe.referralView)||void 0===V?void 0:V.toUpperCase())?e.defaultNavigationPanel:{pluginName:"MediaSettingsLayer"},ze&&se(pt),mt=function(e,t,n){return void 0===n&&(n=!1),Object(a.__awaiter)(Wt,void 0,void 0,function(){var i,r,o=this;return Object(a.__generator)(this,function(c){return i=!s.e.isActivated("6afa1fa8-f475-4afc-b0e6-9251c08c50d1","05/05/2023","Disable fallback Auth for OCPS")&&n?function(e){return Object(a.__awaiter)(o,void 0,void 0,function(){return Object(a.__generator)(this,function(e){if(t)return[2,t().catch(function(e){throw e})];throw new Error("No getOnePlayerToken function provided with block host auth fallback")})})}:function(e){return Object(a.__awaiter)(o,void 0,void 0,function(){return Object(a.__generator)(this,function(n){return t?[2,t().catch(function(){return ge(e)})]:[2,ge(e)]})})},r=function(e,t,n){var i=this;return function(r){return Object(a.__awaiter)(i,void 0,void 0,function(){var i,o,c,d,l,u,f,p,m,_,h,b,g,v,y,D,I,x,C,O;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return n?[2,{enableFeedbackCollection:!1}]:[3,1];case 1:return i=!s.e.isActivated("0853a046-d5e5-4c52-9f35-8f637f32ddf6","7/13/2022","Control if using OCPS policy defaults is enabled"),o={},[4,S(e,t,r,i)];case 2:if(c=a.sent(),i)d=function(e,t){return c.find(function(n){return"common\\feedback"===n.key&&"Web"===n.platform&&n.settingId==="office16;"+e&&n.valueName===t})},l=null===(y=d("L_ConnectedOfficeExperiences","disconnectedstate"))||void 0===y?void 0:y.value,u=null===(D=d("L_SendFeedback","enabled"))||void 0===D?void 0:D.value,f=null===(I=d("L_SendSurvey","surveyenabled"))||void 0===I?void 0:I.value,p=null===(x=d("L_Screenshot","includescreenshot"))||void 0===x?void 0:x.value,m=null===(C=d("L_EmailCollection","includeemail"))||void 0===C?void 0:C.value,_=null===(O=d("L_LogCollection","feedbackincludelog"))||void 0===O?void 0:O.value,h=!l||"1"===l,o.enableConnectedOfficeExperiences=h,h?(o.enableFeedbackCollection=!u||"1"===u,o.enableSurveyCollection=!f||"1"===f,o.enableScreenshotCollection="1"===p,o.enableEmailCollection="1"===m,o.enableContentCollection="1"===_):(o.enableFeedbackCollection=!1,o.enableSurveyCollection=!1,o.enableScreenshotCollection=!1,o.enableEmailCollection=!1,o.enableContentCollection=!1);else for(b=0,g=c;b<g.length;b++)"common\\feedback"===(v=g[b]).key&&"Web"===v.platform&&("office16;L_SendFeedback"===v.settingId&&"enabled"===v.valueName&&(o.enableFeedbackCollection="1"===v.value),"office16;L_ConnectedOfficeExperiences"===v.settingId&&"disconnectedstate"===v.valueName&&(o.enableConnectedOfficeExperiences="1"===v.value),"office16;L_SendSurvey"===v.settingId&&"surveyenabled"===v.valueName&&(o.enableSurveyCollection="1"===v.value),"office16;L_Screenshot"===v.settingId&&"includescreenshot"===v.valueName&&(o.enableScreenshotCollection="1"===v.value),"office16;L_EmailCollection"===v.settingId&&"includeemail"===v.valueName&&(o.enableEmailCollection="1"===v.value),"office16;L_LogCollection"===v.settingId&&"feedbackincludelog"===v.valueName&&(o.enableContentCollection="1"===v.value));return[2,o]}})})}}(Le,i,Object(D.a)(Le)),[2,r(e)]})})},_t=function(t,n,a){if("TimeToLoad"!==n.name&&"TimeToStableInteractive"!==n.name||n.pluginName)"loadDataForPhaseAfterUi"===n.name&&st&&st.refreshEcsConfigsAndUpdateCache&&st.refreshEcsConfigsAndUpdateCache();else{var i;i="Success"===a.result?c.t.Success:a.isExpected?c.t.ExpectedFailure:c.t.Failure;var r={OnePlayerVersion:it.onePlayerVersion,name:n.name,hasSpentTimeInBackground:a.hasSpentTimeInBackground};Object(d.e)(r,n),Fe(i,e.hostCorrelationId,r);var o=function(t){var n=Object(k.e)(m.PlayerEngineProgressiveServiceWorker,90120,m.PlayerEngineProgressiveServiceWorker,t),a=n[0];return n[1],a&&("streamWebApp"===e.experience||"OneUpEmbedPage"===e.oneUpFlow)}(Le)||Object(z.e)(Le);o&&"TimeToStableInteractive"===n.name&&Object(z.n)()}},(ht=[]).push({onAppLogic:function(){},onWarning:function(){},onFatalError:function(){},onUserAction:function(t,n){"PlayerPlayPauseAction"!==t||"Play"!==n.name&&"Pause"!==n.name?"PlayerButtonAction"!==t||"FullScreen"!==n.name&&"ExitFullScreen"!==n.name||e.isFullscreen("FullScreen"===n.name):e.isPlaying("Play"===n.name)},onStartQos:function(){return""},onEndQos:_t,onCompletedQos:function(){}}),[4,Promise.all(et)];case 4:return Kt=qt.sent(),it=Kt[0],ot=Kt[1],st=Kt[2],bt=performance.now(),Object(m.isFeatureEnabled)(m.OnePlayerPrefetchFluentMtc)&&it.loadMtcManager&&"ODSPOnePlayerPlaylistHost"!==e.oneUpFlow&&(rt=it.loadMtcManager()),gt=e.getOnePlayerContext(Object(a.__assign)({item:e.item,integrationType:e.oneUpFlow,mediaType:e.mediaType,app:e.hostApp?e.hostApp:"",platform:e.hostPlatform,hostCorrelationId:e.hostCorrelationId,hostView:e.hostView,hostVersion:e.hostVersion,hostComponent:e.hostComponent,hostMode:null===(Y=e.hostMode)||void 0===Y?void 0:Y.toLowerCase(),hostSessionId:e.hostSessionId,extraTelemetry:e.extraTelemetry,playbackHelper:je,flightSessionId:tt,eTag:st.eTag,filters:st.filters,ring:st.ring,flightDataIsFromCache:st.fromCache},Oe)),e.theme&&gt.hostContext&&(gt.hostContext.theme=e.theme),vt=[],ot&&vt.push(ot),st.providers&&vt.push.apply(vt,st.providers),null!=e.overrideLanguage&&(gt.userContext.language=e.overrideLanguage),null!=e.loaderVersion&&(gt.hostContext.loaderVersion=e.loaderVersion),!s.e.isActivated("43b2b2c0-d4b0-4279-a0d5-ae192c127e5c","10/03/2023","add  oneplayer core version")&&gt&&(gt.onePlayerCoreVersion="1.0"),yt=void 0,void 0!==e.t0&&void 0!==performance.timeOrigin&&(St=e.t0.timeOrigin-performance.timeOrigin,Dt=e.t0.timestamp+St,It=Pe.startTime,e.tcs&&(xt=e.tcs.timeOrigin-performance.timeOrigin,It=e.tcs.timestamp+xt),Ct=performance.now(),yt={t0:Dt,createSession:It,settingsLoaded:bt,sessionStart:Pe.startTime,playClicked:f,playButtonLoaded:o,uniqueThumbnailLoadedMarkName:te,uniqueThumbnailFailedMarkName:ne,sessionLoaded:Ct,startLoadPlayer:Ct}),Ot=void 0,wt=void 0,s.e.isActivated("09734f43-57fe-4ac5-b033-1d9a6a979c9a","04/24/2023","Send fatal playback errors to iframe host")||(wt=new g.Observable,Ot=function(e,t){wt.notify({error:e,playbackSessionId:t})}),Et=void 0,A.e.isActivated("b66215b0-cae8-45ef-af60-9e333cf92a7e","06/10/2023","KillSwitch for reading firstInteractiveContentOffset from g_fileInfo")||(Et=null===(X=null===window||void 0===window?void 0:window.g_fileInfo)||void 0===X?void 0:X.firstInteractiveContentOffset),At=void 0,A.e.isActivated("c3a6ca55-2983-4f19-a99f-a388c1afdb8f","07/07/2023","KillSwitch for MigrationMessageBar")||(function(e){e.Embed="1",e.SWA="2"}((Lt=void 0)||(Lt={})),kt=function(e,t,n){var a,i;if(gt&&"ClassicStream"===(null===(a=gt.hostContext)||void 0===a?void 0:a.referralApp)&&(null===(i=gt.hostContext)||void 0===i?void 0:i.referralView)===t){var r=window.location.href;if(void 0!==r){var o=new URL(r);if(o.searchParams.get("scenario")===e){var s=new URLSearchParams(o.hash).get(n);At={migrationLink:s}}}}},kt(Lt.Embed,"ClassicEmbedMigration","#EmbedURL"),kt(Lt.SWA,"ClassicPortalMigration","#PortalURL")),Mt=Object(a.__assign)(Object(a.__assign)({},gt),{loadSummary:yt,migrationMessageBar:At,loadMode:Te?"deferredLoad":e.autoPlay?"autoplayOn":"autoplayOff",container:Ge,hostPluginUiOptions:ze?e.hostPluginUiOptions:void 0,isDevMode:!1,isEmbedHostTrusted:Object(l.t)(e.oneUpFlow),showMetadataOverlay:e.showMetadataOverlay,ampParams:e.ampParams,playbackOptions:e.playbackOptions,getPlaybackUrls:function(){return h||Promise.resolve({})},playbackSourceProvider:re,getClosedCaptionsUrl:function(){return function(e,t){var n;return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o,c,d,l,u,f,p,m;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,Promise.all([e,t])];case 1:if(i=a.sent(),r=i[0],!(o=i[1]))return[2,void 0];if(c=Object(D.n)(o)?o.transcripts:o,!1===(null===(n=null==r?void 0:r.media)||void 0===n?void 0:n.isTranscriptionShown))return[2,void 0];if(d=c.filter(function(e){return e.isVisible}),!d||d.length<=0)return[2,void 0];if(l=d.filter(function(e){return e.isDefault})[0],l||(l=d[0]),!l.temporaryDownloadUrl)return[2,void 0];if(u=[],s.e.isActivated("ee22223b-e541-4336-a8ea-fb2a8970e527","5/18/2022","ListofClosedCaptions"))m={url:l.temporaryDownloadUrl,languageTag:l.languageTag&&""!==l.languageTag?l.languageTag:void 0,source:!s.e.isActivated("4e81dc2f-e274-464d-9196-89017409c76c","5/12/2022","Add_ClosedCaptionsSource")&&l.source?l.source:void 0},u.push(m);else for(f=0;f<c.length;f++)(p=c[f])&&p.temporaryDownloadUrl&&u.push({url:p.temporaryDownloadUrl,languageTag:p.languageTag,source:!s.e.isActivated("4e81dc2f-e274-464d-9196-89017409c76c","5/12/2022","Add_ClosedCaptionsSource")&&p.source?p.source:void 0,isVisible:p.isVisible});return[2,u]}})})}(Be,Ye===D.e.TranscriptsAndAudioFiles?me():Ye===D.e.Transcripts?_e():void 0)},getDelayLoadedMetadata:function(){return Object(B.e)(Ee,t,Le,Be,it.stringToMediaVisibility)},getTranscriptData:Ye===D.e.Transcripts?_e:void 0,getTranscriptAndAudioFilesData:Ye===D.e.TranscriptsAndAudioFiles?me:void 0,isEnvInGovCloud:function(e){return Object(D.a)(Le,e)},getFavorProgressivePlayback:function(){return _},prefVideoTagPromise:fe,isDownloadBlocked:je.isDownloadBlocked(),getDownloadRequestParametersAsync:dt,themeData:e.themeData||{fluentTheme:Object(i.M)()},getAccessTokenVroom2_1:be,getAccessTokenVroom2_0:ye,getAccessToken:ge,startedPerfMarks:Ue,hostQosEventsToLog:ie,hostSettingsProviders:vt,getOCPSData:mt,telemetryCallbacks:ht,networkHealthCheckUrl:window.require.toUrl("").replace(/\/brotli\/$/,"/")+"odblightspeedwebpack.json",prefetchManifestResponse:ct,mtcManagerPromise:rt,playerBackgroundColor:Ke,isPrefetchProgressiveEnabled:Ve,returnVideoElementToHost:!s.e.isActivated("24ad972e-9428-4bab-bf2a-f9c08670d975","3/23/2022","enable video element to be accessible to host")&&!Object(m.isFeatureEnabled)(m.EnableOnePlayerReturnVideoElementToHostKillswitch)||void 0,navigationMenuDefaultOpenOverride:pt,getStreamItemUrl:Se,onFatalPlaybackError:Ot,firstInteractivityPointMs:Et,uiOptions:s.e.isActivated("64509190-e52e-4dcd-b2cb-fbc0c9298220","6/2/2023","Allow tabstop changes")?void 0:{enableVideoPlayerTabstopDuringPlayback:e.enableVideoPlayerTabstopDuringPlayback},externalFlights:e.externalFlights}),s.e.isActivated("3c15011d-2339-4a29-91d7-25e6bf9a47a6","9/8/2022","allow OnePlayer to use OneDS endpoint from page context")||(Mt.oneDsEndPointOverride=Le.oneDsCollectorUrl),Object(m.isFeatureEnabled)(m.OnePlayerOneDSEndpointOverrideGovClouds)&&(Pt=!A.e.isActivated("86df932c-b7c1-4f77-a7a1-03b1b41176bf","03/17/2023","Swtiching to use CloudType instead of env or env2"),Tt=Pt?Object(L.t)(Le.cloudType):Object(L.e)(Le),Object(L.c)(Tt)?Mt.oneDsEndPointOverride="https://tb.events.data.microsoft.com/OneCollector/1.0/":Object(L.s)(Tt)&&(Mt.oneDsEndPointOverride="https://pf.events.data.microsoft.com/OneCollector/1.0/")),Ut=void 0,Ft="public",s.e.isActivated("e562d0e1-cb2c-40ef-89c0-44cd06787bbe","07/11/2023","update aad config from page context")||(Ut=Le.aadInstanceUrl&&Le.aadTenantId?"".concat(Le.aadInstanceUrl,"/").concat(Le.aadTenantId):void 0,Ft=Le.cloudType&&["gcc","gcch","dod","ag08","ag09"].indexOf(Le.cloudType)>-1?Le.cloudType:"public"),Mt.aadAuthProviderHostOptions=s.e.isActivated("81205263-8b16-41f6-b751-47d51e785d95","10/21/2022","Specify host AAD information required if Token Refactoring is to be used.")?void 0:{cloud:Ft,aadAuthorityUrl:Ut,hostAadAppId:"08e18876-6177-487e-b8b5-cf950c1e598c",hostAadRedirectUrl:"".concat(window.location.origin,"/_forms/spfxsinglesignon.aspx"),loginNameHint:Le.userLoginName,loginDomainHint:Le.aadTenantId,hostAadSessionId:Le.aadSessionId},n?("streamWebApp"===e.experience&&K.current&&W.current&&(A.e.isActivated("fe0803e4-dd31-467d-9ba1-56222f2e7a9f","12/22/2022","Add messagebar container to SWA and fix shimmer shifting layout bug")||q.current)?(Ht=void 0,(Rt=t.consume(N.t))&&(Ht=t.consume(N.n),R.e.logData({name:Ht?"Stream.ViewMode":"Stream.EditMode"})),Nt=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},Mt),Rt&&void 0!==Ht&&{userInterfaceMode:Ht?"View":"Edit"}),{belowVideoContainer:K.current,navigationContainer:W.current}),!A.e.isActivated("fe0803e4-dd31-467d-9ba1-56222f2e7a9f","12/22/2022","Add messagebar container to SWA and fix shimmer shifting layout bug")&&{messageBarContainer:q.current}),oe=it.createStreamWebApp(Nt)):oe=it.createOnePlayer(Mt),he(oe),Z&&Z.subscribe(function(e){e&&oe&&oe.ui.hideNavigationPanel()}),Object(m.isFeatureEnabled)(m.OnePlayerEmbedCrossWindowSupport)&&$&&(Object(P.n)(oe.player,$,wt,Te,null==re?void 0:re.getPlaybackSessionId()),u=$.addCommandHandler(P.e.bind(void 0,oe.player)))):(jt={OnePlayerVersion:it.onePlayerVersion,name:"EarlyUnmount"},Fe(c.t.Success,e.hostCorrelationId,jt)),[3,6];case 5:return Bt=qt.sent(),jt={name:"UnknownError",message:Bt instanceof Error?Bt.message:void 0},Fe(c.t.Failure,e.hostCorrelationId,jt),[3,6];case 6:return oe?[4,oe.initialize()]:[3,8];case 7:qt.sent(),qt.label=8;case 8:return oe&&n?[4,oe.player.isPlayerReady.subscribe(function(){var e;null===(e=Q.current)||void 0===e||e.classList.add("player-ready"),Ae&&De(!1)})]:[3,11];case 9:return qt.sent(),[4,oe.renderVideo()];case 10:qt.sent(),"streamWebApp"===e.experience&&(Vt=oe.player.playState.value,zt=void 0,"Playing"===Vt?(zt=null===(ae=null===(ee=r.current)||void 0===ee?void 0:ee.querySelector(".playback-controls-container"))||void 0===ae?void 0:ae.querySelector("button"))||(zt=null===(de=r.current)||void 0===de?void 0:de.querySelector(".vjs-play-control")):"Paused"===Vt&&(s.e.isActivated("87cce69c-d78f-44be-a90a-4cf022532f78","04/11/2023","Focus on video container when reaching swa")?(zt=null===(xe=null===(Ie=r.current)||void 0===Ie?void 0:Ie.querySelector(".big-play-button"))||void 0===xe?void 0:xe.querySelector("button"))||(zt=null===(Ce=r.current)||void 0===Ce?void 0:Ce.querySelector(".vjs-big-play-button")):zt=null===(ue=r.current)||void 0===ue?void 0:ue.querySelector("video")),null==zt||zt.focus()),Object(m.isFeatureEnabled)(m.PlaylistPreview)&&Ne&&(ce=oe.ui.navigationPanelShown.subscribe(function(e){Object(m.isFeatureEnabled)(m.PlaylistPreview)&&!s.e.isActivated("5215ED5F-3707-4C3F-8018-EBC19C0582DF","05/30/2022","Enable playlist toggle command for mobile screens and zoomed in screens")?ve(e):Ne(e,!1)})),qt.label=11;case 11:return[2]}})})}if(Te){var xe=new C.e(t,e.item);le(xe.getItemThumbnailUrl()),we&&pe(e.item.displayName),r=new Promise(function(e,t){var n=!0;Y.current=function(a){var i;if(n){var r=void 0,o=void 0;A.e.isActivated("8add435d-04a9-4d14-b1fd-4934b0055bb8","02/15/2023","Add playClicked/prerollLoaded timestamp in embed deferredLoad case")||(r=performance.now(),o=null===(i=performance.getEntriesByName(ee)[0])||void 0===i?void 0:i.startTime),n=!1,a&&Pe&&Pe(a),Ie(F,o,r).then(e,t)}}})}else r=Ie(F);return function(){n=!1;try{null==u||u.dispose()}catch(t){var e=t instanceof Error?t.message:void 0;x.e.log(e,"OnePlayerHostUnloadHandlerDisposeFailure")}oe&&(oe.player.muted.value=!0),r.then(function(){Object(m.isFeatureEnabled)(m.PlaylistPreview)&&ce&&ce(),null==oe||oe.unload()}).catch(function(e){var t=e instanceof Error?e.message:void 0;x.e.log(t,"OnePlayerHostUnloadFailure")})}},[e.item.key,e.itemInstanceId]);var je=t.consume(M.t.optional);u.useEffect(function(){var t=null==_e?void 0:_e.player;if(t&&je){var n={getVideoDeepLink:H.bind(null,e.hostApp,t)};return je.set(n),function(){je.get()&&je.set(null)}}},[_e,je]);var Ve=t.consume(M.n.optional);u.useEffect(function(){var e=null==_e?void 0:_e.player;if(Ve&&e)return Ve.subscribe(function(){e.playState.value="Paused"})},[_e,Ve]);var ze=t.consume(N.e),Ge=u.useState(!1),Ke=Ge[0],We=Ge[1];if("streamWebApp"===e.experience){var qe=u.createElement("div",{className:"swa-main-area-container"},u.createElement("div",{className:"swa-video-stack"},u.createElement("div",{className:"oneplayer-root",ref:F,role:"region","aria-label":b.g}),u.createElement("div",{className:"swa-below-video-container",ref:K})),u.createElement("div",{className:"swa-navigation-container-open",ref:W})),Qe=qe;if(ze){var Ye=e.swaSidePanelComponent;Qe=u.createElement("div",{className:"swa-side-panel-container"},qe,Ye&&u.createElement(Ye,{playerContainer:F.current,belowRegionContainer:K.current,navigationContainer:W.current,playerApi:null==_e?void 0:_e.player,onOpenedChange:function(e){We(e)},defaultNavigationPanel:oe}))}return u.createElement("div",{className:Object(V.e)("StreamWebApp-container",{"swa-sidepanel-enabled":ze,"swa-side-panel-open":Ke})},u.createElement("div",{className:"swa-stack"},u.createElement("div",{className:"swa-messagebar-container",ref:q}),Qe))}var Je=we?"button":"div",Xe=we?{role:"button","aria-label":fe,onKeyPress:function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),Y.current("key pressed before thumbnail loaded"))}}:{},Ze=!A.e.isActivated("28f30cd0-101b-4d87-8420-e9aee11cccec","09/06/2022","Adds shadow and fixes size of the deferred play button"),$e=function(){var e,t,n;if($){var a=null===(e=performance.getEntriesByName(ee)[0])||void 0===e?void 0:e.startTime;if(!a)return;var i=null===(t=performance.getEntriesByName(te)[0])||void 0===t?void 0:t.startTime;if(i)return void Object(P.t)($,Math.max(a,i));(null===(n=performance.getEntriesByName(ne)[0])||void 0===n?void 0:n.startTime)&&Object(P.t)($,a)}},et=function(){performance.mark(te),$e(),Ue.current()},tt=function(){performance.mark(ne),$e(),Ue.current("thumbnail failed to load")},nt=function(){performance.mark(ee),$e()},at={thumbnailSrc:de,thumbnailLabel:fe,title:e.item.name,hostApp:e.hostApp,shouldShowTitle:e.showMetadataOverlay,isVisible:Se,loadPlayerByKeyPress:function(){return Y.current("key pressed before thumbnail loaded")},loadPlayerByClick:function(){return Y.current("clicked before thumbnail loaded")},playButtonLoaded:nt,thumbnailLoadSuccess:et,thumbnailLoadFailure:tt},it=Le?u.createElement(u.Suspense,{fallback:u.createElement(u.Fragment,null)},u.createElement(Ce,Object(a.__assign)({},at,{itemUrl:e.item.openUrl,referralContext:{referralApp:e.hostApp,referralView:e.hostView,referralAppPlatform:e.hostPlatform,referralMode:e.hostMode,referralPlaybackSessionId:null==Oe?void 0:Oe.referralPlaybackSessionId}}))):u.createElement(u.Suspense,{fallback:u.createElement(u.Fragment,null)},u.createElement(xe,Object(a.__assign)({},at)));return u.createElement("div",{className:"OnePlayer-container"},Te&&Ie&&Ae?it:de&&u.createElement(Je,Object(a.__assign)({className:"preloaded-thumbnail-poster",ref:Q,onClick:function(){return Y.current("clicked before thumbnail loaded")}},Xe),u.createElement("img",{className:"preloaded-thumbnail",src:de,onLoad:et,onError:function(e){tt(),e.currentTarget.style.display="none"}}),Te&&u.createElement("div",{className:Ze?"delay-play-button-v2":"delay-play-button"},u.createElement("img",{alt:b.b,src:window.require.toUrl("odsp-media/images/oneplayer/playbutton.svg"),onLoad:nt}))),u.createElement("div",{className:"video-player-container",ref:F}))}},7237:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return L});var a=n(0),i=n(4700),r=n(1354),o=n(111),s=n(25),c=n(204),d=n(53),l=n(50),u=n(120),f=n(52),p=n(357),m=n(2268),_=n(2659),h=n(277),b=n(1212),g=n(158),v=n(10),y=n(956),S=n(105),D=n(1358),I=n(231),x=n(1436),C=n(70),O=n(498),w=n(31),E=n(983),A=function(){function e(e,t){this.hmacAlreadyRequested=!1,this._urlDataSource=t.urlDataSource,this._itemUrlHelper=t.itemUrlHelper,this._itemParentHelper=t.itemParentHelper,this._pageContext=t.pageContext,this._urlCache=new Map,this._vroomDataRequestor=t.vroomDataRequestor,this._identityDataSource=t.identityDataSource,this._isOneDriveWinApp=Object(g.e)(),this._tokenFetcher=t.tokenFetcher}return e.prototype.getHmacHash=function(e,t){var n,a,i=this;if(this.hmacAlreadyRequested)return this.hmacPromise;this.hmacPromise=new o.n(function(e,t){n=e,a=t});var r="".concat(t.url,"?&access_token=").concat(t.access_token,"&provider=").concat(t.provider,"&docId=").concat(t.docId,"&apiUrlPath=").concat(t.apiUrlPath);return this.hmacAlreadyRequested=!0,y.e.start({url:r}).then(function(t){i.hmacAlreadyRequested=!1;var a=i.mapHmacParams(JSON.parse(t.response||{}));e.hmac={expiry:a.expiry,symmetricKey:a.symmetricKey,algoId:a.algoId,digest:a.digest},n(a)}).catch(function(e){i.hmacAlreadyRequested=!1,S.e.logError(e),a(e)}),this.hmacPromise},e.prototype.getDownloadUrl=function(e,t){var n=this;void 0===t&&(t={});var i=this._urlCache;if(!t.forceRefresh){var r=i.get(e.key)||{},s=r.url,c=r.time;if(!v.e.isActivated("8ED450B9-BA78-4BFE-93CB-1B095273B71F","11/01/2023","Enable download url cache")&&s&&c>Date.now()-27e5)return o.n.wrap(s)}var d,u=this.getItemUrl(e,t),f=this._itemUrlHelper.getItemUrlParts(e.key),p=f.isCrossDomain;if((this._isOneDriveWinApp||!v.e.isActivated("0f0d3a2a-33cd-4a8f-8892-42b79c97c964","08/23/2021","Fix Gallatin download token issue for shared file")&&Object(O.r)())&&(p||f.isCrossList))d=this._identityDataSource.getSharePointToken(new l.e(u).authority);else{var m=(t||{}).apiVersion,_=void 0===m?Object(w.isFeatureEnabled)(w.MediaTAUseVroomV21)?"v2.1":"v2.0":m;d=Object(w.isFeatureEnabled)(w.VideoTokenFromGraph)&&!Object(O.r)()?this.refreshAccessToken(e,Object(a.__assign)(Object(a.__assign)({},t),{apiVersion:_})).then(function(){return n.getAccessToken(e,t)}):o.n.resolve(this.getAccessToken(e))}var h="itemDownloadUrl";t.apiName&&(h="".concat(t.apiName,".").concat(h));var b=!p;return d.then(function(e){return n._vroomDataRequestor.send({apiName:h,path:"".concat(u,"?select=id,@content.downloadUrl"),accessToken:b?void 0:e,qosExtraData:t.qosExtraData,allowCookies:b})}).then(function(t){var n=t["@content.downloadUrl"].replace(/[?&]ApiVersion=[^&]+/,"");return i.set(e.key,{url:n,time:Date.now()}),n})},e.prototype.getDownloadUrlSync=function(e,t){void 0===t&&(t={});var n=Object(r.a)(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));if(i.e(Object(_.n)(e),Object(_.n)(n),!1)){var a=this.getItemUrl(e,t),o=this._getAuthenticationParamsSync(e,t),s=Object(c.e)(o);return a&&"".concat(a,"/content?").concat(s)}},e.prototype.getAuthenticationParams=function(e,t){var n=this,i=(t||{}).apiVersion,r=void 0===i?Object(w.isFeatureEnabled)(w.MediaTAUseVroomV21)?"v2.1":"v2.0":i;return Object(w.isFeatureEnabled)(w.VideoTokenFromGraph)&&!Object(O.r)()?this.refreshAccessToken(e,Object(a.__assign)(Object(a.__assign)({},t),{apiVersion:r})).then(function(){return n._getAuthenticationParamsSync(e,t)}):o.n.resolve(this._getAuthenticationParamsSync(e,t))},e.prototype.getDriveUrl=function(e,t){void 0===t&&(t={});var n=t.useDirectEndpoint,a=void 0===n?!this._pageContext.isSPO:n,i=t.apiVersion,r=void 0===i?"v2.0":i,o=t.allowCookies,s=this._getGraphBaseUrl(e,{useDirectEndpoint:a,apiVersion:r,allowCookies:o}),c=e.graph;if(c)return"".concat(s,"/drives/").concat(encodeURIComponent(c.driveId));var d=this._getDriveUrl(e,s);if(!d)throw new Error("Unable to determine graph identity for item");return d},e.prototype.getItemUrl=function(e,t){var n,a;void 0===t&&(t={});var i=t.useDirectEndpoint,o=void 0===i?!this._pageContext.isSPO:i,c=t.isPath,d=void 0!==c&&c,l=t.apiVersion,u=void 0===l?"v2.0":l,f=t.allowCookies,p=void 0!==f&&f,m=this._getGraphBaseUrl(e,{useDirectEndpoint:o,apiVersion:u,allowCookies:p}),_=e.graph,h=e.remoteItem,b=Object(r.a)(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),g=(null===(n=null==b?void 0:b.list)||void 0===n?void 0:n.templateType)===s.n.genericList;if(h){var y=h.DriveId,S=void 0===y?"me":y,D=h.ItemId,I=void 0===D?"root":D;return"".concat(m,"/drives/").concat(encodeURIComponent(S)).concat("root"===I?"/root":"/items/".concat(encodeURIComponent(I))).concat(d?":":"")}if(_&&_.driveId&&"root"!==_.itemId&&!g){var x=_.driveId,C=(S=void 0===x?"me":x,_.itemId);return I=void 0===C?"root":C,"".concat(m,"/drives/").concat(encodeURIComponent(S)).concat("root"===I?"/root":"/items/".concat(encodeURIComponent(I))).concat(d?":":"")}var O=g&&!v.e.isActivated("8ED612A4-8843-462D-859B-E86CDCD37E4E","6/02/2021","Fix graph url for custom lists")?this._getListUrl(b,m):this._getDriveUrl(e,m);if(O){if(g)return e===b?O:"".concat(O,"/items/").concat(null===(a=e.properties)||void 0===a?void 0:a.ID);var w=b.list.listUrlDir,E=this._itemUrlHelper.getItemUrlParts(e.key),A=(w?this._itemUrlHelper.getUrlParts({path:E.serverRelativeItemUrl,listUrl:w}):E).listRelativeItemUrl;return"".concat(O,"/root").concat(A?":/".concat(encodeURI(A)).concat(d?"":":"):"".concat(d?":":""))}},e.prototype.getAccessToken=function(e,t){if(void 0===t&&(t={}),!this._pageContext.isSPO||e.remoteItem)return{};var n=t.apiVersion,a=Object(r.a)(this._itemParentHelper.getAncestorOrSelf(e,function(e){var t=e.graph;return!!t&&!!t.sessionToken}));return"v2.1"===n?a&&a.graph.sessionTokenV21:a&&a.graph.sessionToken},e.prototype.refreshAccessToken=function(e,t){var n=this;void 0===t&&(t={});var a=t.apiVersion,i=t.forceRefresh,r=void 0!==i&&i;if(Object(w.isFeatureEnabled)(w.VideoTokenFromGraph)&&a&&!Object(O.r)()){var s=this.getAccessToken(e,{apiVersion:a});if(s){var c=s.accessToken,d=s.proofToken,u=s.tokenExpiry,f=Object(w.isFeatureEnabled)(w.VideoMoreAgressiveTokenRefresh)?3e5:6e4;if(!r&&!Object(x.e)(Object(D.default)({authToken:c},{proofToken:D.optional(d),expiry:D.optional(u?new Date(u):void 0)}),f))return o.n.resolve(s)}return this._tokenFetcher.getAuthToken(e.key).then(function(e){var t=e.data,i=t[".driveAccessToken"],r=t[".driveAccessTokenV21"],s=t[".driveUrl"],c=t[".driveUrlV21"];return s&&i&&"v2.0"===a?o.n.resolve({accessToken:n._extractToken(i),tokenUrl:s}):c&&r&&"v2.1"===a?o.n.resolve({accessToken:n._extractToken(r),tokenUrl:c}):o.n.reject(new C.e({code:"NoAuth",isExpected:!1,message:"Cannot find drive access token"}))})}var p=this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl;return this._identityDataSource.getSharePointToken(new l.e(p).authority)},e.prototype._extractToken=function(e){if(e.indexOf("=")<0)return e;var t=Object(I.e)(e);return t&&t.access_token},e.prototype._getAuthenticationParamsSync=function(e,t){var n=this.getAccessToken(e,t);if(n){var a=n.accessToken,i=n.proofToken,r={};return a&&(r.access_token=a),i&&(r.prooftoken=i),r}return{}},e.prototype._getGraphBaseUrl=function(e,t){var n=t.useDirectEndpoint,a=t.apiVersion,i=t.allowCookies,o=Object(r.a)(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),s=this._itemUrlHelper.getItemUrlParts(e.key);if(n){if(o){var c=this._itemUrlHelper.getItemUrlParts(o.key).fullItemUrl;if(i&&!s.isCrossDomain){var d=Object(r.a)(this._itemParentHelper.getFacetedAncestorOrSelf(o,"subsite"));if(d&&d.subsite){var u;return u=d&&d.subsite.serverRelativeUrl!==this._pageContext.webAbsoluteUrl?d.subsite.serverRelativeUrl:this._pageContext.webAbsoluteUrl,"".concat(u,"/_api/").concat(a)}}return"".concat(new l.e(c).authority,"/_api/").concat(a)}return s.isCrossDomain||s.isCrossList?(c=this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl,"".concat(new l.e(c).authority,"/_api/").concat(a)):this._urlDataSource.getApiBaseUrl({apiVersion:a})}return"https://graph.microsoft.com/v1.0"},e.prototype.mapHmacParams=function(e){return void 0===e&&(e={}),{expiry:e.p1||"",symmetricKey:e.p2||"",algoId:e.p3||"",digest:e.p4||""}},e.prototype._getDriveUrl=function(e,t){var n=Object(r.a)(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));if(n){var a=n.graph,i=a&&a.driveId;return i?"".concat(t,"/drives/").concat(encodeURIComponent(i)):this._getListUrl(n,t)}},e.prototype._getListUrl=function(e,t){var n;if(e){var a=Object(r.a)(this._itemParentHelper.getFacetedAncestorOrSelf(e,"subsite")),i=void 0,o=void 0,c=void 0;if(a&&a.subsite.serverRelativeUrl!==this._pageContext.webAbsoluteUrl){var d=a.subsite;i=d.siteCollectionId,o=d.id,c=d.serverRelativeUrl}else{var u=this._pageContext;i=u.siteId,o=u.webId,c=u.webAbsoluteUrl}var f=new l.e(c).domain,p=e.list.id||e.displayName;if(!p)return;return(null===(n=e.list)||void 0===n?void 0:n.templateType)===s.n.genericList?"".concat(t,"/sites/").concat(f,",").concat(i,",").concat(o,"/lists/").concat(p).replace(/[{}]/g,""):t.slice(0,this._pageContext.webAbsoluteUrl.length)===this._pageContext.webAbsoluteUrl?"".concat(t,"/sites/root/lists/").concat(p,"/drive"):"".concat(t,"/sites/").concat(f,",").concat(i,",").concat(o,"/lists/").concat(p,"/drive").replace(/[{}]/g,"")}},e.dependencies={urlDataSource:u.he,itemUrlHelper:p.s,itemParentHelper:m.e,pageContext:f.p,vroomDataRequestor:b.e,identityDataSource:h.resourceKey,tokenFetcher:E.e},e}();t.default=A;var L=Object(d.r)("GraphDataSource",A)},7689:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return P});var a=n(0),i=n(111),r=n(53),o=n(830),s=n(699),c=n(183),d=n(51),l=n(956),u=n(33),f=n(10),p=n(498),m=n(1358),_="request-id",h="sprequestduration",b="spiislatency",g=n(31),v=n(2976),y=n(120),S=n(52),D=n(357),I=n(983),x=n(70),C=n(231),O=n(160),w=n(105),E=n(78),A=n(1402),L=function(){function e(e,t){this._downloadDataSource=t.downloadDataSource,this._graphDataSource=t.graphDataSource,this._itemUrlHelper=t.itemUrlHelper,this._pageContext=t.pageContext,this._tokenFetcher=t.tokenFetcher,this._cached=null,this._vroomDataRequestor=t.vroomDataRequestor}return e.prototype.isStreamingSupported=function(e){return!!(e&&e.urls&&e.urls[o.t.video])},e.prototype.isMetaAvailable=function(e){return!(!e||!e.urls||!e.urls[o.t.mediaBaseUrl]&&!e.urls[o.t.video])},e.prototype.isDownloadBlocked=function(e){return e.itemStatus===c.t.ConditionalAccessViewOnly||!d.e.hasItemPermission(e,d.e.openItems)},e.prototype.isHlsPlaybackSupported=function(){return Object(g.isFeatureEnabled)(g.EnableHlsPretranscode)},e.prototype.createDriveItem=function(e,t,n,i,r){var o,s;return Object(a.__awaiter)(this,void 0,void 0,function(){var c,d,l;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(!e||!n)throw new Error("Invalid parent item or folder key");return c=null===(o=e.graph)||void 0===o?void 0:o.driveId,d=null===(s=e.name)||void 0===s?void 0:s.replace(e.extension,i),l=r+"/drives/"+encodeURIComponent(c||"")+"/items/"+encodeURIComponent(t)+":/"+encodeURIComponent(d||"")+":/content",[4,this._vroomDataRequestor.send({apiName:"content",path:l,requestType:"PUT"}).then(function(e){return e})];case 1:return[2,a.sent()]}})})},e.prototype.getSpecialFolderItem=function(e,t,n){var i,r;return Object(a.__awaiter)(this,void 0,void 0,function(){var o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(!(null===(i=n.graph)||void 0===i?void 0:i.driveId))throw new Error("Unexpected Error: DriveId is not available");if(!n.key)throw new Error("Unexpected Error: ItemKey is not available");return o=null===(r=n.graph)||void 0===r?void 0:r.driveId,s=t+"/drives/"+o+"/special/"+e,[4,this._vroomDataRequestor.send({apiName:"special",path:s,requestType:"GET"}).then(function(e){return e})];case 1:return[2,a.sent()]}})})},e.prototype.getDownloadUrl=function(e){var t=e.item,n=e.playbackType,a=e.preferEncryption,r=e.enhanceAudio,s=e.forcedCdnParam,c=e.forcedHybridPlayback,d=n===v.n.htmlMp4||n===v.n.htmlFallback;if(this.isStreamingSupported(t)&&!d){var l=t.urls[o.t.video],u=this._getFormat(n);if(l&&u)return l+="&part=index&format=".concat(u,"&useScf=True"),!e.useBetaTranscode||n!==v.n.htmlDashling&&n!==v.n.htmlDashlingFFMPEGFallback&&n!==v.n.flashDash&&n!==v.n.htmlHlsV6&&n!==v.n.htmlHlsV6FFMPEGFallback?l+="&manifestMetadata="+(t.video&&t.video.manifestMetadata||""):(l+="&altTranscode=1",l+="&altManifestMetadata="+(t.video&&t.video.altManifestMetadata||"")),!r||n!==v.n.htmlDashling&&n!==v.n.htmlHlsV6||(l+="&enhanceAudio=true"),n===v.n.htmlDashling||n===v.n.htmlDashlingMediaFoundationFallback||n===v.n.htmlDashlingFFMPEGFallback?(l+="&pretranscode=0&transcodeahead=0",a&&((Object(g.isFeatureEnabled)(g.VideoUseCdn)||"1"===s)&&(l+="&enableCdn=1",c&&(l+="&hybridPlayback=true")),Object(g.isFeatureEnabled)(g.VideoEnableEncryption)&&(l+="&enableEncryption=1"))):n===v.n.flashDash&&(l+="&pretranscode=0",l+="&.ism/manifest(format=mpd-time-csf)"),"hls-vnext"===u&&a&&(Object(g.isFeatureEnabled)(g.VideoUseCdnForHls)&&(l+="&enableCdn=1",c&&(l+="&hybridPlayback=true")),Object(g.isFeatureEnabled)(g.VideoEnableEncryptionForHls)&&(l+="&enableEncryption=1")),i.n.resolve(l)}var m=this._pageContext,_=m.authToken,h=m.isSPO;if(void 0!==h&&!h)return i.n.resolve(t.openUrl);var b=this._itemUrlHelper.getItemUrlParts(t.key),y=Object(g.isFeatureEnabled)(g.ForceProgressivePlaybackOnDownloadAspx)?0:1;if(f.e.isActivated("e8db12af-459c-49cf-9446-d363211f60ee","01/15/2021","For Gallatin clusters use direct download url without vroom call")){if(!b.isCrossDomain&&!_&&d)return this._downloadDataSource.getDownloadUrl(t,{downloadType:y})}else if(Object(p.r)()||!b.isCrossDomain&&!_&&d)return this._downloadDataSource.getDownloadUrl(t,{downloadType:y});return this._graphDataSource.getDownloadUrl(t,{useDirectEndpoint:!0})},e.prototype.fetchVTTCaptions=function(e){return Object(a.__awaiter)(this,void 0,i.n,function(){var t,n,i,r,s,c,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:t=new u.e({name:"Video.FetchVTTFile"}),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,this.getCaptionsSrcUrl(e)];case 2:return(n=a.sent())?[4,l.e.start({url:n,method:"GET"})]:[3,4];case 3:return r=a.sent(),t.end({resultType:u.t.Success}),[2,{data:r.responseText}];case 4:return[3,6];case 5:if(i=a.sent(),r=void 0,s=void 0,f.e.isActivated("a1dadaf4-a088-4937-baf5-76fa11a3a288","11/22/2021","Update fetchVTTFile logging"))r=JSON.parse(i.responseText),s=r.error?r.error.message:"";else{try{r=JSON.parse(i.responseText)}catch(e){}s=r&&r.error?r.error.message:"Cannot parse error message"}return c=e.urls?e.urls[o.t.mediaBaseUrl]:"",d=i,t.end({resultType:u.t.Failure,error:s,extraData:{httpStatusCode:d&&d.status,metaBaseUrl:c}}),[2,{error:{code:d&&d.status,message:s,correlationId:d.getResponseHeader&&"function"==typeof d.getResponseHeader?i.getResponseHeader("x-correlationid"):""}}];case 6:return[2]}})})},e.prototype.getCaptionsSrcUrl=function(e){return Object(a.__awaiter)(this,void 0,i.n,function(){var t,n,i,r,s,c,d,l;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e.urls?(t=e.urls[o.t.mediaBaseUrl],n=e.urls[o.t.itemUrl],i=this.getParameterByName("provider",e.urls[o.t.video]),t&&n?(r="".concat(t,"/transform/transcript?provider=").concat(i),s=encodeURIComponent(n),c=this.getParameterByName("cs",e.urls[o.t.video]),[4,this.getDriveAccessToken(e)]):[3,2]):[3,2];case 1:return d=a.sent(),l="".concat(r,"&docid=").concat(s,"&access_token=").concat(d),c&&(l+="&cs=".concat(c)),[2,l];case 2:return[2,void 0]}})})},e.prototype.fetchVideoMetaData=function(e,t){return void 0===t&&(t=!1),Object(a.__awaiter)(this,void 0,i.n,function(){var n,i,r,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(n=new u.e({name:"Video.FetchMetaData"}),!this.isMetaAvailable(e)&&!f.e.isActivated("3997c29a-38f4-487d-b8ef-fc69f7540598","02/05/2021","Disables MeTA availability check when fetching video metadata"))return[2,{error:{code:0,message:"Metadata not available in current environment.",correlationId:""}}];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._makeVideoMetadataCallWithFetch(e,t)];case 2:return i=a.sent(),n.end({resultType:u.t.Success}),[2,{data:i}];case 3:return r=a.sent(),o=r,n.end({resultType:u.t.Failure,error:o&&o.statusText,extraData:{httpStatusCode:o&&o.status}}),[2,{error:{code:o&&o.status,message:o&&o.statusText,correlationId:o&&o.getResponseHeader&&"function"==typeof o.getResponseHeader&&o.getResponseHeader(_)||""}}];case 4:return[2]}})})},e.prototype.fetchTranscripts=function(e){return this._fetchMediaTranscripts(e)},e.prototype.fetchTranscriptsAndAudioFiles=function(e){return this._fetchMediaTranscriptsAndAudioFiles(e)},e.prototype.getRequestParametersAsync=function(e,t,n,a,r){var o=this;if(void 0===n&&(n=!0),void 0===a&&(a=!1),void 0===r&&(r=!1),!t||"https://"!==t.slice(0,8))return i.n.resolve({url:t});var s=this.getParameterByName("p1",t);a&&(t=t.concat("&enhanceAudio=true"));var c=f.e.isActivated("5378e20f-3228-466c-b2cc-efd34529ad62","06/12/2022","Fix regular expression issue for video url");if(n&&null!==s&&this.isHmacExpired(s)){var d,l;t=c?t.replace(/(?:&|%3F|%26|%3f)(?:access_token|tempauth|p1|p2|p3|p4)(?:=|%3d|%3D)[^&]+/g,"").replace(/(?:access_token|tempauth|p1|p2|p3|p4)(?:=|%3d|%3D)[^&]+(?:&|%26|$)/g,"").replace(/(?:\?|%3F|%3f)$/g,""):t.replace(/(?:access_token|tempauth)(?:%3d|%3D)[^&%]+(?:%26|$)?(&)?/g,"$1").replace(/(?:access_token|tempauth)(?:=)[^&]+(?:&|$)/g,"").replace(/(?:p1|p2|p3|p4)(?:=)[^&]+(?:&|$)/g,"").replace(/(?:%3F|%3f|%26)(&|$)/g,"$1").replace(/(?:\?|&)$/g,"");var u=new i.n(function(e,t){d=e,l=t});return this.getDriveAccessToken(e,!0).then(function(n){o._getItemHMAC(e,t,n).then(function(e){var a="".concat(t).concat(c||-1!==t.indexOf("?")?"&":"?","access_token=").concat(n,"&p1=").concat(e.expiry,"&p2=").concat(e.symmetricKey,"&p3=").concat(e.algoId,"&p4=").concat(e.digest);d({url:a})}).catch(function(e){w.e.logError(e),l(e)})}),u}return t=c?t.replace(/(?:&|%3F|%26|%3f)(?:access_token|tempauth)(?:=|%3d|%3D)[^&]+/g,"").replace(/(?:access_token|tempauth)(?:=|%3d|%3D)[^&]+(?:&|%26|$)/g,"").replace(/(?:\?|%3F|%3f)$/g,""):t.replace(/(?:access_token|tempauth)(?:%3d|%3D)[^&%]+(?:%26|$)?(&)?/g,"$1").replace(/(?:access_token|tempauth)(?:=)[^&]+(?:&|$)/g,"").replace(/(?:%3F|%3f|%26)(&|$)/g,"$1").replace(/(?:\?|&)$/g,""),this.getDriveAccessToken(e,r).then(function(e){return{url:"".concat(t).concat(c||-1!==t.indexOf("?")?"&":"?","access_token=").concat(e)}})},e.prototype.getDriveAccessTokenVroom2_1=function(e){return Object(a.__awaiter)(this,void 0,i.n,function(){var t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return Object(g.isFeatureEnabled)(g.VideoTokenFromGraph)?[2,this.getDriveAccessToken(e,!1,"v2.1")]:[3,1];case 1:return[4,this._graphDataSource.getAccessToken(e,{apiVersion:"v2.1"})];case 2:if(t=n.sent())return[2,t.accessToken];throw new Error("Undefined access token")}})})},e.prototype.getToken=function(e,t){var n=this;if(Object(g.isFeatureEnabled)(g.VideoForcedTokenRefresh)){var a=this._cached,r=this._graphDataSource,o={apiVersion:Object(g.isFeatureEnabled)(g.MediaTAUseVroomV21)?"v2.1":"v2.0",useDirectEndpoint:!0},c=M(r.getDriveUrl(e,o));if(!t&&a&&a.driveUrl===c&&a.expiry>Date.now())return i.n.resolve(a.token);var d=function(e){if(e){var t=e&&Object(s.a)(e),a=Date.now(),r=Object(g.isFeatureEnabled)(g.VideoMoreAgressiveTokenRefresh)?300:60,o=t&&1e3*(Number(t.exp)-r);if(o&&o>a){var d={expiry:o,token:e,driveUrl:c};return n._cached=d,i.n.resolve(e)}}};if(!t){var l=r.getAccessToken(e,o),u=l&&l.accessToken,f=d(u);if(f)return f}return this._tokenFetcher.getAuthToken(e.key).then(function(e){var t,n=e.data,a=n[".driveAccessToken"],i=n[".driveAccessTokenV21"],r=n[".driveUrl"],o=n[".driveUrlV21"];return r&&a&&c.indexOf(M(r))>=0?t=d(k(a)):o&&i&&c.indexOf(M(o))>=0&&(t=d(k(i))),t||Promise.reject(new x.e({code:"NoAuth",isExpected:!1,message:"Cannot find auth token"}))})}return this._getCachedToken(e)},e.prototype.getDriveAccessToken=function(e,t,n){return void 0===t&&(t=!1),Object(a.__awaiter)(this,void 0,i.n,function(){var r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return Object(g.isFeatureEnabled)(g.VideoTokenFromGraph)?(r=m.optional(Object(p.r)()?void 0:n||(Object(g.isFeatureEnabled)(g.MediaTAUseVroomV21)?"v2.1":"v2.0")),this._graphDataSource.refreshAccessToken?[4,this._graphDataSource.refreshAccessToken(e,Object(m.default)({forceRefresh:t},{apiVersion:r}))]:[3,2]):[3,3];case 1:if(o=a.sent())return[2,i.n.resolve(o.accessToken)];a.label=2;case 2:return(s=this._graphDataSource.getAccessToken(e,Object(m.default)({},{apiVersion:r})))?[2,i.n.resolve(s.accessToken)]:[2,i.n.reject(new x.e({code:"NoAuth",isExpected:!1,message:"Cannot find auth token"}))];case 3:return[2,this.getToken(e,t)]}})})},e.prototype._fetchMediaTranscripts=function(e){var t,n,r;return Object(a.__awaiter)(this,void 0,i.n,function(){var i,s,c,d,f,p,m,g,v,y,S,D,I,x,C;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(i=new u.e({name:"Video.FetchMediaTranscripts"}),s="",c=null,d=null,f=null,!e||!e.urls||!e.urls[o.t.itemUrl])return C="Item URLs not available in current environment.",i.end({resultType:u.t.ExpectedFailure,error:C}),[2,this.rejectOnExpectedFailure(C)];p=new E.t(e.urls[o.t.itemUrl].replace("/_api/v2.0/","/_api/v2.1/")),m="",a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.getDriveAccessTokenVroom2_1(e)];case 2:return(m=a.sent())?[3,4]:(C="Access token is empty",i.end({resultType:u.t.ExpectedFailure,error:C}),[2,this.rejectOnExpectedFailure(C)]);case 3:return g=a.sent(),C="Failed to get token ".concat(null!==(t=null==g?void 0:g.message)&&void 0!==t?t:""),i.end({resultType:u.t.Failure,error:C}),[2,Promise.reject({error:{code:null==g?void 0:g.status,message:C,correlationId:"",isExpected:403===(null==g?void 0:g.status)}})];case 4:try{p.setPath("".concat(p.getPath(!0),"/media/transcripts")),p.setQueryParameter("access_token",m),p.removeQueryParameter("version")}catch(e){return C="Failed to process base url ".concat(null!==(n=null==e?void 0:e.message)&&void 0!==n?n:""),i.end({resultType:u.t.ExpectedFailure,error:C}),[2,this.rejectOnExpectedFailure(C)]}a.label=5;case 5:return a.trys.push([5,7,,8]),[4,l.e.start({url:p.toString(),method:"GET"})];case 6:(null==(v=a.sent())?void 0:v.getResponseHeader)&&"function"==typeof v.getResponseHeader&&(s=v.getResponseHeader(_),c=v.getResponseHeader(h)||null,d=v.getResponseHeader(b)||null,f=+c+ +d||null),y=void 0;try{S=function(e,t){return"source"===e?t.toLowerCase():t},y=JSON.parse(v.responseText,S)}catch(e){throw x=new Error("Failed to parse response text. message: ".concat(null==e?void 0:e.message," responseStatus: ").concat(null==v?void 0:v.status))}return i.end({resultType:u.t.Success,extraData:{correlationId:s,spIisLatency:f}}),[2,y&&y.value?y.value:void 0];case 7:return(D=a.sent())instanceof XMLHttpRequest?((null==(I=D)?void 0:I.getResponseHeader)&&"function"==typeof I.getResponseHeader&&(s=I.getResponseHeader(_)||"",c=(null==I?void 0:I.getResponseHeader(h))||null,d=(null==I?void 0:I.getResponseHeader(b))||null,f=+c+ +d||null),i.end({resultType:I.status<=0?u.t.ExpectedFailure:u.t.Failure,error:I.statusText,extraData:{httpStatusCode:I.status,spIisLatency:f,correlationId:s}}),[2,Promise.reject({error:{code:I.status,message:0!==I.status||I.statusText?I.statusText:"Failed while making network request",isExpected:I.status<=0,correlationId:s}})]):(x="object"==typeof(null==D?void 0:D.message)?JSON.stringify(null==D?void 0:D.message):(null==D?void 0:D.message)||"",C="Transcripts failed to fetch, an error occurred outside of the request. ".concat(x),i.end({resultType:u.t.Failure,error:C,extraData:{typeofError:typeof D}}),[2,Promise.reject({error:{code:null!==(r=null==D?void 0:D.status)&&void 0!==r?r:0,message:C,correlationId:s,isExpected:403===(null==D?void 0:D.status)}})]);case 8:return[2]}})})},e.prototype._fetchMediaTranscriptsAndAudioFiles=function(e){var t,n,r,s,c;return Object(a.__awaiter)(this,void 0,i.n,function(){var i,d,f,p,m,g,v,y,S,D,I,x,C,O,w,A;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(i=new u.e({name:"Video.FetchMediaTranscriptsAndAudioFiles"}),d="",f=null,p=null,m=null,!e||!e.urls||!e.urls[o.t.itemUrl])return A="Item URLs not available in current environment.",i.end({resultType:u.t.ExpectedFailure,error:A}),[2,this.rejectOnExpectedFailure(A)];g=new E.t(e.urls[o.t.itemUrl].replace("/_api/v2.0/","/_api/v2.1/")),v="",a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.getDriveAccessTokenVroom2_1(e)];case 2:return(v=a.sent())?[3,4]:(A="Access token is empty",i.end({resultType:u.t.ExpectedFailure,error:A}),[2,this.rejectOnExpectedFailure(A)]);case 3:return y=a.sent(),A="Failed to get token ".concat(null!==(t=null==y?void 0:y.message)&&void 0!==t?t:""),i.end({resultType:u.t.Failure,error:A}),[2,Promise.reject({error:{code:null==y?void 0:y.status,message:A,correlationId:"",isExpected:403===(null==y?void 0:y.status)}})];case 4:try{g.setQueryParameter("$expand","media/transcripts,media/audioTracks"),g.setQueryParameter("$select","media/transcripts,audioTracks"),g.setQueryParameter("access_token",v),g.removeQueryParameter("version")}catch(e){return A="Failed to process base url ".concat(null!==(n=null==e?void 0:e.message)&&void 0!==n?n:""),i.end({resultType:u.t.ExpectedFailure,error:A}),[2,this.rejectOnExpectedFailure(A)]}a.label=5;case 5:return a.trys.push([5,7,,8]),[4,l.e.start({url:g.toString(),method:"GET",headers:{Application:"OnePlayer",Scenario:"LoadPlayer",ScenarioType:"PO"}})];case 6:(null==(S=a.sent())?void 0:S.getResponseHeader)&&"function"==typeof S.getResponseHeader&&(d=S.getResponseHeader(_),f=S.getResponseHeader(h)||null,p=S.getResponseHeader(b)||null,m=+f+ +p||null),i.end({resultType:u.t.Success,extraData:{correlationId:d,spIisLatency:m}}),D=void 0,I=void 0;try{x=function(e,t){return"source"===e?t.toLowerCase():t},D=JSON.parse(S.responseText,x),I=D.media}catch(e){throw w=new Error("Failed to parse response text. message: ".concat(null==e?void 0:e.message," responseStatus: ").concat(null==S?void 0:S.status))}return D&&I?(I.transcripts=null!==(r=I.transcripts)&&void 0!==r?r:[],I.audioTracks=null!==(s=I.audioTracks)&&void 0!==s?s:[],[2,I]):[2,{transcripts:[],audioTracks:[]}];case 7:return(C=a.sent())instanceof XMLHttpRequest?((null==(O=C)?void 0:O.getResponseHeader)&&"function"==typeof O.getResponseHeader&&(d=O.getResponseHeader(_)||"",f=(null==O?void 0:O.getResponseHeader(h))||null,p=(null==O?void 0:O.getResponseHeader(b))||null,m=+f+ +p||null),i.end({resultType:O.status<=0?u.t.ExpectedFailure:u.t.Failure,error:O.statusText,extraData:{httpStatusCode:O.status,spIisLatency:m,correlationId:d}}),[2,Promise.reject({error:{code:O.status,message:0!==O.status||O.statusText?O.statusText:"Failed while making network request",isExpected:O.status<=0,correlationId:d}})]):(w="object"==typeof(null==C?void 0:C.message)?JSON.stringify(null==C?void 0:C.message):(null==C?void 0:C.message)||"",A="Transcripts and AudioFiles failed to fetch, an error occurred outside of the request. ".concat(w),i.end({resultType:u.t.Failure,error:A,extraData:{typeofError:typeof C}}),[2,Promise.reject({error:{code:null!==(c=null==C?void 0:C.status)&&void 0!==c?c:0,message:A,correlationId:d,isExpected:403===(null==C?void 0:C.status)}})]);case 8:return[2]}})})},e.prototype._makeVideoMetadataCallWithFetch=function(e,t){return void 0===t&&(t=!1),Object(a.__awaiter)(this,void 0,i.n,function(){var n,i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return n=new E.t(e.urls[o.t.itemUrl]),[4,this.getDriveAccessToken(e)];case 1:return i=a.sent(),n.setQueryParameter("access_token",i),n.setQueryParameter("select","media,source,sharepointIds,commentSettings".concat(t?",ctag,etag":"")),[4,fetch(n.toString(),{method:"GET"}).then(function(e){if(!e.ok)throw e;return e.json()})];case 2:return[2,a.sent()]}})})},e.prototype.getParameterByName=function(e,t){var n=RegExp("[?&]"+e+"=([^&]*)").exec(t);return n&&decodeURIComponent(n[1].replace(/\+/g," "))},e.prototype.isHmacExpired=function(e){void 0===e&&(e="0");var t=Object(g.isFeatureEnabled)(g.VideoMoreAgressiveTokenRefresh)?300:60;return e<(Date.now()/1e3+t).toString()},e.prototype._getItemHMAC=function(e,t,n){if(e&&e.hmac&&!this.isHmacExpired(e.hmac.expiry))return new i.n(function(t,n){t(e.hmac)});var a=this.getParameterByName("provider",t),r=n,o=this.getParameterByName("docId",t),s=document.createElement("a");s.href=t;var c,d=s.pathname,l=s.origin;return l+=d.replace("videotranscode","renewurlsigningContract"),c={provider:a||"",access_token:r,docId:o||"",apiUrlPath:d,url:l},this._graphDataSource.getHmacHash(e,c)},e.prototype._getCachedToken=function(e){var t=this,n=this._cached,a=this._graphDataSource,r={apiVersion:Object(g.isFeatureEnabled)(g.MediaTAUseVroomV21)?"v2.1":"v2.0",useDirectEndpoint:!0},o=M(a.getDriveUrl(e,r));if(n&&n.driveUrl===o&&n.expiry>Date.now())return i.n.resolve(n.token);var c=function(e){if(e){var n=e&&Object(s.a)(e),a=Date.now(),r=Object(g.isFeatureEnabled)(g.VideoMoreAgressiveTokenRefresh)?300:60,c=n&&1e3*(Number(n.exp)-r);if(c&&c>a){var d={expiry:c,token:e,driveUrl:o};return t._cached=d,i.n.resolve(e)}}},d=a.getAccessToken(e,r),l=d&&d.accessToken;return c(l)||this._tokenFetcher.getAuthToken(e.key).then(function(e){var t,n=e.data,a=n[".driveAccessToken"],i=n[".driveAccessTokenV21"],r=n[".driveUrl"],s=n[".driveUrlV21"];return r&&a&&o.indexOf(M(r))>=0?t=c(k(a)):s&&i&&o.indexOf(M(s))>=0&&(t=c(k(i))),t||Promise.reject(new x.e({code:"NoAuth",isExpected:!1,message:"Cannot find auth token"}))})},e.prototype._getFormat=function(e){return e===v.n.htmlDashling||e===v.n.htmlDashlingMediaFoundationFallback||e===v.n.flashDash||e===v.n.htmlDashlingFFMPEGFallback?"dash":e===v.n.htmlHlsV6||e===v.n.htmlHlsV6MediaFoundationFallback||e===v.n.htmlHlsV6FFMPEGFallback?"hls-vnext":void 0},e.prototype.rejectOnExpectedFailure=function(e){return Promise.reject({error:{code:-1,message:e,correlationId:"",isExpected:!0}})},e}();function k(e){if(e.indexOf("=")<0)return e;var t=Object(C.e)(e);return t&&t.access_token}function M(e){if(!e)return e;var t=new O.e(e.toLowerCase());return"".concat(t.authority.replace(/:443$/g,"")).concat(t.path)}t.default=L;var P=Object(r.r)("VideoItemDataSource",L,{downloadDataSource:y.c,graphDataSource:y.y,itemUrlHelper:D.s,pageContext:S.p,tokenFetcher:I.e,vroomDataRequestor:A.e})}}]);