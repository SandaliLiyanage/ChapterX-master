(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[561],{2131:function(e,t,n){"use strict";n.r(t),n.d(t,"FloodgateDataSource",function(){return ee}),n.d(t,"resourceKey",function(){return te});var a={};n.r(a),n.d(a,"NPSCampaignForLists",function(){return p.e}),n.d(a,"NPSCampaignForListsDebug",function(){return p.t}),n.d(a,"NPSCampaignProd",function(){return g}),n.d(a,"NPSCampaignDogfood",function(){return v}),n.d(a,"NPSCampaignForceNomination",function(){return y}),n.d(a,"ODNPSCampaignProd",function(){return S}),n.d(a,"ODNPSCampaignDogfood",function(){return D}),n.d(a,"ODNPSCampaignForceNomination",function(){return I}),n.d(a,"NPSCampaignDebugForSPO",function(){return x}),n.d(a,"NPSCampaignDebugForSPOSharedialog",function(){return C}),n.d(a,"NPSCampaignDebugForSPOSharedialogV2",function(){return O}),n.d(a,"NPSCampaignForSPO",function(){return w}),n.d(a,"NPSCampaignForSPOSharedialog",function(){return E}),n.d(a,"NPSCampaignForSPOSharedialogV2",function(){return A}),n.d(a,"NPSSuiteSurvey",function(){return L}),n.d(a,"AllPhotosFPSSurvey",function(){return k}),n.d(a,"ODBMoveFPSSurvey",function(){return M}),n.d(a,"ODBCopyFPSSurvey",function(){return P}),n.d(a,"ODCMoveFPSSurvey",function(){return T}),n.d(a,"ODCCopyFPSSurvey",function(){return U}),n.d(a,"NlqsSurveyForBigLangs",function(){return F}),n.d(a,"NlqsSurveyForMediumLangs",function(){return H}),n.d(a,"SearchNPSCampaigns",function(){return R}),n.d(a,"NlqsSurveyForSmallLangs",function(){return N});var i=n(0),r=n(33),o=n(600),s=n(376),c=n(181),d=n(1726),l=n(1368),u=n(6600),f=n(5373),p=n(4590),m={Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MeaningfulNpsAction",Count:1,IsAggregate:!0},{Type:0,Activity:"NewNpsSession",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:u.p,Question:f.n,YesLabel:f.s,NoLabel:f.i},Rating:{Question:u.T,RatingValuesAscending:[f.r,"2","3","4",f.o]},Question:{Question:u.r}}},_=Object(i.__assign)(Object(i.__assign)({},m),{Content:Object(i.__assign)(Object(i.__assign)({},m.Content),{Rating:{Question:u.F,RatingValuesAscending:[u.u,"2","3","4",u.f]}})}),h={Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SPListAction",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:u.p,Question:f.n,YesLabel:f.s,NoLabel:f.i},Rating:{Question:u.U,RatingValuesAscending:[f.r,"2","3","4",f.o]},Question:{Question:u.o}}},b={Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShareComplete",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:u._,Question:u.h,YesLabel:f.s,NoLabel:f.i},Rating:{Question:u.z,RatingValuesAscending:[u.H,u.R,u.N,u.B,u.j]},Question:{Question:u.V}}},g={CampaignId:"520978bb-a341-4304-8733-25b60ca048a5",StartTimeUtc:"2018-11-29T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:3,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:m},v={CampaignId:"520978bb-a341-4304-8733-25b60ca048a5",StartTimeUtc:"2018-11-29T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:432e3}},SurveyTemplate:m},y={CampaignId:"520978bb-a341-4304-8733-25b60ca048a5",StartTimeUtc:"2018-11-29T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:432e3}},SurveyTemplate:m},S=Object(i.__assign)(Object(i.__assign)({},g),{SurveyTemplate:_}),D=Object(i.__assign)(Object(i.__assign)({},v),{SurveyTemplate:_}),I=Object(i.__assign)(Object(i.__assign)({},y),{SurveyTemplate:_}),x={CampaignId:"a546f732-aac7-49d2-9da5-9a55220505a0",StartTimeUtc:"2019-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:h},C={CampaignId:"c7d37fa8-ca5b-4441-b55f-546ffc8c23a0",StartTimeUtc:"2023-04-03T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:b},O={CampaignId:"0f372472-b342-43f2-8eb6-c9ab9186e72b",StartTimeUtc:"2023-11-08T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:b},w={CampaignId:"a546f732-aac7-49d2-9da5-9a55220505a0",StartTimeUtc:"2019-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:6,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:h},E={CampaignId:"c7d37fa8-ca5b-4441-b55f-546ffc8c23a0",StartTimeUtc:"2023-04-03T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:1,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:b},A={CampaignId:"0f372472-b342-43f2-8eb6-c9ab9186e72b",StartTimeUtc:"2023-11-08T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:1,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:b},L={CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",StartTimeUtc:"2019-03-21T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:3,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MeaningfulNpsAction",Count:1,IsAggregate:!0},{Type:0,Activity:"NewNpsSession",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:u.p,Question:f.n,YesLabel:f.s,NoLabel:f.i},Rating:{Question:u.g,RatingValuesAscending:[f.r,"2","3","4",f.o]},Question:{Question:u.b}}}},k={CampaignId:"f603ed6a-6f11-4e88-8f4d-7050fda6a676",StartTimeUtc:"2019-10-10T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:20,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"EnteredAllPhotosView",Count:2,IsAggregate:!0}]},Content:{Prompt:{Title:u.e,Question:f.n,YesLabel:f.s,NoLabel:f.i},Rating:{Question:u.t,RatingValuesAscending:[u.n,"2","3","4",u.a]},Question:{Question:u.i}}}},M={CampaignId:"e9808919-b9be-44a7-85fa-2a11dbf35d41",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODBMoveActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:u.S,Question:u.D,YesLabel:f.s,NoLabel:f.i},Rating:{Question:u.y,RatingValuesAscending:[u.n,"2","3","4",u.a]},Question:{Question:u.v}}}},P={CampaignId:"bf829135-ea3a-43e7-8592-6d62259a0a92",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODBCopyActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:u.d,Question:u.l,YesLabel:f.s,NoLabel:f.i},Rating:{Question:u.c,RatingValuesAscending:[u.n,"2","3","4",u.a]},Question:{Question:u.s}}}},T={CampaignId:"54eeb279-6ab7-4f26-880c-0643d3d60e53",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODCMoveActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:u.S,Question:u.D,YesLabel:f.s,NoLabel:f.i},Rating:{Question:u.y,RatingValuesAscending:[u.n,"2","3","4",u.a]},Question:{Question:u.v}}}},U={CampaignId:"ffd1b867-3ee8-4ca9-a04c-2467930dfc54",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODCCopyActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:u.d,Question:u.l,YesLabel:f.s,NoLabel:f.i},Rating:{Question:u.c,RatingValuesAscending:[u.n,"2","3","4",u.a]},Question:{Question:u.s}}}},F={CampaignId:"a0be9dbb-0be9-429c-a632-c8de3a4d08b8",StartTimeUtc:"2021-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,Scope:{Languages:[{Type:0,Value:"de"},{Type:0,Value:"en-GB"},{Type:0,Value:"es-MX"},{Type:0,Value:"fr"},{Type:0,Value:"ja"},{Type:0,Value:"nl"},{Type:0,Value:"pt-BR"},{Type:0,Value:"zh-CN"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:3,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageTime",Count:300,IsAggregate:!0},{Type:0,Activity:"AppResume",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:u.C,Question:u.x,YesLabel:u.O,NoLabel:u.I},Rating:{Question:u.E,RatingValuesAscending:[u.A,u.L,u.k,u.M,u.P]},Question:{Question:u.w}}}},H={CampaignId:"a0be9dbb-0be9-429c-a632-c8de3a4d08b8",StartTimeUtc:"2021-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,Scope:{Languages:[{Type:0,Value:"ar"},{Type:0,Value:"es"},{Type:0,Value:"fil-PH"},{Type:0,Value:"id"},{Type:0,Value:"it"},{Type:0,Value:"ko"},{Type:0,Value:"ms"},{Type:0,Value:"pl"},{Type:0,Value:"pt-PT"},{Type:0,Value:"ru"},{Type:0,Value:"sv"},{Type:0,Value:"th"},{Type:0,Value:"tr"},{Type:0,Value:"vi"},{Type:0,Value:"zh-TW"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageTime",Count:300,IsAggregate:!0},{Type:0,Activity:"AppResume",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:u.C,Question:u.x,YesLabel:u.O,NoLabel:u.I},Rating:{Question:u.E,RatingValuesAscending:[u.A,u.L,u.k,u.M,u.P]},Question:{Question:u.w}}}},R={CampaignId:"78e6a7ce-b772-40d2-9d08-39a9f5703919",StartTimeUtc:"2022-03-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:10368e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SyntexModelsGeneralFeedback",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:u.m,Question:f.n,YesLabel:f.s,NoLabel:f.i},Rating:{Question:u.r,RatingValuesAscending:[f.r,"2","3","4",f.o]},Question:{Question:u.r}}}},N={CampaignId:"a0be9dbb-0be9-429c-a632-c8de3a4d08b8",StartTimeUtc:"2021-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,Scope:{Languages:[{Type:0,Value:"af"},{Type:0,Value:"az-Latn-AZ"},{Type:0,Value:"be"},{Type:0,Value:"bg"},{Type:0,Value:"bn-BD"},{Type:0,Value:"bs-Latn-BA"},{Type:0,Value:"cs"},{Type:0,Value:"da"},{Type:0,Value:"el"},{Type:0,Value:"et"},{Type:0,Value:"fa-IR"},{Type:0,Value:"fi"},{Type:0,Value:"fr-CA"},{Type:0,Value:"he"},{Type:0,Value:"hi"},{Type:0,Value:"hr"},{Type:0,Value:"hu"},{Type:0,Value:"ka"},{Type:0,Value:"kk"},{Type:0,Value:"km-KH"},{Type:0,Value:"lb-LU"},{Type:0,Value:"lv"},{Type:0,Value:"mt-MT"},{Type:0,Value:"nb-NO"},{Type:0,Value:"ne-NP"},{Type:0,Value:"nn-NO"},{Type:0,Value:"pa-Arab-PK"},{Type:0,Value:"quz-PE"},{Type:0,Value:"ro"},{Type:0,Value:"sk"},{Type:0,Value:"sl"},{Type:0,Value:"sq"},{Type:0,Value:"uk"},{Type:0,Value:"uz-Latn-UZ"},{Type:0,Value:"yo-NG"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageTime",Count:300,IsAggregate:!0},{Type:0,Activity:"AppResume",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:u.C,Question:u.x,YesLabel:u.O,NoLabel:u.I},Rating:{Question:u.E,RatingValuesAscending:[u.A,u.L,u.k,u.M,u.P]},Question:{Question:u.w}}}},B=n(1042),j=n(2),V=n(53),z=n(52),G=n(145),K=n(735),W=n(25),q=n(3116),Q=n(4),Y=new(n(6).t)({name:"sharingFloodgateParams.key",factory:{dependencies:{},create:function(){return{instance:{simplifiedShareDialogExperiment:!1,simplifiedShareDialogV2Experiment:!1,sharingNotification:"",campaignDefinitionDF:void 0,campaignDefinitionProd:void 0}}}}}),J=n(5374),X=n(94);Object(X.n)([{rawString:"#obf-TPromptContainer:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}#obf-ToastContainer{background-color:"},{theme:"menuBackground",defaultValue:"#fff"},{rawString:";border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}#obf-ToastContainer #obf-TFormComment{background-color:"},{theme:"menuBackground",defaultValue:"#fff"},{rawString:"}#obf-ToastContainer #obf-TFormTitle,#obf-ToastContainer #obf-TPromptTitle{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}#obf-ToastContainer .obf-ChoiceGroup input[type=radio]:checked+label>.obf-ChoiceGroupIcon>span{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}#obf-ToastContainer .obf-ChoiceGroup input[type=radio]:checked+label>.obf-ChoiceGroupIcon{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}#obf-ToastContainer #obf-TFormRating,#obf-ToastContainer #obf-TPromptText,#obf-ToastContainer #obf-ToastCancel svg path{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";fill:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}#obf-ToastContainer .obf-Link{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}#obf-ToastContainer .obf-TextInput{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}#obf-ToastContainer .obf-TextInput::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}#obf-ToastContainer .obf-Link:focus,#obf-ToastContainer .obf-SubmitButton:focus{outline-color:"},{theme:"black",defaultValue:"#000"},{rawString:"}#obf-ToastContainer .obf-ChoiceGroup input:focus+label{outline-color:"},{theme:"black",defaultValue:"#000"},{rawString:"}#obf-ToastContainer .obf-SubmitButton[disabled],#obf-ToastContainer .obf-SubmitButton[disabled]:active,#obf-ToastContainer .obf-SubmitButton[disabled]:focus,#obf-ToastContainer .obf-SubmitButton[disabled]:hover{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:";color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}"}]);var Z=Q.t.isActivated("560845a6-74b3-47bd-99f6-f8657c1fe45d","10/18/22","Skip setSurveyStatus SPO"),$=Q.t.isActivated("5F701551-DB34-430C-84FA-7C995F37DC08","07/25/2023","Updated NPS question"),ee=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,{appId:n.appId,theme:K.n},n)||this;if(a.onSurveyActivated=function(e){var t=e.survey.surveyInfo.data.backEndIdentifier,n=a._pageContext&&a._pageContext.isSPO;a._userInfoProvider.getSurveyStatusUserFact(t,!!n,!0).then(function(i){if(i.activated){for(var r=!1,o=0,s=a._campaignDefinitions;o<s.length;o++){var c=s[o];if(c.CampaignId===t){var d=1e3*c.NominationScheme.CooldownPeriod.IntervalSeconds;r=(new Date).getTime()>i.dateLastModified.getTime()+d}}if(!r)return void a._engagement.logData({name:"Floodgate.SurveyBlockedByUserFact",extraData:{id:t},isIntentional:!0})}a._ratingComponent=e.survey&&e.survey.getRatingComponent&&e.survey.getRatingComponent(),e.launch();var l={activated:!0,dateLastModified:new Date};!Q.t.isActivated("069E3BF0-5DF9-4305-A165-C4280E18F2DE","10/26/20","Skip setSurveyStatus SPO")&&n?a._engagement.logData({name:"Floodgate.SurveyShown",extraData:{id:t},isIntentional:!0}):a._userInfoProvider.setSurveyStatusUserFact(t,l).then(function(e){a._engagement.logData({name:"Floodgate.SurveyShown",extraData:{id:t,userFactUpdated:e},isIntentional:!0})})})},a.onSurveyDismissed=function(e,t){var n=new r.e({name:"Floodgate.SurveyCompleted"});if(t){var i=a.getEngine();if(i){var o=i.launchedSurveys,s=-1;for(var c in o)o[c].surveyInfo.data.backEndIdentifier===e&&(s=o[c].rating.selectedIndex+1);n.end({extraMetrics:{surveyResponse:s,sessionId:a._sessionId},resultType:r.t.Success}),a._engagement.logData({name:"Floodgate.SurveySubmitted",extraData:{id:e,response:s,sessionId:a._sessionId},isIntentional:!0})}if(a._pageContext&&a._pageContext.isSPO&&a._ratingComponent&&a._ratingComponent.getSelectedRating){var d=a._ratingComponent.getSelectedRating();-1!==d.indexOf("5")?a._engagement.logData({name:"SharePointNPSPromoter",extraData:{rating:d}}):-1===d.indexOf("1")&&-1===d.indexOf("2")&&-1===d.indexOf("3")||a._engagement.logData({name:"SharePointNPSDetractor",extraData:{rating:d}})}}else n.end({resultCode:"SurveyClosed",resultType:r.t.ExpectedFailure}),a._engagement.logData({name:"Floodgate.SurveyClosed",isIntentional:!0})},a._engagement=n.engagement,a._userInfoProvider=n.userInfoProvider,a._platformDetection=n.platformDetection,a._sessionId=G.e.generate(),a._appId=n.appId,a._pageContext=n.pageContext,a._isItemsScopeEnabledInAllPhotosPivotResource=n.isItemsScopeEnabledInAllPhotosPivotResource,a._sharingFloodgateParams=n.sharingFloodgateParams,a._campaignDefinitions=[],t.customCampaignDefinitions)a._campaignDefinitions=t.customCampaignDefinitions;else{a._campaignDefinitions=[];var i=a._getActiveOneDriveNpsCampaign();i&&a._campaignDefinitions.push(i),a._pageContext&&a._pageContext.isSPO&&(a._pageContext.farmName&&a._pageContext.farmName.indexOf("MSIT_SPDF")>-1?(a._campaignDefinitions.push(x),a._campaignDefinitions.push(p.t),a._sharingFloodgateParams&&a._sharingFloodgateParams.campaignDefinitionDF&&a._campaignDefinitions.push(a._sharingFloodgateParams.campaignDefinitionDF)):(a._campaignDefinitions.push(w),a._campaignDefinitions.push(p.e),a._sharingFloodgateParams&&a._sharingFloodgateParams.campaignDefinitionProd&&a._campaignDefinitions.push(a._sharingFloodgateParams.campaignDefinitionProd))),Object(j.Yo)(j.s)&&a._campaignDefinitions.push(k),Object(j.Yo)(j.ln)&&(a._campaignDefinitions.push(M),a._campaignDefinitions.push(P),a._campaignDefinitions.push(T),a._campaignDefinitions.push(U)),Object(j.Yo)(j.ga)&&(a._campaignDefinitions.push(F),a._campaignDefinitions.push(H),a._campaignDefinitions.push(N)),Object(j.Yo)(j.I)&&a._campaignDefinitions.push(R),a._userInfoProvider.getIsPremium(!1).then(function(e){a._isPremium=e,e&&Object(j.Yo)(j.Da)&&a._campaignDefinitions.push(L)})}return a}return Object(i.__extends)(t,e),t.prototype.multiFeedback=function(e){var t;"true"===(null===(t=window.sessionStorage)||void 0===t?void 0:t.getItem("_isRunningTABTest"))&&!Z||this.waitForFloodgateInit().then(function(){var t;null===(t=window.OfficeBrowserFeedback)||void 0===t||t.multiFeedback(e)})},t.prototype.processViewParams=function(e){e[q.t]&&this._resetAllSurveyStatuses();var t=e[q.n];t&&this._resetSurveyStatusByCampaignId(t),"createList"===e.origin&&this.recordUserAction(q.e)},t.prototype.getAppData=function(){var e={newAllPhotosExperience:this._isItemsScopeEnabledInAllPhotosPivotResource,isPremium:this._isPremium},t=Object(B.t)();t&&(e=Object(i.__assign)(Object(i.__assign)({},e),{lastActionBeforeNPSSurvey:Object(B.e)(t.actionName),extension:t.extension,objectType:t.objectType,currentPage:t.currentPage}));var n=this._sharingFloodgateParams&&this._sharingFloodgateParams.simplifiedShareDialogExperiment,a=this._sharingFloodgateParams&&this._sharingFloodgateParams.simplifiedShareDialogV2Experiment;n&&(e=Object(i.__assign)(Object(i.__assign)({},e),{simplifiedShareDialogExperiment:n})),a&&(e=Object(i.__assign)(Object(i.__assign)({},e),{simplifiedShareDialogV2Experiment:a}));var r=this._sharingFloodgateParams&&this._sharingFloodgateParams.sharingNotification;r&&(e=Object(i.__assign)(Object(i.__assign)({},e),{sharingNotification:r}));var o=Object(i.__assign)({},e);return Q.t.isActivated("BF394A24-0FD3-498F-AB41-35C8EB7ABB65")||(o.isListDataSyncEnabled=!!window.__isListDataSyncEnabled),o},t.prototype.computeLanguage=function(){if(this._pageContext){if(this._pageContext.currentCultureLCID)return this._pageContext.currentCultureLCID;if(this._pageContext.currentLanguage)return this._pageContext.currentLanguage}else if($Config&&$Config.langPref)return $Config.langPref},t.prototype.getUserId=function(){return this._pageContext&&this._pageContext.aadUserId?this._pageContext.aadUserId:$Config&&$Config.hcid?$Config.hcid:G.e.Empty},t.prototype.computeBuildVersion=function(){var e=window._spModuleLink&&window._spModuleLink.buildNumber||window.Flight&&window.Flight.version;if(e){if(!Q.t.isActivated("2538C08F-BC7C-4912-BC25-CF4FFA75D1E3","06/24/2023","Fix build version"))return e.substring(e.lastIndexOf("_")+1);var t=e.match(/\d{4}-\d{2}-\d{2}_\d{8}\.\d{3}/);if(t)return t[0].replace(/-/g,"").replace("_",".")}},t.prototype.getTenantId=function(){var e="00000000-0000-0000-0000-000000000000";return this._pageContext&&this._pageContext.isSPO&&this._pageContext.aadTenantId&&(e=this._pageContext.aadTenantId),e},t.prototype.getFeatureArea=function(){if(this._pageContext&&this._pageContext.isSPO&&void 0!==this._pageContext.listBaseType)return Object(W.a)(this._pageContext.listBaseType)?"Libraries":"List"},t.prototype.isDf=function(){var e=window.FilesConfig&&window.FilesConfig.df;return this._pageContext&&this._pageContext.isSPO&&this._pageContext.farmName&&(e=this._pageContext.farmName.indexOf("MSIT_SPDF")>-1),e},t.prototype.getAudienceGroup=function(){var e="Production",t="Dogfood";return this._pageContext&&this._pageContext.isSPO?"spdf"===this._pageContext.cloudType?t:"prodbubble"===this._pageContext.cloudType?"Microsoft":this.isDf()?t:e:this.isDf()?t:e},t.prototype._getActiveOneDriveNpsCampaign=function(){return Object(j.Yo)(j.ya)?$?y:I:Object(j.Yo)(j.va)?$?v:D:$?g:S},t.prototype._resetSurveyStatusByCampaignId=function(e){this._userInfoProvider.setSurveyStatusUserFact(e,{activated:!1,dateLastModified:new Date}).then(function(t){t&&console.log("UserFact successfully reset: "+e)})},t.prototype._resetAllSurveyStatuses=function(){var e=new Set;for(var t in a){var n=a[t];e.has(n.CampaignId)||(e.add(n.CampaignId),this._resetSurveyStatusByCampaignId(n.CampaignId))}},t.dependencies={engagement:o.e,userInfoProvider:s.O,platformDetection:c.e,appId:d.e,pageContext:z.p.optional,isItemsScopeEnabledInAllPhotosPivotResource:l.n,sharingFloodgateParams:Y.optional},t}(J.e),te=Object(V.r)("FloodgateDataSource",ee)},3116:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r});var a="ListsAction",i="resetAllSurveyStatuses",r="resetSurveyStatusById"},4590:function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"t",function(){return l});var a=n(3116),i=n(5373),r="d443d624-9997-4028-98d0-a990cd23631f",o="2020-09-17T00:00:00Z",s="2025-01-01T00:00:00Z",c={Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:a.e,Count:2,IsAggregate:!0}]},Content:{Prompt:{Title:i.t,Question:i.n,YesLabel:i.s,NoLabel:i.i},Rating:{Question:i.a,RatingValuesAscending:[i.r,"2","3","4",i.o]},Question:{Question:i.e}}},d={CampaignId:r,StartTimeUtc:o,EndTimeUtc:s,GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:6,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:c},l={CampaignId:r,StartTimeUtc:o,EndTimeUtc:s,GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:c}},5374:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(33),i=n(1413),r=n(181),o=n(176),s=n(45),c=n(145),d=n(4),l=n(157),u=d.t.isActivated("560845a6-74b3-47bd-99f6-f8657c1fe45d","10/18/22","Skip setSurveyStatus SPO"),f="Not implemented",p=function(){function e(e,t){this._campaignDefinitions=[],this._eventGroup=new l.t(this),this._engagement=t.engagement,this._platformDetection=t.platformDetection,this._sessionId=c.e.generate(),this._appId=e.appId,this._pageContext=t.pageContext,this._theme=e.theme,e.campaignDefinitions&&(this._campaignDefinitions=e.campaignDefinitions)}return e.prototype.dispose=function(){this._eventGroup.dispose()},e.prototype.recordUserAction=function(e,t){var n,a=this;"true"===(null===(n=window.sessionStorage)||void 0===n?void 0:n.getItem("_isRunningTABTest"))&&!u||this.waitForFloodgateInit().then(function(){var t=a.getEngine();t&&t.getActivityListener().logActivity(e)})},e.prototype.waitForFloodgateInit=function(){var e;return"true"!==(null===(e=window.sessionStorage)||void 0===e?void 0:e.getItem("_isRunningTABTest"))||u?this._initPromise||(this._initPromise=this._initFloodgate()):this._initPromise=Promise.resolve(),this._initPromise},e.prototype.processViewParams=function(e){},e.prototype.onSurveyActivated=function(e){e.launch()},e.prototype.onSurveyDismissed=function(e,t){},e.prototype.getUserId=function(){throw new Error(f)},e.prototype.computeLanguage=function(){throw new Error(f)},e.prototype.getAppData=function(){},e.prototype.getTenantId=function(){throw new Error(f)},e.prototype.getFeatureArea=function(){throw new Error(f)},e.prototype.getEngine=function(){if(window.OfficeBrowserFeedback&&window.OfficeBrowserFeedback.floodgate)return window.OfficeBrowserFeedback.floodgate.getEngine()},e.prototype.computeBuildVersion=function(){throw new Error(f)},e.prototype.isDf=function(){throw new Error(f)},e.prototype.getAudienceGroup=function(){throw new Error(f)},e.prototype._initFloodgate=function(){var e=this,t=n.ee(114,6115,7),i=n.ee(114,6413);return t.then(function(){return i}).then(function(t){var n,i,r=new a.e({name:"Floodgate.Initialized"});if(!window.OfficeBrowserFeedback||!window.OfficeBrowserFeedback.floodgate)return r.end({resultCode:"FloodgateNotLoaded",resultType:a.t.ExpectedFailure,extraData:{error:"Floodgate SDK not loaded."}}),Promise.resolve();try{localStorage.setItem("test","test"),localStorage.removeItem("test")}catch(e){return r.end({resultCode:"LocalStorageDisabled",resultType:a.t.ExpectedFailure,extraData:{error:"Local storage not enabled."}}),Promise.resolve()}var s=e.computeBuildVersion(),c=e.getUserId(),l=e.getTenantId(),u=e.getFeatureArea();window.OfficeBrowserFeedback.initOptions={appId:e._appId,stylesUrl:window.require.toUrl("@ms-ofb/officebrowserfeedback/styles/officebrowserfeedback.css"),intlUrl:window.require.toUrl("@ms-ofb/officebrowserfeedback/intl")+"/",environment:e._computeCurrentEnvironment(),sessionId:e._sessionId,locale:o.t.language,primaryColour:null===(n=e._theme)||void 0===n?void 0:n.themePrimary,secondaryColour:null===(i=e._theme)||void 0===i?void 0:i.themeSecondary,build:s,telemetrySink:e._getTelemetrySink({userId:c,tenantId:l,version:s,featureArea:u,getOneDSSink:t.getOneDSSink})};var f=e.getAppData();f&&(window.OfficeBrowserFeedback.initOptions.applicationGroup={appData:JSON.stringify(f)});var p=e.isDf(),m=d.t.isActivated("F81E37F3-93C2-4D32-A363-6D730A645048")?p?"Dogfood":"Production":e.getAudienceGroup();return window.OfficeBrowserFeedback.initOptions.telemetryGroup={audienceGroup:m,officeUILang:e.computeLanguage(),loggableUserId:c,tenantId:l,featureArea:u},e._platformDetection&&(window.OfficeBrowserFeedback.initOptions.telemetryGroup.platform=e._platformDetection.osName,window.OfficeBrowserFeedback.initOptions.webGroup={browser:e._platformDetection.browserName}),window.OfficeBrowserFeedback.initOptions.telemetryGroup.channel="CC",window.OfficeBrowserFeedback.floodgate.initOptions={campaignDefinitions:e._campaignDefinitions,onDismiss:e.onSurveyDismissed,onSurveyActivatedCallback:{onSurveyActivated:e.onSurveyActivated}},window.OfficeBrowserFeedback.floodgate.initialize().then(function(){var t;return null===(t=window.OfficeBrowserFeedback)||void 0===t?void 0:t.floodgate.start().then(function(){var t=e.getEngine();if(!t)throw new Error("Floodgate engine initialization failed silently.");var n=t.getActivityListener();n.logActivityStartTime("AppUsageTime"),n.logActivity("AppResume"),e._setupEventListeners(),r.end({resultType:a.t.Success})})}).catch(function(e){r.end({resultCode:"FloodgateInitializationFailure",resultType:a.t.Failure})})})},e.prototype._computeCurrentEnvironment=function(){return 0},e.prototype._setupEventListeners=function(){var e=this,t=this.getEngine();this._eventGroup.on(window,"blur",function(){var e;t&&(t.getActivityListener().logActivityStopTime("AppUsageTime"),null===(e=window.OfficeBrowserFeedback)||void 0===e||e.floodgate.stop())}),this._eventGroup.on(window,"unload",function(){var e;t&&(t.getActivityListener().logActivityStopTime("AppUsageTime"),null===(e=window.OfficeBrowserFeedback)||void 0===e||e.floodgate.stop())}),this._eventGroup.on(window,"focus",function(){window.OfficeBrowserFeedback&&window.OfficeBrowserFeedback.floodgate&&window.OfficeBrowserFeedback.floodgate.start().then(function(){var e,t=null===(e=window.OfficeBrowserFeedback)||void 0===e?void 0:e.floodgate.getEngine().getActivityListener();t&&(t.logActivityStartTime("AppUsageTime"),t.logActivity("AppResume"))}).catch(function(t){e._engagement.logData({name:"Floodgate.FailedToReinitialize",extraData:{error:t}})})})},e.prototype._getTelemetrySink=function(e){var t=this,n=e.userId,a=e.tenantId,i=e.featureArea,r=e.version,o=e.getOneDSSink;return this._pageContext&&this._pageContext.oneDsCollectorUrl?o({userId:n,tenantId:a,featureArea:i||"",version:r||"",correlationId:this._pageContext.CorrelationId||"",isAnonymous:Boolean(this._pageContext.isAnonymousGuestUser),oneDsCollectorUrl:this._pageContext.oneDsCollectorUrl}):{sendTelemetryEvent:function(e,n){t._engagement.logData({name:"Floodgate.TelemetrySinkNoOneDsCollectorUrl",extraData:{featureArea:i,version:r}})}}},e.dependencies={engagement:i.e,platformDetection:r.e,pageContext:s.e.optional},e}()}}]);