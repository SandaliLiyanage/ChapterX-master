(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[836],{2736:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={Schema:4}},3110:function(e,t,n){"use strict";var a=n(0),i=n(111),r=n(176),o=n(2736);function s(e){return!!e.fileHandler}function c(e){return s(e)&&!!e.promoted}function d(e){return s(e)&&!!e.builtIn}function l(e){return s(e)&&!!e.hidden}var u=/^(?:data|blob|javascript):/i,f=/^(?:data|http|https):/i;function p(e){return!u.test(e)}var m={svg:!0,png1x:!0,png1_5x:!0,png2x:!0};function _(e){var t,n;if(e)for(var a in e)if(m.hasOwnProperty(a)){var i=(n=e[a])&&f.test(n)?n:void 0;i&&(t||(t={}),t[a]=i)}return t}function h(e){return{file:e.file,folder:e.folder,allowMultiSelect:e.allowMultiSelect}}var b=function(){function e(e,t){this._dataRequestor=t.dataRequestor,this._prefetchCache=t.prefetchCache,this._localFileHandlerProvider=t.localFileHandlerProvider}return e.prototype.getFileHandlerData=function(e){return Object(a.__awaiter)(this,void 0,i.n,function(){var t,n,i,u,f,m,b,g,v,y,S,D,I,x,C,O,w,E,A,L=this;return Object(a.__generator)(this,function(k){switch(k.label){case 0:if(n=(t=e||{}).language,i=void 0===n?r.t.language:n,u=t.accessToken,f=void 0===u?void 0:u,m=t.endpoint,b=void 0===m?"":m,g=t.includePromotedApp,v=void 0!==g&&g,y=t.driveId,S=void 0===y?void 0:y,D=t.allowCookies,I=void 0===D?void 0:D,x=b+"/drive",S&&(x="me"===S?"".concat(b,"/me/drive"):"".concat(b,"/drives/").concat(S)),C=function(e){return Object(a.__awaiter)(L,void 0,void 0,function(){var t,n,i,r,u,f,m,b,g,y,S,D,I,x,C,O,w,E,A,L,k,M,P,T,U,F,H,R,N,B,j,V,z;return Object(a.__generator)(this,function(G){switch(G.label){case 0:return t={custom:[],create:[],open:[],preview:[]},n={},this._localFileHandlerProvider?(r=[[]],[4,this._localFileHandlerProvider.getLocalFileHandlers()]):[3,2];case 1:return i=a.__spreadArray.apply(void 0,[a.__spreadArray.apply(void 0,r.concat([G.sent(),!0])),e.value,!0]),[3,3];case 2:i=e.value,G.label=3;case 3:for(u=0,f=i;u<f.length;u++)if(s(m=f[u])&&!l(m)&&(b=v?c(m):void 0,g=d(m),y=m.application,S=m.id,D=m.actions,I=m.fileHandler,D&&(x=I.fileTypeDisplayName,C=I.fileTypeIconUrl,O=I.version)))for(w={id:S,appId:y.id,actionMenuDisplayName:I.actionMenuDisplayName,displayName:y.displayName,appIcon:_(I.appIcon),version:O,fileTypeDisplayName:x,fileTypeIcon:_(I.fileTypeIcon||{png1x:C}),isPromoted:b,isBuiltIn:g},E=0,A=0,L=D;A<L.length;A++)if(k=L[A],(M=k.url)&&p(M)&&(P=k.displayName,T=k.shortDisplayName,U=k.icon,F=k.availableOn)){switch(H="newFile"===k.type?"create":k.type,R={type:H,url:M,displayName:P,icon:_(U),availableOn:h(F),handler:w,id:E},N=F.file,B=N&&N.extensions,H){case"custom":if(!P)continue;if(R.shortDisplayName=T,!N&&!F.folder)continue;break;case"create":if(!B||!B[0])continue;break;case"open":case"preview":if(!N)continue;if(B&&!b)for(j=0,V=B;j<V.length;j++)z=V[j],(n[z]||(n[z]={open:[],preview:[]}))[H].push(R);break;default:continue}t[H].push(R),E++}return[2,{actions:t,preferences:n,version:o.e.Schema}]}})})},O=x+"/apps?"+(v?"select=*,promoted,builtIn&":"")+"$expand=actions",w="GetDriveApps",E=function(){return Object(a.__awaiter)(L,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,this._dataRequestor.send({path:O,apiName:w,headers:{"Accept-Language":i},accessToken:f,useAuthorizationHeaders:!!f,allowCookies:I})];case 1:return e=t.sent(),[4,C(e)];case 2:return[2,t.sent()]}})})},!this._prefetchCache)return[3,5];k.label=1;case 1:return k.trys.push([1,4,,5]),[4,this._prefetchCache.getData({url:O,body:"",qosName:w})];case 2:return A=k.sent(),[4,C(A)];case 3:return[2,k.sent()];case 4:return k.sent(),[3,5];case 5:return[4,E()];case 6:return[2,k.sent()]}})})},e}();t.e=b},3622:function(e,t,n){"use strict";n.d(t,"t",function(){return S}),n.d(t,"e",function(){return D});var a=n(0),i=n(15),r=n(993),o=n(3110),s=n(422),c=n(1210),d=n(1222),l=n(240),u=n(171),f=n(1487),p=n(77),m=n(86),_=n(335),h=n(33),b=n(693),g=n(227),v=n(1242),y=n(4).e.isActivated("9D2052D7-57BA-410E-8329-EAC6DE23E303","07/13/2023","When KS is turned on, it will return to original behavior of allowing multiple app calls regardless of exisiting cached data"),S=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=l.t.deserialize(n),r=i.endpoint;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,o,s,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(t=e(Object(_.e)({name:"getFileHandlersOperation"})),o={endpoint:r},s=Object(v.t)({driveAppsKey:i}),!y&&s)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,e(D(i))];case 2:return s=a.sent(),[3,4];case 3:throw c=a.sent(),e(t(Object(g.e)(c))),c;case 4:s&&Object(v.e)({driveAppsKey:i,data:s}),a.label=5;case 5:return s?(e(Object(v.a)(s,n)),o.fileHandlerRequestEndpoint=s.signature.endpoint,o.accessTokenObtained=!0,e(t({resultType:h.t.Success,extraData:o}))):e(t({resultType:h.t.Failure,resultCode:"NoFileHandlerData",extraData:o})),[2]}})})}});function D(e){var t=e.endpoint,n=e.driveId;return function(e){var i,r={endpoint:t,driveId:n},l=e(Object(_.e)({name:"fetchFileHandlerData",extraData:r})),u=e(Object(m.e)({getUserOneDriveEndpoint:p.y,useOneDriveEndpoint:p.j,enableFileHandlerPrefetch:p.l,graphQLPrefetchCache:p.I,localFileHandlerProvider:f.e})),v=u.getUserOneDriveEndpoint,y=u.useOneDriveEndpoint,S=u.enableFileHandlerPrefetch,D=u.graphQLPrefetchCache,I=u.localFileHandlerProvider,x=Object(s.n)({endpoint:t,driveId:n}),C=new o.e({},Object(a.__assign)({dataRequestor:e(c.e).dataRequestor,localFileHandlerProvider:I},S&&D?{prefetchCache:D}:{})),O=Promise.resolve(t);return v&&y&&(O=e(v({endpoint:t}))),O.then(function(t){return i=t,x=Object(s.n)({endpoint:i}),r.fileHandlerRequestEndpoint=i,e(Object(d.getSessionToken)({endpoint:i,driveUrl:x,qosExtraData:{requestor:"GetFileHandlerData",endPoint:i,driveUrl:x}}))}).then(function(t){return r.accessTokenObtained=!!t,C.getFileHandlerData({accessToken:t,endpoint:i,includePromotedApp:!0,driveId:n}).then(function(t){if(t){var a={data:t,lastModified:Date.now(),signature:{endpoint:i,includePromotedApp:!0,driveId:n}};return e(l({resultType:h.t.Success,extraData:r})),a}e(l({resultType:h.t.Failure,resultCode:"NoDataFromFileHandlerService",extraData:r}))}).catch(function(t){throw e(l(Object(b.e)({resultType:h.t.Failure,extraData:r},Object(g.e)(t)))),t})}).catch(function(t){throw e(l(Object(b.e)({resultType:h.t.Failure,resultCode:"getSessionTokenError",extraData:r},Object(g.e)(t)))),t})}}Object(i.i)()(function(e){var t=this,n=e.itemKey,i=l.e.deserialize(n).endpoint;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return t=l.t.serialize({endpoint:i}),[4,e(Object(r.e)(function(e){return e.demandItemFacet(u.t,t)}))];case 1:return n.sent(),[2]}})})}})},7114:function(e,t,n){"use strict";n.r(t),n.d(t,"updateFileHandlerCache",function(){return s});var a=n(0),i=n(1242),r=n(33),o=n(3622);function s(e){return function(t){var n=e.driveAppsKey,s=e.fileHandlerCacheData,c=new r.e({name:"updateFileHandlerCache"});t(Object(o.e)(n)).then(function(e){Object(i.e)({data:e,driveAppsKey:n}),c.end({resultType:r.t.Success})}).catch(function(e){c.end({resultType:r.t.Failure,extraData:Object(a.__assign)(Object(a.__assign)({},n),{signature:s.signature})})})}}}}]);