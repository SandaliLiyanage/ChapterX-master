(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[111],{2611:function(e,t,n){"use strict";n.d(t,"k",function(){return r}),n.d(t,"A",function(){return o}),n.d(t,"I",function(){return s}),n.d(t,"h",function(){return c}),n.d(t,"c",function(){return d}),n.d(t,"x",function(){return l}),n.d(t,"f",function(){return u}),n.d(t,"m",function(){return f}),n.d(t,"e",function(){return p}),n.d(t,"a",function(){return m}),n.d(t,"n",function(){return _}),n.d(t,"i",function(){return h}),n.d(t,"t",function(){return b}),n.d(t,"y",function(){return g}),n.d(t,"s",function(){return v}),n.d(t,"p",function(){return y}),n.d(t,"v",function(){return S}),n.d(t,"u",function(){return D}),n.d(t,"l",function(){return I}),n.d(t,"g",function(){return x}),n.d(t,"S",function(){return C}),n.d(t,"D",function(){return O}),n.d(t,"b",function(){return w}),n.d(t,"E",function(){return E}),n.d(t,"w",function(){return A}),n.d(t,"C",function(){return L}),n.d(t,"_",function(){return k}),n.d(t,"L",function(){return M}),n.d(t,"O",function(){return P}),n.d(t,"U",function(){return T}),n.d(t,"d",function(){return U}),n.d(t,"o",function(){return F}),n.d(t,"r",function(){return H}),n.d(t,"M",function(){return R}),n.d(t,"T",function(){return N}),n.d(t,"P",function(){return B});var a=n(222),i=n(4),r=a.a.isFeatureEnabled,o={ODB:817,ODC:!0,OneDrive:!0},s={ODB:60124,ODC:"UseMsPdfViewer",OneDrive:!1,Fallback:!1},c={ODB:60358},d={ODB:1655,ODC:!1,OneDrive:!1,Fallback:!1},l={ECS:1071224},u={ECS:1132624},f={ECS:1161382},p={ECS:1082725},m={ECS:1111474},_={ECS:1116309},h={ECS:1125492},b={ECS:1126891},g={ECS:1161070},v={ODB:1614,ODC:!1,OneDrive:!1,Fallback:!1},y={ODB:1063,ODC:!1,OneDrive:!1,Fallback:!1},S={ODB:1513,ODC:!1,OneDrive:!1,Fallback:!1},D={ODB:1811,ODC:!1,OneDrive:!1,Fallback:!1},I={ODB:1425,ODC:!1,OneDrive:!1,Fallback:!1},x={ODB:61332,ODC:!1,OneDrive:!1,Fallback:!1},C={ODB:60165},O={ODB:60192},w={ODB:61066},E={ODB:1355,ODC:!1,OneDrive:!1,Fallback:!1},A={ODB:61094,ODC:!1,OneDrive:!1,Fallback:!1},L={ODB:!i.e.isActivated("8a90e09f-a635-4113-897e-402973bce841","10/21/2021","Use pdf viewer to preview tiff files"),ODC:!0},k={ODB:1698};function M(){return!i.e.isActivated("d9c17c13-cdd6-4c12-aec1-e636d97e7a9c","09/25/2023","Scoping context work for copilot pane in oneup")}var P={ODB:!0,OneDrive:!0},T={ODB:61113},U={ODB:61210},F={ODB:60655},H={ODB:61300},R={ODB:61125},N={ODB:61217},B={ODB:61146}},2887:function(e,t,n){"use strict";n.d(t,"p",function(){return a}),n.d(t,"f",function(){return i}),n.d(t,"m",function(){return r}),n.d(t,"i",function(){return o}),n.d(t,"o",function(){return s}),n.d(t,"r",function(){return c}),n.d(t,"s",function(){return d}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return u}),n.d(t,"l",function(){return f}),n.d(t,"e",function(){return p}),n.d(t,"n",function(){return m}),n.d(t,"t",function(){return _}),n.d(t,"u",function(){return h}),n.d(t,"_",function(){return b}),n.d(t,"a",function(){return g});var a=.5,i=5,r=90,o=14,s=3,c=7,d=5,l=5,u=150,f=96,p=100,m=1,_=255,h=1e8,b="MsPdfViewer.ZOOM_OPTION_STORE_KEY",g="MsPdfViewer.CACHED_DISPLAY_INFO_ARRAY_STORE_KEY"},3025:function(e,t,n){"use strict";n.d(t,"e",function(){return D}),n.d(t,"t",function(){return I});var a=n(0),i=n(183),r=n(53),o=n(181),s=n(231),c=n(699),d=n(3223),l=n(161),u=n(2611),f=n(3274),p=n(85),m=n(45),_=n(975),h=n(3251),b=n(3120),g=n(3275),v=n(2887),y=".pdf",S=["ODBLightSpeedWebPack","TeamsODBFileBrowserWebPack"],D=function(){function e(e,t){this.isWorkerVersionMismatch=function(e){var t,n=null===(t=window._spModuleLink)||void 0===t?void 0:t.buildNumber;return"dev"!==n&&!(!e||!n)&&e!==n},this._enablePdf=Object(u.k)(u.A),this._enableMsPdfviewer=Object(u.k)(u.I),this._enableEmbedMsPdfviewer=Object(u.k)(u.c),this._enableEditPdf=Object(u.k)(u.s),this._enableExtractPdf=Object(u.k)(u.v),this._enablePreviewTif=Object(u.k)(u.C),this._enableHTML=Object(u.k)(u.O)&&(Object(f.e)()||t.platformDetection.isEdge),this._urlDataSource=t.urlDataSource,this._pdfDataSource=t.pdfDataSource,this._navigation=t.navigation,this._viewParams=this._navigation.viewParams,this._platformDetection=t.platformDetection,this._pageContext=t.pageContext,this._embedOptions=t.embedOptions}return e.isWasmSupported=function(){if(void 0===e._isWasmSupported){var t=!1;try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){var n=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));n instanceof WebAssembly.Module&&(t=new WebAssembly.Instance(n)instanceof WebAssembly.Instance)}}catch(e){}e._isWasmSupported=t}return e._isWasmSupported},e.prototype.isNotEmbed=function(){return this._urlDataSource.getPageType(this._viewParams)!==l.e.Embed},e.prototype.isSupportedFileType=function(e){var t=this._extension(e);return this._enablePdf&&(t===y||".ai"===t||!!e.pdfConversion)&&(this._enablePreviewTif||".tif"!==t&&".tiff"!==t)},e.prototype.isDownloadByRangeEnabled=function(e){if(!(Object(u.k)(u.u)||!this.isNotEmbed()&&Object(g.e)(u.f.ECS))||!e.size)return!1;var t=this._platformDetection.isMobile?10485760:31457280;return e.size>t&&!e.pdfConversion},e.prototype.isPreviewerEnabled=function(e){if(!(Object(u.k)(u.g)||!this.isNotEmbed()&&Object(g.e)(u.m.ECS))||!e.size)return!1;var t=this._platformDetection.isMobile?20971520:209715200;return e.size>t&&!e.pdfConversion},e.prototype.isMsPdfViewerSupported=function(e){var t;if(!e)return!1;var n=this._enableMsPdfviewer&&(this.isNotEmbed()||this._enableEmbedMsPdfviewer),a=this._isHostAppTeams()&&Object(g.e)(u.x.ECS),i=!Object(b.r)()&&!Object(g.t)(u.e.ECS)&&!this.isNotEmbed()&&((null===(t=this._embedOptions)||void 0===t?void 0:t.useMsPdf)||!1);return(n||a||i)&&this._isMsPdfViewerSupported(e)},e.prototype.isMsPdfViewerAvailable=function(e){return this.isSupportedFileType(e)&&this._isEnabledInOneUp(e)&&this.isMsPdfViewerSupported(e.size)},e.prototype.isPdfEditAvailable=function(e){var t=!!e.size&&e.size<=v.u;return this.isMsPdfViewerAvailable(e)&&(this._enableEditPdf||!this.isNotEmbed()&&!Object(b.n)()&&!Object(g.t)(u.a.ECS))&&this._extension(e)===y&&t},e.prototype.isPdfExtractAvailable=function(e){return this.hasSyntexLicense()&&this.isMsPdfViewerAvailable(e)&&this.isNotEmbed()&&this._enableExtractPdf},e.prototype.isPdfExtractable=function(){return this.hasSyntexLicense()&&this._enableExtractPdf},e.prototype.isPdfEditable=function(e){var t;return e.itemStatus!==i.t.ConditionalAccessViewOnly&&e.itemStatus!==i.t.ConditionalAccessBlocked&&(null===(t=this._pdfDataSource)||void 0===t?void 0:t.canSave({item:e}))},e.prototype.getWorkerManifestName=function(){var e,t=(null===(e=window._spModuleLink)||void 0===e?void 0:e.manifestName)||"";return Object(u.k)(u.h)&&-1!==S.indexOf(t)?"odbmspdfwebworker":"mspdfwebworker"},e.prototype.getEmbedOptions=function(){return this._embedOptions},e.prototype.hasSyntexLicense=function(){var e,t;return(null===(e=this._pageContext)||void 0===e?void 0:e.canUserUseSyntex)||Object(b.d)()&&(null===(t=this._pageContext)||void 0===t?void 0:t.isUserSyntexV2Licensed)||!1},e.prototype._isHostAppTeams=function(){if(this.isNotEmbed())return!1;var e=this._getClientId();return!!e&&-1!==["MicrosoftTeams","Microsoft Teams","Microsoft Teams Web Client","Teams Service","Teams Client App","Teams Additional Client App","Teams App"].indexOf(e)},e.prototype._isEnabledInOneUp=function(e){return!(e.officeBundle||e.wopiFrameUrl||this._enableHTML&&e.htmlConversion)},e.prototype._isMsPdfViewerSupported=function(t){if(!t)return!1;var n=t<(performance.memory?performance.memory.jsHeapSizeLimit-performance.memory.totalJSHeapSize:268435456)/4;return e.isWasmSupported()&&n},e.prototype._extension=function(e){return e&&e.extension&&e.extension.toLowerCase()||""},e.prototype._getClientId=function(){var e,t=(null===(e=this._pageContext)||void 0===e?void 0:e.authToken)||"",n=Object(c.a)(t);return n&&n.app_displayname||this._getClientIdFromQSP()},e.prototype._getClientIdFromQSP=function(){var e,t=window,n=Object(s.e)((t.location.search||"").slice(1)),i=Object(s.e)((t.location.hash||"").slice(1)),r=(null===(e=t.PageContext)||void 0===e?void 0:e.scenarioContext.embed)||{};return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},n),i),r).client_id},e.dependencies={},e}(),I=Object(r.r)("PdfViewerHelper",D,{platformDetection:o.e,urlDataSource:_.e,navigation:p.e,pdfDataSource:h.e,pageContext:m.e.optional,embedOptions:d.e.optional})},3120:function(e,t,n){"use strict";n.d(t,"r",function(){return i}),n.d(t,"d",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"o",function(){return d}),n.d(t,"s",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"c",function(){return f}),n.d(t,"t",function(){return p});var a=n(4),i=function(){return a.e.isActivated("c3dc126d-70db-4dc6-9ad6-3ce6d59dfaca")},r=function(){return!a.e.isActivated("acc3d562-8099-40b9-ad90-f199e8fcec91","6/15/2023","Syntex V2 License check")},o=function(){return a.e.isActivated("f644d6f3-bfb2-4b67-9ea4-f2bbd98431b0","07/17/2023","Enable editing for mspdf in embed scenarios")},s=function(){return a.e.isActivated("106d45a3-37c3-42cd-95a6-8a04645f8a7b","08/07/2023","Enable host saving for embedded scenarios")},c=function(){return a.e.isActivated("ed408543-0a69-47e8-a898-31bf63f74ce6","08/28/2023","Enable sending PDF related notifications to host for embedded scenarios")},d=function(){return a.e.isActivated("7734ec9d-6955-4473-9ea5-1c21baf2af07","08/31/2023","Fix page content with some Chinese characters cannot be rendered")},l=function(){return a.e.isActivated("facbf24e-8794-4b51-9003-45d3abd49d9b","09/28/2023","Fix sharee can not save pdf change")},u=function(){return a.e.isActivated("58d82ac9-f371-4727-bb77-44cddd470f04","10/19/2023","Allow unloading page with edits for embedded scenarios")},f=function(){return a.e.isActivated("8ba1d3e7-57fd-495f-953b-beb4d093e5e7","11/24/2023","Set pdf unloaded when pdf viewer disposed")},p=function(){return a.e.isActivated("0e5640e9-b84f-4cd2-abf5-46e9e6177353","12/02/2023","Do not send version request for view only PDF")}},3222:function(e,t,n){"use strict";n.d(t,"t",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"n",function(){return u});var a=n(53),i=n(2239),r=n(356),o=n(3313),s=n(16),c=n(3025),d=function(e){return"ZXNpZ24"===e()[s.n.navParamKey]},l=function(){function e(e,t){var n=this;this.isWorkerVersionMismatch=function(e){return n._corePdfViewerHelper.isWorkerVersionMismatch(e)};var a=t.observablesFactoryType,i=t.viewParams,r=new a;this._corePdfViewerHelper=t.corePdfViewerHelper;var s=this.getEmbedOptions(),c=(null==s?void 0:s.allowEdit)&&(null==s?void 0:s.openInEditMode),l=d(i)?o.e.Esign:c?o.e.Edit:o.e.View;this.state={isOpened:r.create(!1),currentMode:r.create(l),filePickerMode:r.create("close"),protectedPdf:r.create(!1),mipPdf:r.create(!1)}}return e.isWasmSupported=function(){return c.e.isWasmSupported()},e.prototype.isMsPdfViewerAvailable=function(e){return this._corePdfViewerHelper.isMsPdfViewerAvailable(this._convertItem(e))},e.prototype.isMsPdfViewerSupported=function(e){return this._corePdfViewerHelper.isMsPdfViewerSupported(e)},e.prototype.isNotEmbed=function(){return this._corePdfViewerHelper.isNotEmbed()},e.prototype.isPdfEditAvailable=function(e){return this._corePdfViewerHelper.isPdfEditAvailable(this._convertItem(e))},e.prototype.isPdfEditable=function(e){return this._corePdfViewerHelper.isPdfEditable(this._convertItem(e))&&!this.state.mipPdf()},e.prototype.isSupportedFileType=function(e){return this._corePdfViewerHelper.isSupportedFileType(this._convertItem(e))},e.prototype.isDownloadByRangeEnabled=function(e){return this._corePdfViewerHelper.isDownloadByRangeEnabled(this._convertItem(e))},e.prototype.getWorkerManifestName=function(){return this._corePdfViewerHelper.getWorkerManifestName()},e.prototype.getEmbedOptions=function(){return this._corePdfViewerHelper.getEmbedOptions()},e.prototype.isPdfExtractAvailable=function(e){return this._corePdfViewerHelper.isPdfExtractAvailable(this._convertItem(e))},e.prototype.isPdfExtractable=function(){return this._corePdfViewerHelper.isPdfExtractable()},e.prototype.hasSyntexLicense=function(){return this._corePdfViewerHelper.hasSyntexLicense()},e.prototype._convertItem=function(e){return e},e.dependencies={observablesFactoryType:i.i,viewParams:r.P,corePdfViewerHelper:c.t},e}(),u=Object(a.r)("PdfViewerHelper",l)},3223:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(6).t)("pdfViewerEmbedOptions")},3251:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(53),r=n(51),o=function(){function e(){}return e.prototype.canSave=function(e){return this.canSaveAsOriginal(e)},e}(),s=n(45),c=function(e){function t(t,n){var a=e.call(this)||this;return a._pageContext=n.pageContext,a}return Object(a.__extends)(t,e),t.prototype.canSaveAsOriginal=function(e){var t,n=e.item;return!!n&&r.e.hasItemPermission(n,r.e.insertListItems)&&r.e.hasItemPermission(n,r.e.editListItems)&&!(null===(t=this._pageContext)||void 0===t?void 0:t.isAnonymousGuestUser)},t}(o),d=Object(i.r)("PdfDataSource",c,{pageContext:s.e.optional})},3274:function(e,t,n){"use strict";var a;function i(){return"boolean"!=typeof a&&(a="srcdoc"in document.createElement("iframe")),a}n.d(t,"e",function(){return i})},3275:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i});var a=function(e){var t,n,a,i;if(!e)return!1;var r=(null===(t=window.Flight)||void 0===t?void 0:t.ecsConfig)&&JSON.parse(null===(n=window.Flight)||void 0===n?void 0:n.ecsConfig),o=null===(i=null===(a=null==r?void 0:r.RolloutContext)||void 0===a?void 0:a.settings)||void 0===i?void 0:i.ODSPMicroservices_ODWeb;return o&&!0===o[e]},i=function(e){return a(e)}},3313:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.View=0]="View",e[e.Edit=1]="Edit",e[e.Extract=2]="Extract",e[e.Esign=3]="Esign"}(a||(a={}))},3680:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(2239),i=new(n(6).t)({name:"".concat("UniversalAnnotationStateKey",".universalAnnotationState"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:{isUniversalAnnotationActive:t.create(!1),hasPreloadSucceeded:t.create(!0)},disposable:t}}}})},4257:function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"n",function(){return l});var a=n(2611),i=n(96),r=n(25),o=n(4);function s(e,t,n,s,c,d){var l,u=t||{},f=u.isSyntexPAYGEnabled,p=u.isSyntexESignatureEnabled,m=u.webTemplate,_=u.listBaseTemplate,h=u.cloudType,b=u.isExternalGuestUser;return!(o.e.isActivated("FE5BDF48-187F-4F55-B5B7-A4EFDFFAE1FD","11/14/2023","Disable e-signature")||n||!Object(a.k)(a.b)||!f||!p||b||m===i.t.mySite.toString()||_===r.t.mySiteDocumentLibrary||".pdf"!==(null===(l=null==e?void 0:e.extension)||void 0===l?void 0:l.toLowerCase())||!c||!c()||d||s||!function(e){if(o.e.isActivated("2AC9DFE6-103D-4580-B6BB-8BACB5CC54A0","11/14/2023","Disable cloud type checking for e-signature"))return!0;if(!e)return!1;switch(e){default:return!1;case"edog":case"spdf":case"prodbubble":case"prod":return!0}}(null==h?void 0:h.toLowerCase()))}function c(e,t,n,a,i,r){return s(e,t,n,a,i,r)}function d(e,t,n,i,r,o){return s(e,t,n,i,r,o)&&Object(a.k)(a.S)}function l(e,t,n,i,r,o){return s(e,t,n,i,r,o)&&Object(a.k)(a.D)}},7248:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(2262),r=n(111),o=n(33),s=n(181),c=n(52),d=n(2267),l=n(4257),u=n(3825),f=n(157),p=n(600),m=n(3680),_=n(3222),h=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="SendForSignature",a._itemSelectionHelper=new(a.child(d.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});var i=n.isEsignPaneExpanded,r=void 0===i?a.resources.consume(u.resourceKey):i,o=n.engagement,s=void 0===o?a.resources.consume(p.e):o;return a._isEsignPaneExpanded=r,a._engagement=s,a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return!1;var t=this.resources.consume(c.p),n=this.resources.consume(m.e),a=this.resources.consume(_.n),i=this.resources.consume(s.e),r=n.hasPreloadSucceeded()&&n.isUniversalAnnotationActive();return Object(l.e)(e,t,r,a.state.protectedPdf()||a.state.mipPdf(),function(){return a.isMsPdfViewerAvailable(e)},i.isMobile)},t.prototype.onExecute=function(e,t){var n=!this._isEsignPaneExpanded.peek();return this._engagement.logData({name:"SendforSignature.Click.".concat(n?"Open":"Close"),isIntentional:!0}),this._isEsignPaneExpanded(n),f.t.raise(document.body,"resize",void 0,!0),r.n.resolve({resultType:o.t.Success})},t}(i.e);t.default=h}}]);