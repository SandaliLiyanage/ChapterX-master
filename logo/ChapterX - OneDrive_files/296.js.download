(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[296,454],{2341:function(e,t,n){"use strict";n.r(t),n.d(t,"EXCLUDED_FIELDS",function(){return m}),n.d(t,"buildSchema",function(){return b}),n.d(t,"getMappedColumnType",function(){return g}),n.d(t,"getCustomColumns",function(){return v}),n.d(t,"getMappedColumnFieldType",function(){return y});var a=n(0),i=n(2057),r=n(607),o=n(602),s=n(25),c=n(2261),d=n(1359),l=n(2376);n.d(t,"getColumnFieldType",function(){return l.e});var u,f=!n(4).t.isActivated("5428C17B-A89D-4E63-A1C5-B3E989C1B7A3","8/21/2023","Remove color tag from edit view columns"),p=((u={})[c.n.icon]={key:"type",index:0,isVisibleMobile:!0,isCollapsable:!1,type:d.e.FileIcon},u[c.n.name]={key:"name",index:1,isRowHeader:!0,isVisibleMobile:!0,isCollapsable:!1,minWidth:c.e.nameMin,width:c.e.nameODB,type:d.e.Name},u[c.n.title]={key:"Title",index:1,isVisibleMobile:!0,isCollapsable:!1,minWidth:c.e.nameMin,width:c.e.nameODB,type:d.e.Title},u[c.n.shareHeroCommand]={key:"_shareHeroCommand",index:2,isVisibleMobile:!1,isCollapsable:!0,minWidth:16,width:18,type:d.e.ShareCommand},u[c.n.calloutInvoker]={key:"_calloutInvoker",index:3,isVisibleMobile:!1,isCollapsable:!0,minWidth:16,width:18,type:d.e.DotDotDot},u[c.n.modified]={key:"dateModified",index:4,isVisibleMobile:!0,isCollapsable:!1,minWidth:c.e.regularMin,width:c.e.regular,type:d.e.DateTime,sortDescFirst:!0},u[c.n.url]={key:"URL",index:5,isVisibleMobile:!0,isCollapsable:!1,minWidth:c.e.nameMin,width:c.e.nameODB,type:d.e.Hyperlink},u),m=Object(a.__spreadArray)(["_ip_UnifiedCompliancePolicyUIAction","_CommentFlags","_CommentCount","Edit","MediaServiceFastMetadata","MediaServiceTranscript","name.FileSystemItemId","SMTotalFileCount","SMTotalSize"],f?["_ColorTag"]:[],!0),_=m.concat(["FolderChildCount","ItemChildCount"]),h=[d.e.Text,d.e.Name,d.e.Title,d.e.DateTime,d.e.Number];function b(e,t,n,a,i){if(e&&e.Field){for(var r=-1,o=0,s=0,l=e.Field;s<l.length;s++){if("TRUE"===(O=l[s]).listItemMenu){r=o;break}o++}!n.disableCalloutInvoker&&r>=0&&e.Field.splice(r+1,0,{DisplayName:n.calloutInvokerDisplayName,Name:"_calloutInvoker",Sortable:"FALSE",Type:"Computed"}),!n.disableShareHeroCommand&&r>=0&&e.Field.splice(r+1,0,{DisplayName:n.shareHeroCommandDisplayName,Name:"_shareHeroCommand",Sortable:"FALSE",Type:"Computed"});for(var u,f,h,b=new Array(n.hasFixedSchema?5:0),y={},D=0,C=e.Field;D<C.length;D++){var O,w=(O=C[D]).Name;if(-1===(n.hasFixedSchema?_:m).indexOf(w)){var E=g(w),A=p[E],L=S(O,A,t,n,e,i);if("TRUE"===O.GroupField&&a){if(a[w]=O,y[w])continue;L.isVisible=!1,L.isVisibleMobile=!1}switch(b[n.hasFixedSchema&&A&&!b[A.index]?A.index:b.length]=L,y[w]=L,E){case c.n.icon:u=L;break;case c.n.name:f=L;break;case c.n.modified:h=L}}}if((t.groupBy||e.group1||e.group2)&&(!u||u!==b[0])){var k={key:"other",name:"",minWidth:c.e.regularMin,width:c.e.regular,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:!1,isSorted:!1,isIcon:!1,isAscending:!0,fieldType:d.e.Text,filterable:!1,groupable:!1,resizable:!1,isGrouped:!1,isFiltered:!1};k.minWidth=x(n.useCustomColumn),k.width=I(n.useCustomColumn),k.fieldType=d.e.Computed,b.unshift(k)}return n.useCustomColumn?v(u,[[f],[h]],[f,h]):b.filter(function(e){return!!e})}}function g(e){switch(e){case"FSObjType":case"DocIcon":return c.n.icon;case"LinkFilename":case"LinkFilenameNoMenu":case"FileLeafRef":case"LinkIssueIDNoMenu":return c.n.name;case"LinkTitle":case"LinkTitleNoMenu":case"Title":return c.n.title;case"_calloutInvoker":return c.n.calloutInvoker;case"_shareHeroCommand":return c.n.shareHeroCommand;case"Modified":return c.n.modified;case"URLwMenu":case"URLNoMenu":return c.n.url;default:return c.n.none}}function v(e,t,n){for(var a={key:"custom",name:"",minWidth:c.e.regularMin,width:c.e.custom,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:!1,isSorted:!1,isIcon:!1,isHtml:!1,isAscending:!0,fieldType:d.e.Text,filterable:!1,groupable:!1,customFields:[]},i=0;i<t.length;i++)for(var r=0,o=t[i];r<o.length;r++){var s=o[r];s.customRowNumber=i,a.customFields.push(s)}for(var l=[e,a],u=0,f=n;u<f.length;u++){var p=f[u];p.isVisible=!1,p.isVisibleMobile=!1,l.push(p)}return l}function y(e){var t=g(e.Name),n=p[t];return n?n.type:Object(l.e)(e)}function S(e,t,n,a,u,f){var p=e.Name,m=t?t.type:Object(l.e)(e),_=!!t&&"type"===t.key,b=h.indexOf(m)>-1,g=n.filterParams||"",v=!!Object(o.getFilterFieldByName)(g,p);if(!v&&f&&f.additionalFiltersXml&&(v=!!f.additionalFiltersXml.match(new RegExp('FieldRef Name="'+p+'"'))),n.viewXmlForRequest)try{var y=r.t(n.viewXmlForRequest);y&&y.where&&1===y.where.querySelectorAll('[id="'.concat(p,'"]')).length&&(v=!0)}catch(e){}var S={key:t?t.key:p,name:e.DisplayName,internalName:p,staticName:e.StaticName,fieldType:m,width:c.e.regular,minWidth:c.e.regularMin,isVisible:!0,isVisibleMobile:!t||t.isVisibleMobile,isCollapsable:!t||t.isCollapsable,canAutoResize:b,isIcon:_,resizable:!0,isRowHeader:!!t&&t.isRowHeader,sortable:"FALSE"!==e.Sortable,filterable:!("FALSE"===e.Filterable||"TRUE"===e.FilterDisable||"Note"===e.FieldType||"URL"===e.FieldType||"FileSizeDisplay"===p||"_IsRecord"===p),groupable:"FALSE"!==e.Groupable&&"FALSE"!==e.Sortable&&C(p,m),editable:!(e.FromBaseType&&"TRUE"===e.FromBaseType),isSealed:"TRUE"===e.Sealed,isGrouped:n.groupByOverride===p||u.group1===p||u.group2===p,isSorted:n.sortField===p,isAscending:n.sortField!==p||"true"===n.isAscending,sortDescFirst:!!t&&!!t.sortDescFirst,isFiltered:v,filterValues:Object(o.getFilterValueByName)(g,p),isRequired:!!e.Required,isAutoHyperLink:t?a.serverSupportsAutoHyperLink:!!e.AutoHyperLink&&a.serverSupportsAutoHyperLink||m===d.e.Note&&"FALSE"!==e.RichText,isAppendOnly:e.AppendOnly&&"TRUE"===e.AppendOnly,choices:e.Choices,dispFormUrl:e.DispFormUrl,allowGridEditing:e.AllowGridEditing,pinnedToFiltersPane:e.PinnedToFiltersPane&&"TRUE"===e.PinnedToFiltersPane,showInFiltersPane:e.ShowInFiltersPane&&c.i[e.ShowInFiltersPane],clientSideComponentId:e.ClientSideComponentId,clientSideComponentProperties:e.ClientSideComponentProperties,customFormatter:e.CustomFormatter,serverFieldType:e.Type,resultType:e.ResultType,isCalculated:"Calculated"===e.role,isNote:m===d.e.Note&&"FALSE"===e.RichText,clientSideColumnAdapter:e.ClientSideColumnAdapter,sspId:e.SspId,termSetId:e.TermSetId,anchorId:e.AnchorId,realFieldName:e.RealFieldName,hasListItemMenu:"TRUE"===e.listItemMenu,linkToItem:!!e.LinkToItem,isLink:"URLwMenu"===e.Name&&n.listTemplateType===s.n.links,richText:e.RichText,renderAsText:"TRUE"===e.RenderAsText};return e.ID&&(S.id=e.ID),t&&(S.minWidth=_?x(a.useCustomColumn):t.minWidth,S.width=_?I(a.useCustomColumn):t.width),m===d.e.SharedWith?S.width=c.e.sharedWith:m===d.e.Note?S.width=c.e.note:m===d.e.AverageRating?S.minWidth=c.e.ratingsMin:m===d.e.DateTime&&(S.getValue=function(e){return function(e,t){var n=void 0;return e&&t&&(n=(n=D(e.key+".FriendlyDisplay",t))?Object(i.e)(n):D(e.key,t)),n}(S,e)}),S}function D(e,t){var n="";return t&&void 0===(n=t[e])&&t.properties&&(void 0===(n=t.properties[e])&&t.recycleBinProperties&&(n=t.recycleBinProperties[e]),n&&Array.isArray(n)&&(n=n.join(", "))),n}function I(e){return e?c.e.bigIcon:c.e.icon}function x(e){return e?c.e.bigIcon:c.e.iconMin}function C(e,t){switch(t){case d.e.Attachments:case d.e.Hyperlink:case d.e.Image:case d.e.Note:case d.e.FileSize:case d.e.FileIcon:return!1;default:var n=g(e);return n!==c.n.name&&n!==c.n.title}}},2376:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(1359);function i(e){var t=e.FieldType;if("Calculated"===t&&(t=e.ResultType),"Computed"===t)switch(e.Name){case"FileSizeDisplay":return a.e.FileSize;case"ImageSize":return a.e.ImageSize;case"SharedWith":return a.e.SharedWith;case"_IsRecord":return a.e.ComplianceRecordFlag;case"ThumbnailOnForm":case"Thumbnail":return a.e.Thumbnail;default:return a.e.Computed}var n=a.e[t];if("number"==typeof n)return n;switch(t){case"UserMulti":return a.e.User;case"URL":return"Hyperlink"===e.Format?a.e.Hyperlink:a.e.Image;case"LookupMulti":return a.e.Lookup;case"MultiChoice":return a.e.Choice;case"TaxonomyFieldType":case"TaxonomyFieldTypeMulti":return a.e.Taxonomy}return a.e.Text}},2398:function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a={Unknown:0,Legacy:1,Classic:2,Modern:3,PowerApp:4,Customized:5},i={Unknown:0,Classic:1,Modern:2,PowerApp:3,Customized:4,MultiColumnsView:5},r={ready:0,saving:1,updating:2},o={Dropdown:0,Radio:1}},2409:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i});var a={editItem:1,newItem:2,displayItem:3};function i(e){switch(e){case a.editItem:return"Edit";case a.newItem:return"New";case a.displayItem:return"Display";default:return"Unknown"}}},2469:function(e,t,n){"use strict";var a,i=n(300),r={ODB:563,ODC:null,Fallback:!1};!function(e){function t(e){return"url"===e||"website"===e}var n;e.isShortcutItem=function(e){return!(!e||!e.extension)&&t("."!==e.extension[0]?e.extension:e.extension.slice(1))},e.isShortcutFileType=t,e.isShortcutEnabled=function(){return i.e.isFeatureEnabled(r)},(n=e.ShortcutErrors||(e.ShortcutErrors={}))[n.UnknownError=0]="UnknownError",n[n.NewFileCreationFileAlreadyExistsError=1]="NewFileCreationFileAlreadyExistsError",n[n.InvalidCharacterError=2]="InvalidCharacterError"}(a||(a={})),t.e=a},2494:function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"t",function(){return u});var a=n(2534),i=n(1211),r=n(829),o=n(3061),s=n(4),c=n(2495);function d(e,t,n,a){for(var i=[],r=0,o=void 0,s=void 0,c=(n=n||t.groupBy)[0],d=n[1],l=0,f=e;l<f.length;l++){var p=f[l];if(c&&"1"===p[c+".newgroup"]){var m=u(t,p,c,0,!0,r,void 0,a);i.push(m),r+=m.count,o=m,s=void 0}d&&"1"===p[d+".newgroup"]&&(s=u(t,p,d,1,!0,s?s.startIndex+s.count:o?o.startIndex:0,o,a))}return{groups:i,totalCount:r}}function l(e,t,n,a,i,r){if((a=a||n.groupBy)&&a.length>0){var o=t&&t.length>0?t[t.length-1]:void 0,s=a[0],c=a[1];if(s&&"1"===e[s+".newgroup"]){var d=u(n,e,s,0,!1,i||(o?o.startIndex+o.count:0),void 0,r);t||(t=[]),t.push(d),o=d}if(c&&"1"===e[c+".newgroup"]){var l=o&&o.children&&o.children.length>0?o.children[o.children.length-1]:void 0;u(n,e,c,1,!1,i||(l?l.startIndex+l.count:o?o.startIndex:0),o,r)}}}function u(e,t,n,d,l,u,p,m){var _,h=e.groupSchema,b=h&&h[n],g=0===d?n+".COUNT.group":n+".COUNT.group2",v=b?b.Type:void 0;b&&"Calculated"===b.FieldType&&(v=b.FieldType);var y=f(t,n,v),S=function(e,t){return e[t+".urlencoded"]}(t,n),D=function(e,t,n,c){var d=void 0,l=!s.t.isActivated("f8d2a10a-c9c1-4297-908c-7bbf23060808","2/22/2021","Use field value for calculated field that is number type to follow decimal setting"),u=!s.t.isActivated("4419770d-92ef-4577-a9aa-4605ac3d1297","11/28/2022","Show user-friendly Approval Status groups");if("string"!=typeof e[t+".groupdisp"]||"DateTime"===n&&!Boolean(e[t+".groupdisp"])){if("FileSizeDisplay"===t&&e.hasOwnProperty("File_x0020_Size"))d=r.e.getDisplayString(Number(e.File_x0020_Size),{language:c,ignoreZero:!0});else if("_IsRecord"===t&&e.hasOwnProperty("_ComplianceFlags")){var p=+e._ComplianceFlags;d=4&p&&1&p?o.t:o.e}else if(u&&t===i.e)d=new i.t(e[t+".singleurlencoded"]).toString();else if(e.hasOwnProperty(t))switch(n){case"User":var m=e[t];m&&m.length>0&&(d=m[0].title);break;case"Lookup":var _=e[t];void 0!==_&&(_.Label&&_.TermID?d=_.Label:Array.isArray(_)&&_.length>0?d=_[0].lookupValue:"string"==typeof _&&(d=_));break;case"WorkflowStatus":d=e[t]?a.e.getWorkflowStatusFromRawHtml(e[t]).display:"";break;case"Calculated":if(l&&e.hasOwnProperty(t+".calculated")&&e[t+".calculated"]&&e[t]&&"float"===e[t+".calculated"].split(";#")[0]){d=e[t];break}case"Boolean":case"ModStat":case"Number":case"Currency":case"Text":case"DateTime":d=e[t]}}else d=e[t+".groupdisp"];return"string"!=typeof d&&(d=f(e,t,n)),d}(t,n,v,m),I=function(e,t,n,a){var i=void 0;switch(a){case"Lookup":var r=e[t];void 0!==r&&(r.Label&&r.TermID?i=r.Label+"|"+r.TermID:r.length>0?i=String(r[0].lookupId):"string"==typeof r&&(i=r));break;case"Boolean":i=e[t+".value"];break;case"User":var o=e[t];if(o&&o.length>0){var s=o[0].email;i=JSON.stringify([{Key:s,IsResolved:!1}])}else"string"==typeof o&&(i=o);break;default:i=n}return i}(t,n,y,v),x={groupingType:"SPListGroup",groupingId:(p?p.groupingId+"-":"")+(y||"(null)"),name:D,groupString:S,fieldSchema:b,fieldValue:I,count:Number(t[g]),isCollapsed:l,startIndex:u,isDropEnabled:b&&"TRUE"!==b.ReadOnly&&void 0!==I,parentKey:p?p.groupingId:void 0,level:p?p.level+1:0};if(!s.t.isActivated("232e6c76-2586-4e75-9883-5a728182ad4e","5/23/2023","add filter params for fetching next nested groups")){var C=function(e,t,n){var a=e.fieldValue;if(e&&e.fieldSchema&&e.fieldSchema.Type){var i=function(t){var i=n||e.level,r=decodeURIComponent(t).split(";#"),o=r[0];r.length>0&&(r=r.slice(1,r.length-1),void 0!==i&&r[i]&&(o=r[i])),o&&(a=o.substring(0,4)+"-"+o.substring(4,6)+"-"+o.substring(6,8))};"Lookup"===e.fieldSchema.Type&&"DateTime"===e.fieldSchema.ResultType&&e.groupString?i(e.groupString):"User"===e.fieldSchema.Type||"Lookup"===e.fieldSchema.Type?a=e.name:"DateTime"===e.fieldSchema.Type&&(t[e.fieldSchema.Name+".groupDate"]?a=t[e.fieldSchema.Name+".groupDate"]:e.groupString&&i(e.groupString))}return a}(x,t,d);x.fieldFilterByValue=C}return(null===(_=e.rawListSchema)||void 0===_?void 0:_.Aggregate)&&!s.t.isActivated("f0a3dee3-6a82-4d90-a75f-c4fc542c6215","11/8/2022","add aggregation data to group")&&(x.columnTotals=function(e,t,n){for(var a,i=void 0===n?"":n>0?".agg2":".agg",r=t.Aggregate,o=Object.getOwnPropertyNames(r),s={},d=function(n){var d={type:Object(c.n)(r[o[n]]),value:e[o[n]+"."+r[o[n]]+i],aggregateFunctionType:r[o[n]],aggregateFieldType:null===(a=t.Field.find(function(e){return e.Name===o[n]}))||void 0===a?void 0:a.FieldType};s[o[n]]=d},l=0;l<o.length;l++)d(l);return s}(t,e.rawListSchema,d)),p&&(p.children||(p.children=[]),p.children.push(x)),x}function f(e,t,n){var a=void 0;if("DateTime"===n)a=(a=e[t]).split(" ")[0];else if("Lookup"===n){var i=e[t];void 0!==i&&(i.Label&&i.TermID?a=i.Label:Array.isArray(i)&&i.length>0?a=i[0].lookupValue:"string"==typeof i&&(a=i))}else if(e.hasOwnProperty(t+".singleurlencoded")&&"Calculated"!==n)a=decodeURIComponent(e[t+".singleurlencoded"]);else if(e.hasOwnProperty(t+".urlencoded")){var r=(a=decodeURIComponent(e[t+".urlencoded"])).split(";#");r.length>=2&&(a=r[r.length-2])}else"FileSizeDisplay"===t&&e.hasOwnProperty("File_x0020_Size")?a=e.File_x0020_Size:"_IsRecord"===t&&e.hasOwnProperty("_ComplianceFlags")&&(a=e._ComplianceFlags);return a}},2495:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"n",function(){return o});var a=n(3010),i={NONE:0,COUNT:1,AVG:2,MAX:3,MIN:4,SUM:5,STDEV:6,VAR:7},r=["NONE","COUNT","AVG","MAX","MIN","SUM","STDEV","VAR"];function o(e){return e=e?e.toUpperCase():e,a[e]||""}},2496:function(e,t,n){"use strict";n.d(t,"i",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"t",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"n",function(){return d});var a=n(4).e.isActivated("3D3E7B22-3495-4C3E-9B4B-DEACF3B98622","08/16/2023","Show name of the image in Image field editor instead of the server-generated one with suffix and prefix");function i(e){if(e){if("string"!=typeof e)return e;var t=void 0;try{t=JSON.parse(e)}catch(e){}if(t&&0!==Object.getOwnPropertyNames(t).length)return t}}var r=/{([^}]*)}/g,o={".accessToken":!0,".spItemUrl":!0};function s(e,t){var n=[];if(e){for(var a=void 0,i=0;a=r.exec(e);){var s=a[1],c=t[s]||"";a.index>i&&n.push(e.substring(i,a.index)),i=r.lastIndex,n.push(o[s]?encodeURIComponent(c):c)}i<e.length&&n.push(e.substring(i,e.length))}return n.join("")}function c(e){var t=e.indexOf("?version=");return t>0?e.substring(0,t):e}function d(e){if(a)return e;try{var t=/Reserved_ImageAttachment_\[[0-9]+\]_\[(.*)\]\[[0-9]+\]_\[(.*)\]\[[0-9]+\]_\[(.*)\]\.(.*)/gm.exec(e);return t&&t[2]?t[2]:e}catch(t){return e}}},2515:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"s",function(){return c}),n.d(t,"a",function(){return d}),n.d(t,"i",function(){return l}),n.d(t,"o",function(){return f}),n.d(t,"r",function(){return p});var a=n(35),i=n(2725),r="_ComplianceTag",o="_ComplianceFlags",s=200;function c(e){return!!(256&e)}function d(e){if(!e.HasRetentionAction)return" ";if(0===e.TagDuration)return e.BlockDelete?i.RetainForeverText:" ";var t=u(e.TagDuration);return e.BlockDelete?a.format(i.PreserveTagText,t):e.AutoDelete?a.format(i.DeleteTagText,t):" "}function l(e){if(e.Notes)return e.Notes;if(!e.HasRetentionAction)return i.NoRetentionTooltip;if(0===e.TagDuration)return e.BlockDelete?i.PreserveForeverTooltip:i.NoRetentionTooltip;var t=u(e.TagDuration),n="",r="";e.BlockDelete?(n="PreserveTag"+e.TagRetentionBasedOn+"Tooltip",e.BlockEdit&&(r=i.PreserveIsRecordTooltipModifier),e.ReviewerEmail?r+=i.ReviewTooltip:r+=e.AutoDelete?i.PreserveAutoDeleteTooltipModifier:i.PreserveNoDeleteTooltipModifier):e.AutoDelete&&(n="DeleteTag"+e.TagRetentionBasedOn+"Tooltip");var o=i[n];return o?a.format(o,t)+r:null}function u(e){var t="";if(e>0){var n=Math.floor(e/365);if(n>0){var r=n>1?i.RetentionPeriodYears:i.RetentionPeriodYear;t=a.format(r,n)}else{var o=Math.floor(e/30);if(o>0){var s=o>1?i.RetentionPeriodMonths:i.RetentionPeriodMonth;t=a.format(s,o)}else{var c=e>1?i.RetentionPeriodDays:i.RetentionPeriodDay;t=a.format(c,e)}}}return t}function f(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"boolean"===t.toLowerCase()&&n&&n.toLowerCase()==="96BE7325-AFA4-48CF-8503-9258F0A7817D".toLowerCase()));var t,n}function p(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"lookup"===t.toLowerCase()&&n&&n.toLowerCase()==="D4B6480A-4BED-4094-9A52-30181EA38F1D".toLowerCase()));var t,n}},2534:function(e,t,n){"use strict";var a;!function(e){e.getItemKey=function(e,t){return t&&t.properties&&(e?t.properties.uniqueId:t.properties.ID)||t&&t.key||void 0},e.getWorkflowStatusFromRawHtml=function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelector("a"),a=n.querySelector("span[value]");return{url:n.href,display:n.innerText,value:a&&a.getAttribute("value")}}}(a||(a={})),t.e=a},2552:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Normal=0]="Normal",e[e.Divider=1]="Divider",e[e.Header=2]="Header",e[e.SelectAll=3]="SelectAll"}(a||(a={}))},2565:function(e,t,n){"use strict";n.d(t,"e",function(){return y});var a,i,r=n(111),o=n(35);!function(e){e[e.remove=0]="remove",e[e.add=1]="add"}(a||(a={})),function(e){e[e.attachment=0]="attachment",e[e.image=1]="image"}(i||(i={}));var s=n(0),c=n(4),d=n(1353),l=n(248),u=c.t.isActivated("e4ab8057-1385-407d-b834-c536273f05d8","06/08/2023","Plumb list url to build attachment base url"),f=function(e){function t(t,n){var a=e.call(this,{},n)||this,i=t.apiUrlHelper,r=t.itemUrlHelper;return a._itemUrlHelper=r,a._apiUrlHelper=i,a._listUrl=t.listUrl,a}return Object(s.__extends)(t,e),t.prototype.getAttachments=function(e,t){var n=this;return this.getData(function(){return n.buildAttachmentBaseUrl(e,t).toString()},function(e){var t=JSON.parse(e);if(t&&t.d&&t.d.resultes&&0===t.d.results.length)return[];var a=t.d.results;return n.transformAttachmentData(a)},"Attachments")},t.prototype.addAttachment=function(e,t,n){var a=this;return new r.n(function(i,r){var o=new FileReader;o.onload=function(s){var c=o.result;a.doUploadAttachment(e,t,n.name,c).then(i,r)},o.readAsArrayBuffer(n)},function(){})},t.prototype.deleteAttachment=function(e,t,n,a){var i=this;return new r.n(function(r,o){i.doDeleteAttachment(e,t,n,a||!1).then(r,o)},function(){})},t.prototype.getDataSourceName=function(){return"AttachmentDataSource"},t.prototype.addImage=function(e,t,n,a,i,o,s){var c=this;return new r.n(function(r,d){var l=new FileReader;l.onload=function(u){var f=l.result;c.doUploadImage(t,a,i,s.name,f,n,e,o).then(r,d)},l.readAsArrayBuffer(s)},function(){})},t.prototype.attachImage=function(e,t,n){var a=this;return new r.n(function(i,r){var o=new FileReader;o.onload=function(s){var c=o.result;a.doUpdateImage(e,t,n.name,c).then(i,r)},o.readAsArrayBuffer(n)},function(){})},t.prototype.deleteImage=function(e,t,n){var a=this;return new r.n(function(i,r){a.doUpdateImage(e,t,n).then(i,r)},function(){})},t.prototype.doUpdateImage=function(e,t,n,a){var i=this._itemUrlHelper.getUrlParts(),r=this._apiUrlHelper.build().webByItemUrl(i).method("GetList",i.serverRelativeListUrl).method("Items",e).methodWithAliases("AddThumbnailFieldData",{imageName:n,fieldInternalName:t});return this.dataRequestor.getData({url:r.toString(),parseResponse:function(e){var t=JSON.parse(e);return t.d&&void 0!==t.d.AddThumbnailFieldData},qosName:"AddThumbnailFieldData",noRedirect:!0,additionalPostData:a||void 0})},t.prototype.buildAttachmentBaseUrl=function(e,t,n){if(u){var a=this._itemUrlHelper.getItemUrlParts(t);return r=this._apiUrlHelper.build().webByItemUrl(a).method("GetList",a.serverRelativeListUrl).method("Items",e),n?r.method("AttachmentFiles",n):r.segment("AttachmentFiles")}var i=this._listUrl||this._itemUrlHelper.getUrlParts().serverRelativeListUrl,r=this._apiUrlHelper.build().segment("web").method("GetList",i).method("Items",e);return n?r.method("AttachmentFiles",n):r.segment("AttachmentFiles")},t.prototype.transformAttachmentData=function(e){var t=this;return e.map(function(e){return{type:"attachment",fileName:e.FileName,serverRelativeUrl:Object(l.s)(t._pageContext)+e.ServerRelativeUrl,uploaded:!0}})},t.prototype.doUploadAttachment=function(e,t,n,a){var i=this;return this.dataRequestor.getData({url:this.buildAttachmentBaseUrl(e,t).methodWithAliases("addUsingPath",{decodedUrl:n}).toString(),parseResponse:function(e){var t=JSON.parse(e);if(!t.d)return null;var n=[t.d],a=i.transformAttachmentData(n);return a&&1===a.length?a[0]:null},qosName:"UploadAttachment",additionalPostData:a,noRedirect:!0})},t.prototype.doDeleteAttachment=function(e,t,n,a){var i=this;return this.getData(function(){return i.buildAttachmentBaseUrl(e,t,n).segment(a?"DeleteObject":"RecycleObject").toString()},function(e){try{var t=JSON.parse(e);return a&&void 0!==t.d.DeleteObject||!a&&void 0!==t.d.RecycleObject}catch(e){return!1}},a?"DeleteAttachment":"RecycleAttachment")},t.prototype.doUploadImage=function(e,t,n,a,i,r,o,s){var d=this,l=this._itemUrlHelper.getItemUrlParts(e),u=this._apiUrlHelper.build().webByItemUrl(l).methodWithAliases("UploadImage",{listTitle:t,imageName:a,listId:r,itemId:o,fieldId:s});return c.t.isActivated("dd617e52-55d0-40bc-9e0f-ffd875d6a25c","11/10/2021","pipe through filed id to UploadImage call")&&(u=this._apiUrlHelper.build().webByItemUrl(l).methodWithAliases("UploadImage",{listTitle:t,imageName:a,listId:r,itemId:o})),this.dataRequestor.getData({url:u.toString(),parseResponse:function(e){var t=JSON.parse(e);if(!t.d||!t.d.UploadImage)return null;var a=t.d.UploadImage;return d.transformImageData(a,n,s)||null},qosName:"UploadImage",additionalPostData:i,noRedirect:!0})},t.prototype.transformImageData=function(e,t,n){return{type:"thumbnail",fileName:e.Name,serverRelativeUrl:e.ServerRelativeUrl,id:e.UniqueId,fieldName:t,serverUrl:Object(l.s)(this._pageContext),fieldId:n}},t}(d.e),p=n(497),m=n(182),_=n(3227),h=n(92),b=n(145),g=n(222),v={ODB:1770},y=function(){function e(e){this.listTitle=e.pageContext.listTitle,this.listId=b.e.normalizeLower(e.pageContext.listId,!1);var t=new m.e({},{pageContext:e.pageContext}),n=new p.e({},{itemUrlHelper:t,pageContext:e.pageContext}),a={pageContext:e.pageContext};this.dataSource=new f({apiUrlHelper:n,itemUrlHelper:t,listUrl:e.listUrl},a),this.isImageColumnUsingAttachmentsInListEnabled=g.a.isFeatureEnabled(v),this.imageOperationsPool=[],this.attachmentOperationsPool=[]}return e.prototype.createAddAttachmentOperation=function(e,t,n){var r={type:a.add,listItemId:e,listItemKey:t,fileType:i.attachment,fileName:n.name,file:n};this.handleNewOperation(r,this.attachmentOperationsPool)},e.prototype.createDeleteAttachmentOperation=function(e,t,n){var r={type:a.remove,listItemId:e,listItemKey:t,fileType:i.attachment,fileName:n};this.handleNewOperation(r,this.attachmentOperationsPool)},e.prototype.createAddImageOperation=function(e,t,n,r,o){var s={type:a.add,listItemId:e,listItemKey:t,fileType:i.image,fileName:n.name,file:n,fieldName:r,fieldId:o};this.handleNewOperation(s,this.imageOperationsPool)},e.prototype.createDeleteImageOperation=function(e,t,n,r){var o={type:a.remove,listItemId:e,listItemKey:t,fileType:i.image,fileName:n,fieldName:r};this.handleNewOperation(o,this.imageOperationsPool)},e.prototype.createAddListImageOperation=function(e){var t={type:a.add,fileType:i.image,fileName:e.name,file:e,listItemId:0,useSiteAssets:!0};this.handleNewOperation(t,this.imageOperationsPool)},e.prototype.createDeleteListImageOperation=function(e){var t={type:a.remove,fileType:i.image,fileName:e,listItemId:0,useSiteAssets:!0};this.handleNewOperation(t,this.imageOperationsPool)},e.prototype.executeImageOperationsOnSingleItem=function(e,t,n){var a=this.imageOperationsPool.slice();return this.clearImageOperations(e||0,t,n),this.executeAllOperationsCore(a,e,t)},e.prototype.executeImageOperationsOnMultipleItems=function(e){var t=this;if(0===e.length)return r.n.resolve([]);var n=[];return e.forEach(function(e){n.push(t.executeImageOperationsOnSingleItem(e,void 0,!1))}),r.n.all(n).then(function(e){var t=[];return e.forEach(function(e){e.forEach(function(e){t.push(e)})}),t})},e.prototype.executeAttachmentOperations=function(e){return this.executeAllOperationsCore(this.attachmentOperationsPool,e,void 0)},e.prototype.hasPendingImageOperations=function(){return this.imageOperationsPool.length>0},e.prototype.hasPendingAttachmentOperations=function(){return this.attachmentOperationsPool.length>0},e.prototype.clearAttachmentOperations=function(){this.attachmentOperationsPool=[]},e.prototype.executeAllOperationsCore=function(e,t,n){var i=this,o=e;return n&&(o=e.filter(function(e){return e.fieldName===n})),new r.n(function(e,r){if(o.length>0){var s=o[0],c=o.slice(1),d=void 0;s.type===a.add?(void 0===t||s.listItemId||(s.listItemId=t),d=i.processUpload(s.listItemId,s.listItemKey,s.file,s.fileType,s.fieldName,s.fieldId,s.useSiteAssets)):d=i.processDelete(s.listItemId,s.listItemKey,s.fileName,s.fileType,s.fieldName,s.fieldId,s.useSiteAssets);var l=function(a){i.executeAllOperationsCore(c,t,n).done(function(t){return e([a].concat(t))},r)};d.done(l,l),h.e.logData({name:"ClientFormUpdate.attachments"})}else e([])})},e.prototype.processUpload=function(e,t,n,a,r,s,c){return a===i.image?this.isImageColumnUsingAttachmentsInListEnabled&&!c?this.dataSource.attachImage(e,r,n).then(function(e){return{result:e,attachment:null,image:{type:"thumbnail",fieldName:r,fileName:n.name},errorMsg:e?null:o.format(_.n,n.name)+"."}},function(e){var t=o.format(_.n,n.name);throw e&&(e.code&&e.code.indexOf("InvalidDataException")>=0?t=_.a:e.message&&e.message.value&&(t+=" : "+e.message.value)),{result:!1,attachment:null,image:{type:"thumbnail",fieldName:r,fileName:n.name},errorMsg:t}}):this.dataSource.addImage(e,t,this.listId,this.listTitle,r,s,n).then(function(e){return{result:!0,attachment:null,image:e,errorMsg:e?null:o.format(_.n,n.name)+"."}},function(e){var t=o.format(_.n,n.name);throw e&&(e.code&&e.code.indexOf("InvalidDataException")>=0?t=_.a:e.message&&e.message.value&&(t+=" : "+e.message.value)),{result:!1,attachment:null,image:{type:"thumbnail",fieldName:r,fileName:n.name,serverUrl:null,fieldId:s},errorMsg:t}}):this.dataSource.addAttachment(e,t,n).then(function(e){return{result:!0,attachment:e,errorMsg:e?null:o.format(_.t,n.name)+"."}},function(e){throw{result:!1,attachment:{type:"attachment",uploaded:!1,fileName:n.name},errorMsg:o.format(_.t,n.name)+(e&&e.message&&e.message.value?" : "+e.message.value:"")}})},e.prototype.processDelete=function(e,t,n,a,s,c,d){var l;if(a===i.image){if(!this.isImageColumnUsingAttachmentsInListEnabled||d)return r.n.wrap({result:!0,image:{type:"thumbnail",fieldName:s,fileName:n,serverRelativeUrl:null,serverUrl:null,fieldId:c},errorMsg:null});l=this.dataSource.deleteImage(e,s,n).then(function(e){return{result:e,errorMsg:e?null:o.format(_.n,n)+"."}},function(e){throw{result:!1,errorMsg:o.format(_.n,n)}})}else l=this.dataSource.deleteAttachment(e,t,n).then(function(e){return{result:e,errorMsg:e?null:o.format(_.e,n)+"."}},function(e){throw{result:!1,errorMsg:o.format(_.e,n)+(e&&e.message&&e.message.value?" : "+e.message.value:"")}});return l},e.prototype.handleNewOperation=function(e,t){var n=e.type,i=this.findDuplicateOperation(e,t);n===a.add?i<0&&t.push(e):i<0?t.push(e):t.splice(i,1)},e.prototype.findDuplicateOperation=function(e,t){var n=e.fileType,r=-1;return t.some(function(t,o){var s=!1;if((isNaN(t.listItemId)&&isNaN(e.listItemId)||t.listItemId===e.listItemId)&&(s=!0),t.type===a.add&&s&&t.fileName===e.fileName&&(n!==i.image||t.fieldName===e.fieldName))return r=o,!0}),r},e.prototype.clearImageOperations=function(e,t,n){if(this.imageOperationsPool.length>0)if(n||!e)this.imageOperationsPool=[];else{var a=this.imageOperationsPool.filter(function(n){return Number(n.listItemId)!==e||!!t&&n.fieldName!==t});this.imageOperationsPool=a}},e}()},2569:function(e,t,n){"use strict";var a=n(2610);t.e=a.e},2581:function(e,t,n){"use strict";var a,i;n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),function(e){e[e.fail=0]="fail",e[e.partialSuccess=1]="partialSuccess",e[e.success=2]="success"}(a||(a={})),function(e){e[e.pending=0]="pending",e[e.success=1]="success"}(i||(i={}))},2602:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(231),i=n(204);function r(e,t){var n=Object(a.e)(e).id;return t&&t.urlParts&&(n===t.urlParts.fullListUrl||n===t.urlParts.serverRelativeListUrl)&&(n=void 0),n}function o(e,t){var n=e;return 0!==n.indexOf("id")&&(n=Object(i.e)({id:e,listurl:t})),n}},2610:function(e,t,n){"use strict";var a=n(0),i=n(2239),r=n(186),o=n(949),s=n(45),c=n(960),d=function(e){function t(t,n){var a=e.call(this,void 0,n)||this;a._pageContext=t||a.resources.consume(s.e);var i=null==n?void 0:n.dataRequestNoRedirect,r=null==n?void 0:n.dataRequestorType;return a._makeDataRequestor=r?function(e){return new r(e)}:function(e){return new o.e(e,{pageContext:a._pageContext,noRedirect:i})},a.dataRequestor=a._makeDataRequestor({qosName:a.getDataSourceName()}),a}return Object(a.__extends)(t,e),t.prototype.getDataSourceName=function(){return"DataSource"},t.prototype.updateContext=function(e){r.e(this._pageContext,e),this.dataRequestor=this._makeDataRequestor({qosName:this.getDataSourceName()})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{dataRequestorType:o.n,dataRequestNoRedirect:c.e.optional}),t}(i.n);t.e=d},2634:function(e,t,n){"use strict";n.r(t),n.d(t,"SensitivityLabelsDataSource",function(){return u});var a=n(0),i=n(1208),r=n(4),o=n(541),s=n(583),c=n(111),d=r.e.isActivated("8a599b0b-8859-422a-aa10-ca6a49ce77eb","04/04/2022","Switch to newer sensitivity label api path"),l=r.e.isActivated("3d8830f8-713c-444f-9c9f-1db6c603995a","04/06/2023","Throw an error when no auth is provided and not return an empty array");t.default=u;var u=function(){function e(e,t){var n=t.pageContext,a=t.graphDataRequestor;this._pageContext=n,this._graphDataRequestor=a||new i.e({},{}),this._getOAuthToken=e.getOAuthToken,this._getOAuthToken2=t.getOAuthToken,this._cache=new o.e({id:"SensitivityLabelsDataSource"},{pageContext:n})}return e.prototype.getSensitivityLabels=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e=this;return Object(a.__generator)(this,function(t){return[2,this._cache.getDataUtilizingCache({cachingStrategy:s.e.useCacheAndUpdateInTheBackground,cacheRequestKey:"SensitivityLabelsDataSource",getData:function(){return e._getSensitivityLabels()}}).catch(function(){return null})]})})},e.prototype.getDocLibSensitivityLabelsCached=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e=this;return Object(a.__generator)(this,function(t){return[2,this._cache.getDataUtilizingCache({cachingStrategy:s.e.useCacheAndUpdateInTheBackground,cacheRequestKey:"SensitivityLabelsDataSourceDocLib",getData:function(){return e.getDocLibSensitivityLabels()}}).catch(function(){return null})]})})},e.prototype.getDocLibSensitivityLabels=function(){return Object(a.__awaiter)(this,void 0,c.n,function(){var e,t,n,i,r=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return!l||this._getOAuthToken||this._getOAuthToken2?(e="".concat(this._pageContext.msGraphEndpointUrl),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],e)]:[3,2]):[2,c.n.resolve([])];case 1:return n=a.sent(),[3,4];case 2:return[4,this._getOAuthToken2(e)];case 3:n=a.sent(),a.label=4;case 4:return t=n,this._sensitivityLabels?(i=this._sensitivityLabels,[3,7]):[3,5];case 5:return[4,this._graphDataRequestor.send({endpoint:e,path:"".concat(e,"/beta/me/informationprotection/sensitivityLabels"),apiName:"GraphDataProvider.getSensitivityLabels",accessToken:{accessToken:t},requestType:"GET",useAuthorizationHeaders:!0,qosExtraData:{host:"Document libraries"},parseResponse:function(e){var t=JSON.parse(e.responseText).value;return r._sensitivityLabels=t,t}})];case 6:i=a.sent(),a.label=7;case 7:return[2,i]}})})},e.prototype.setSensitivityLabel=function(e,t,n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,s,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return r={id:n,assignmentMethod:"Privileged",justificationText:i||"",actionSource:"Manual"},this._getOAuthToken||this._getOAuthToken2?(o="".concat(this._pageContext.msGraphEndpointUrl),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],o)]:[3,2]):[2,Promise.resolve("")];case 1:return c=a.sent(),[3,4];case 2:return[4,this._getOAuthToken2(o)];case 3:c=a.sent(),a.label=4;case 4:return s=c,[4,this._graphDataRequestor.send({endpoint:o,path:"".concat(o,"/beta/drives/").concat(e,"/items/").concat(t,"/setSensitivityLabel"),apiName:"GraphDataProvider.setSensitivityLabel",postData:JSON.stringify(r),accessToken:{accessToken:s},requestType:"POST",useAuthorizationHeaders:!0,qosExtraData:{host:"Document libraries"},parseResponse:function(e){return null==e?void 0:e.responseText}})];case 5:return[2,a.sent()]}})})},e.prototype._getSensitivityLabels=function(){return Object(a.__awaiter)(this,void 0,c.n,function(){var e,t,n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return this._getOAuthToken||this._getOAuthToken2?(e="".concat(this._pageContext.msGraphEndpointUrl),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],e)]:[3,2]):[2,c.n.resolve([])];case 1:return n=a.sent(),[3,4];case 2:return[4,this._getOAuthToken2(e)];case 3:n=a.sent(),a.label=4;case 4:return(t=n)?[4,this._graphDataRequestor.send({endpoint:e,path:"".concat(e,d?"/beta/me/informationprotection/policy/labels":"/beta/me/security/informationProtection/sensitivityLabels"),apiName:"GraphDataProvider.getSensitivityLabels",accessToken:{accessToken:t},requestType:"GET",useAuthorizationHeaders:!0,parseResponse:function(e){return JSON.parse(e.responseText).value.filter(function(e){return!0===e.isActive}).sort(function(e,t){return e.sensitivity>t.sensitivity?1:-1})}})]:[2,c.n.resolve([])];case 5:return[2,a.sent()]}})})},e}()},2659:function(e,t,n){"use strict";n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a=n(183),i=n(51);function r(e){return e}function o(e){return e}function s(e,t){return e&&e.extension&&!!e.openUrl&&!t.isRecycleBin(e.queryType)&&e.itemStatus!==a.t.ConditionalAccessViewOnly&&e.itemStatus!==a.t.ConditionalAccessBlocked&&i.e.hasItemPermission(e,i.e.openItems)}},2687:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(2837),i="f9ebc8b2-a976-48f0-a8fa-0846164c0466",r="MissingInfoFilesThatNeedAttention";a.n},2756:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(0),i=n(1353),r=n(118),o=n(1359),s=n(182),c=n(497),d=n(602),l=n(2602),u=n(2687),f=n(4).t.isActivated("29873e89-d94c-4bb0-8f5b-dfd437f6422c","6/19/2021","Look for filters within the folder structure for doclib by using GetListUsingPath API"),p=function(e){function t(t){var n=e.call(this,{},{pageContext:t.pageContext})||this;return n._listContext=t.listContext,n._itemUrlHelper=t.itemUrlHelper||new s.e({},{pageContext:t.pageContext}),n._apiUrlHelper=t.apiUrlHelper||new c.e({},{pageContext:t.pageContext,itemUrlHelper:n._itemUrlHelper}),n._folderPath=t.folderPath,void 0===n._folderPath&&(n._folderPath=Object(l.t)(t.parentKey,n._listContext)),n}return Object(a.__extends)(t,e),t.prototype.getFilterData=function(e,t,n,a){var i=this;return this.getData(function(){return i._getFilterDataUrl(e,t,n,a)},function(e){return e},"GetFilterData")},t.prototype._getFilterDataUrl=function(e,t,n,a){var i,s,c=this._itemUrlHelper.getUrlParts({path:this._listContext.listUrl,listUrl:this._listContext.listUrl});s=f?this._apiUrlHelper.build().webByItemUrl(c).method("GetList",c.serverRelativeListUrl).segment("RenderListFilterData").parameter("FieldInternalName",e):this._apiUrlHelper.build().webByItemUrl(c).methodWithAliases("GetListUsingPath",{DecodedUrl:c.serverRelativeListUrl}).segment("RenderListFilterData").parameter("FieldInternalName",e),n&&n!==u.t&&(s=s.parameter("ViewId",n)),this._folderPath&&(s=s.parameter("RootFolder",{raw:r.e.encodeURIComponent(this._folderPath)})),a&&a===o.e.Taxonomy&&(s=s.parameter("ExcludeFieldFilteringHtml",!0));var l=Object(d.getFilterParams)(t,!0,{replaceMeFormatFilterWithCurrentUser:!0,currentUserDisplayName:null===(i=this._pageContext)||void 0===i?void 0:i.userDisplayName});return(s=s.rawParameter(l)).toString()},t}(i.t);t.t=p},2817:function(e,t,n){"use strict";var a=n(2552),i=n(3316),r={id:"none",key:"none",text:i.e,title:i.e},o=function(){function e(){}return e.processSensitivityLabelsForDropdownOption=function(e){var t={};e.forEach(function(e){var n,a,i=e.name,r=null===(n=null==e?void 0:e.parent)||void 0===n?void 0:n.name;r?t[r]?null===(a=t[r])||void 0===a||a.push({name:i,id:e.id,isParent:!1,tooltip:e.tooltip}):(t[r]=[{name:r,id:"".concat(e.id,"isParent"),isParent:!0,tooltip:e.tooltip}],t[r].push({name:i,id:e.id,isParent:!1,tooltip:e.tooltip})):t[i]=[{name:i,id:e.id,isParent:!1,tooltip:e.tooltip}]});var n=[];return t&&Object.keys(t).length>0&&Object.keys(t).forEach(function(e){var i=t[e];if((null==i?void 0:i.length)>1){var r=i[0];i.forEach(function(e){var t=e.isParent?a.e.Header:a.e.Normal,i=e.isParent?e.name:"".concat(r.name," \\ ").concat(e.name);n.push({id:e.id,key:e.id,text:i,title:e.tooltip,data:{text:e.name,isParent:e.isParent},itemType:t})}),n.push({key:"divider_2",text:"-",itemType:a.e.Divider})}else n.push({id:i[0].id,key:i[0].id,text:i[0].name,title:i[0].tooltip,data:{text:i[0].name}})}),n},e.processSensLabelsForDropdownOptionDocLib=function(e){var t=[];return t.push(r),e.forEach(function(e){var n,a=e.displayName;if(0===e.sublabels.length){if(c(e.labelActions)){var i=s(e.id,null===(n=e.priority)||void 0===n?void 0:n.toString(),a,e.toolTip);t.push(i)}}else e.sublabels.forEach(function(e){var n;if(c(e.labelActions)){var i="".concat(a," \\ ").concat(e.displayName),r=s(e.id,null===(n=e.priority)||void 0===n?void 0:n.toString(),i,e.toolTip);t.push(r)}})}),t},e.processLabelsForItem=function(e){var t=[];return t.push(r),e.forEach(function(e){var n,a=e.displayName;if(0===e.sublabels.length){var i=c(e.labelActions),r=e.tooltip||e.toolTip;if(i){var o=s(e.id,null===(n=e.priority)||void 0===n?void 0:n.toString(),a,r);t.push(o)}}else e.sublabels.forEach(function(e){var n,i=c(e.labelActions),r=e.tooltip||e.toolTip;if(i){var o="".concat(a," \\ ").concat(e.displayName),d=s(e.id,null===(n=e.priority)||void 0===n?void 0:n.toString(),o,r);t.push(d)}})}),t},e}();function s(e,t,n,a){return{id:e,key:t,text:n,title:a}}function c(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if("userDefinedRights"===e[t].encryptWith)return!1;return!0}t.e=o},2841:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={richClient:0,browser:1}},2855:function(e,t,n){"use strict";var a=n(0),i=n(111),r=n(1311),o=n(1353),s=n(2515),c=n(2725),d=function(e){function t(t,n){var a=e.call(this,{},n)||this,i=t.apiUrlHelper,r=t.itemUrlHelper;return a._apiUrlHelper=i,a._itemUrlHelper=r,a}return Object(a.__extends)(t,e),t.prototype.isAdvancedRecordVersioningDisabled=function(){return this.dataRequestor.getData({url:this._buildRecordVersioningUrl(),qosName:"GetAdvancedRecordVersioningDisabled",method:"GET"}).then(function(e){return!!(e&&e.d&&e.d.GetAdvancedRecordVersioningDisabled)&&e.d.GetAdvancedRecordVersioningDisabled},function(e){return i.n.wrapError(e)})},t.prototype.getAvailableTagsForSite=function(){var e=this;return this.dataRequestor.getData({url:this._buildComplianceTagsListUrl(),qosName:"GetAvailableTagsForSite",method:"GET",noRedirect:!0}).then(function(t){return e._transformToComplianceTags(t.d.GetAvailableTagsForSite.results)},function(e){return i.n.wrapError(c.GetAvailableTagsForSiteFailed)})},t.prototype.updateComplianceTagInBatch=function(e,t,n){if(!e||0===e.length)return r.e.logData({name:"ComplianceTagDataSource.EmptyItemIds",message:"Empty item IDs selected for list: "+n}),i.n.wrap([]);var a=JSON.stringify({itemIds:e,listUrl:n,complianceTagValue:t.tagValue,blockDelete:t.blockDelete,blockEdit:t.blockEdit});return this.dataRequestor.getData({url:this._buildApplyLabelOnBulkItemsUrl(),qosName:"ApplyLabelOnBulkItems",additionalPostData:a,method:"POST"}).then(function(e){return e&&e.d&&e.d.ApplyLabelOnBulkItems&&e.d.ApplyLabelOnBulkItems.results?e.d.ApplyLabelOnBulkItems.results:[]},function(e){return i.n.wrapError(e)})},t.prototype.updateComplianceTag=function(e,t){var n="SetComplianceTag",a=t.blockEdit||t.blockDelete,r=t.blockEdit,o=t.isEventTag,s=JSON.stringify({complianceTag:t.tagValue,isTagPolicyHold:a,isTagPolicyRecord:r,isEventBasedTag:o,isTagSuperLock:t.superLock,isUnlockedAsDefault:t.unlockedAsDefault});return this.dataRequestor.getData({url:this._buildUpdateHashtagsUrl(e,n),qosName:n,additionalPostData:s,method:"POST",noRedirect:!0}).then(function(){return t.tagName},function(e){return i.n.wrapError(e)})},t.prototype.unlockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this.dataRequestor.getData({url:this._buildUnlockRecordUrl(),qosName:"UnlockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.UnlockRecordItem&&e.d.UnlockRecordItem.results){var t=e.d.UnlockRecordItem.results;return s.s(t)}return!1},function(e){return i.n.wrapError(e)})},t.prototype.lockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this.dataRequestor.getData({url:this._buildLockRecordUrl(),qosName:"LockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.LockRecordItem&&e.d.LockRecordItem.results){var t=e.d.LockRecordItem.results;return s.s(t)}return!1},function(e){return i.n.wrapError(e)})},t.prototype._buildRecordVersioningUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAdvancedRecordVersioningDisabled",{}).toString()},t.prototype._buildComplianceTagsListUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAvailableTagsForSite",{siteUrl:this._pageContext.webAbsoluteUrl}).toString()},t.prototype._buildUpdateHashtagsUrl=function(e,t){var n=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(n).method("GetList",n.serverRelativeListUrl).method("items",e.properties.ID).method(t).toString()},t.prototype._transformToComplianceTags=function(e){var t=[],n={tagName:c.NoneComplianceTagName,tagValue:"",blockDelete:!1,blockEdit:!1,tagDescription:c.NoneComplianceTagDescription,tagTooltip:c.NoneComplianceTagDescription,hasRetentionAction:!1,autoDelete:!1,isEventTag:!1,reviewerEmail:"",notes:"",displayName:"",superLock:!1,tagId:"",unlockedAsDefault:!1};t.push(n);for(var a=0,i=e;a<i.length;a++){var r=i[a],o=s.a(r),d=s.i(r),l={tagName:r.TagName,tagValue:r.TagName,blockDelete:r.BlockDelete,blockEdit:!!r.BlockEdit,tagDescription:o,tagTooltip:d,hasRetentionAction:r.HasRetentionAction,autoDelete:r.AutoDelete,isEventTag:r.IsEventTag,reviewerEmail:r.ReviewerEmail,notes:r.Notes,displayName:r.DisplayName,superLock:r.SuperLock,tagId:r.TagId,unlockedAsDefault:r.UnlockedAsDefault};t.push(l)}return t},t.prototype._buildApplyLabelOnBulkItemsUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.ApplyLabelOnBulkItems").toString()},t.prototype._buildUnlockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.UnlockRecordItem").toString()},t.prototype._buildLockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.LockRecordItem").toString()},t}(o.e),l=n(497),u=n(182),f=function(){function e(e){var t=new u.e({},{pageContext:e.pageContext}),n=new l.e({},{itemUrlHelper:t,pageContext:e.pageContext}),a={pageContext:e.pageContext};this._dataSource=new d({apiUrlHelper:n,itemUrlHelper:t},a)}return e.prototype.isAdvancedRecordVersioningDisabled=function(){return this._dataSource.isAdvancedRecordVersioningDisabled()},e.prototype.getAvailableTagsForSite=function(){return this._cachedTagsPromise||(this._cachedTagsPromise=this._dataSource.getAvailableTagsForSite()),this._cachedTagsPromise},e.prototype.updateComplianceTag=function(e,t){return this._dataSource.updateComplianceTag(e,t)},e.prototype.updateComplianceTagInBatch=function(e,t,n){return this._dataSource.updateComplianceTagInBatch(e,t,n)},e.prototype.unlockRecord=function(e,t){return this._dataSource.unlockRecord(e,t)},e.prototype.lockRecord=function(e,t){return this._dataSource.lockRecord(e,t)},e.prototype.hasComplianceTags=function(){return this.getAvailableTagsForSite().then(function(e){return!!(e&&e.length>1)})},e}();t.e=f},2863:function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a=n(111),i=n(154),r=n(222),o=n(260),s=n(2398),c=n(2906),d=n(2581),l=n(2409),u=n(2565),f=n(4),p="Folder",m={ODB:60087,ODC:!1,OneDrive:!1,Fallback:!1},_=f.t.isActivated("1af89de3-0c7d-4708-a865-e33f368ec32c","06/08/2023","plumb ListContext to ClientFormDataSource as dependency"),h=f.t.isActivated("37372d4f-59e8-4089-a035-603685b1fb7d","8/18/2023","updateListContextForFileUploaderProvider"),b=function(){function e(e,t){var n=this;this._buffer=[],this._bufferSize=5,this._init=function(e,t){var a,i;t&&t.pageContext?(n._pageContext=t.pageContext,n._listContext=t.listContext,a=t.apiUrlHelper,i=t.itemUrlHelper):(n._pageContext=e.pageContext,n._listContext=e.listContext,a=e.apiUrlHelper,i=e.itemUrlHelper,n._defaultValueOverride=e.defaultValueOverride||{});var o={isFeatureEnabled:e.isFeatureEnabled,fileUploaderProvider:e.fileUploaderProvider,complianceTagProvider:e.complianceTagProvider,getSharedLockId:e.getSharedLockId},s={pageContext:n._pageContext,apiUrlHelper:a,itemUrlHelper:i,getGraphAuthToken:null==e?void 0:e.getGraphAuthToken,listContext:n._listContext};n._clientFormDataSource?n._clientFormDataSource.updateContext(o,s):n._clientFormDataSource=new c.t(o,s),_&&(n._clientFormDataSource.listContext=n._listContext),n.isFeatureEnabled=e.isFeatureEnabled?e.isFeatureEnabled:function(e){return r.a.isFeatureEnabled(e,n._pageContext&&n._pageContext.ExpFeatures)}},this._getStoredClientFormId=function(e,t,n){return e+"|"+t+"|"+n},this._getClientFormData=function(e){if(e.status===d.t.pending){var t=new o.e;return e.onFinish=function(n){n=e.status||n,t.complete(e.clientForm)},t.getPromise()}return a.n.resolve(e.clientForm)},this._init(e,t)}return e.prototype.updateContext=function(e,t){this._init(e,t)},e.prototype.getClientForm=function(e,t,n){var r,o,s=this;void 0===t&&(t=!1),void 0===n&&(n=!1),t&&(this._listContext.refreshClientForm=!0);var u,f,_=e.itemId,h=e.item;if(!_&&h){var b=this._getBufferKeyFromItem(h,e.contentType);if(u=e.isBulkEdit?void 0:this._getClientFormFromBuffer(b),h.type!==i.t.Folder||e.contentType||(e.contentType=p),u){if(h.hasClientFormData)return u.item=e.item,a.n.wrap(u);this._deleteClientFormFromBuffer(b)}}var g=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var v={},y=0,S=e.selection;y<S.length;y++){var D=S[y];if(D){var I=D.properties;if(I){var x=(w=D.type!==i.t.Folder||I.ContentType?I.ContentType:p)+(C=I.ContentTypeId);v[x]||(g.push({contentType:w,contentTypeId:C}),v[x]=!0)}}}else g.push({contentType:e.contentType,contentTypeId:e.contentTypeId});if(_){var C,O=e.isBulkEdit,w=e.contentType,E=e.clientFormType,A=(C=e.contentTypeId)&&0===C.lastIndexOf(c.e.folder,0),L="Media.Meeting"===(null===(o=null===(r=null==e?void 0:e.item)||void 0===r?void 0:r.properties)||void 0===o?void 0:o.ProgId)&&n&&!O&&!A;if(this.isFeatureEnabled(m)&&L){var k=this._getStoredClientFormId(_,w,O),M=this._getStoredClientForm(k);return M&&void 0!==M.status?this._getClientFormData(M).then(function(e){return s._deleteClientFormFromStoredClientForm(k),e}):(this._completeStoredClientForm(M,d.t.pending),this._clientFormDataSource.getClientForm(_,E,g,O).then(function(e){return s._completeStoredClientForm(M,d.t.success,e),e}))}return this._clientFormDataSource.getClientForm(_,e.clientFormType,g,e.isBulkEdit)}return this._clientFormDataSource.getClientFormSchema(e.clientFormType,g).then(function(t){if(e.item&&!e.item.properties.ContentTypeId&&(e.item.properties.ContentTypeId=t.contentTypeId,e.item.properties.ContentType=t.contentType),f={item:e.item,formType:t.formType,contentType:t.contentType,contentTypeId:t.contentTypeId,fields:[],clientFormCustomFormatter:t.clientFormCustomFormatter,isBulkEdit:e.isBulkEdit},s._generateFieldsFromSchema(f,t),e.clientFormType!==l.e.newItem)return s.updateFormValues(f)}).then(function(){return s._addClientFormToBuffer(f),a.n.wrap(f)})},e.prototype.updateFormValues=function(e,t){return this._clientFormDataSource.updateFormValues(e,t)},e.prototype.updateItem=function(t){return t.clientForm.isBulkEdit&&t.itemdIds&&(this._buffer=[],e._clientFormStore=[]),this._clientFormDataSource.updateItem(t)},e.prototype.saveCustomShowHideRules=function(e,t,n){return this._clientFormDataSource.saveCustomShowHideRules(e,t,n)},e.prototype.saveClientFormCustomFormatter=function(e,t){return this._clientFormDataSource.saveClientFormCustomFormatter(e,t)},e.prototype.getClientFormCustomFormatter=function(e,t){return this._clientFormDataSource.getClientFormCustomFormatter(e,t)},e.prototype.createItem=function(e){return this._clientFormDataSource.createItem(e)},e.prototype.getFieldFilterData=function(e,t,n){return this._clientFormDataSource.getFieldFilterData(e,t,n)},e.prototype.getClientFormSchema=function(e,t,n){return this._clientFormDataSource.getClientFormSchema(e,[{contentType:t,contentTypeId:n}])},e.prototype.updatePanelViewInfo=function(e){return this._clientFormDataSource.updatePanelViewInfo(e)},e.prototype.getContentTypes=function(e){return this._clientFormDataSource.getContentTypes(e)},e.prototype.getContentInfoTypes=function(e){var t=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var n={},a=0,r=e.selection;a<r.length;a++){var o=r[a];if(o){var s=o.properties;if(s){var c=o.type!==i.t.Folder||s.ContentType?s.ContentType:p,d=s.ContentTypeId,l=c+d;n[l]||(t.push({contentType:c,contentTypeId:d}),n[l]=!0)}}}else t.push({contentType:e.contentType,contentTypeId:e.contentTypeId});return t},e.prototype.hasFormRenderMode=function(e){return this._clientFormDataSource.hasFormRenderMode(e)},e.prototype.getFormRenderMode=function(e,t){return this._clientFormDataSource.getFormRenderMode(e,t)},e.prototype.getPowerAppFormId=function(){return this._clientFormDataSource.getPowerAppFormId()},e.prototype.getPowerAppRenderInfo=function(){return this._clientFormDataSource.getPowerAppRenderInfo()},e.prototype.getPowerAppAdditionalData=function(){return this._clientFormDataSource.getPowerAppAdditionalData()},e.prototype.getPowerAppFormCacheInfo=function(){return this._clientFormDataSource.getPowerAppFormCacheInfo()},e.prototype.getPowerAppFormDesignUrl=function(e){return this._clientFormDataSource.getPowerAppFormDesignUrl(e)},e.prototype.fetchAllClientFormSchemas=function(){return this._clientFormDataSource.fetchAllClientFormSchemas()},e.prototype.clearBuffer=function(){this._buffer=[]},e.prototype.updateListContext=function(e){this._listContext=e,this._clientFormDataSource.listContext=e,h||(this._clientFormDataSource.fileUploaderProvider=new u.e({pageContext:this._pageContext,listUrl:null==e?void 0:e.listUrl}))},e.prototype.getResourceProviders=function(){return this._clientFormDataSource.getResourceProviders()},e.prototype.updateDefaultValueOverride=function(e){this._defaultValueOverride=e},e.prototype.clearStoreClientForm=function(){e._clientFormStore=[]},e.prototype.getCustomAllowedExternalDomains=function(){var t=this._pageContext.webAbsoluteUrl,n=e._customAllowedDomainsCache;return n[t]||(n[t]=this._clientFormDataSource.getCustomAllowedExternalDomains()),n[t]},e.prototype._generateFieldsFromSchema=function(e,t){for(var n=this._listContext&&this._listContext.enableAttachments,a=0,i=t.fields.length;a<i;a++){var r=t.fields[a];void 0!==this._defaultValueOverride[r.InternalName]&&(r.DefaultValue=this._defaultValueOverride[r.InternalName],r.DefaultValueFormatted="",r.DefaultValueTyped=""),("Attachments"!==r.Type||n)&&(!e.isBulkEdit||!r.ReadOnlyField)&&e.fields.push(this._generateField(e,r))}},e.prototype._generateField=function(e,t){return{hasException:!1,errorMessage:"",schema:t,state:s.t.ready}},e.prototype._getBufferKeyFromItem=function(e,t){return e.properties.ID+e.name+"|"+t},e.prototype._getClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){var a=this._buffer[t].key;if(a===e){if(0===t)return this._buffer[t].form;var i=this._buffer[t].form;return this._buffer.splice(t,1),this._buffer.unshift({key:a,form:i}),i}}return null},e.prototype._addClientFormToBuffer=function(e){if(!e.isBulkEdit){var t=e.item;t&&void 0!==t.properties.ID&&this._buffer.unshift({key:this._getBufferKeyFromItem(t,e.contentType),form:e})>this._bufferSize&&this._buffer.pop()}},e.prototype._deleteClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++)if(this._buffer[t].key===e){this._buffer.splice(t,1);break}},e.prototype._getStoredClientForm=function(t){for(var n=0;n<e._clientFormStore.length;n++)if(e._clientFormStore[n].clientFormId===t)return e._clientFormStore[n];var a={onFinish:void 0,clientFormId:t,clientForm:void 0,status:void 0};return e._clientFormStore.push(a),a},e.prototype._deleteClientFormFromStoredClientForm=function(t){for(var n=0;n<e._clientFormStore.length;n++)if(e._clientFormStore[n].clientFormId===t){e._clientFormStore.splice(n,1);break}},e.prototype._completeStoredClientForm=function(t,n,a){for(var i=0;i<e._clientFormStore.length;i++)e._clientFormStore[i].clientFormId===t.clientFormId&&(e._clientFormStore[i].status=n,a&&(e._clientFormStore[i].clientForm=a),t.onFinish&&t.onFinish(n))},e._clientFormStore=[],e._customAllowedDomainsCache={},e}()},2864:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a,i=n(2261),r=n(183),o=n(1385),s=n(2494),c=n(1372),d=n(2057),l=n(145),u=n(2469),f=n(416),p=n(154),m=n(617),_=n(231),h=n(2602),b=n(1358),g=n(25);!function(e){function t(e,t,n,a){if(e){var _=Object(h.e)(function(e){return e.id||e.FileRef||e.ServerRelativeUrl}(e),n.listUrl),b={key:_};b.id=e.id||e.FileRef,b.itemId=e["name.FileSystemItemId"];var v=e.File_x0020_Type;b.extension=v?"."+v:void 0,b.policyTip=e._ip_UnifiedCompliancePolicyUIAction?Number(e._ip_UnifiedCompliancePolicyUIAction):i.a.none,b.type=function(e,t,n){var a=p.t.File,i=e.File_x0020_Type;if("1"===e.FSObjType){var r=e["File_x0020_Type.mapapp"],o=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];a=r&&"onenote"===r.substring(0,7)||o&&-1!==o.indexOf("onenote")?p.t.OneNote:p.t.Folder}else u.e.isShortcutEnabled()&&u.e.isShortcutFileType(i)?a=p.t.Shortcut:"pdf"===i?a=p.t.Media:(a=f.i(i))===p.t.Unknown&&Object(g.o)(n.listTemplateType)&&(a=p.t.File);return".ai"!==t.extension&&".eps"!==t.extension&&".psd"!==t.extension||(a=p.t.Media),a===p.t.Folder?t.isDocSet="Sharepoint.DocumentSet"===e.ProgId:a===p.t.File&&n&&!n.isDocLib&&(t.listItem={}),a}(e,b,n),b.extension&&(b.iconName=f.a(b)),b.isRootFolder=e.isRootFolder;var y=Object(o.getItemName)(e,b.type,n);y&&(b.displayName=b.name=y),b.dateModifiedValue=e.Modified,b.dateModified=e["Modified.FriendlyDisplay"]?Object(d.e)(e["Modified.FriendlyDisplay"]):String(e.Modified),b.permissions=e.PermMask?c.e(e.PermMask):void 0,b.isPlaceholder=!e.PermMask,b.hasMissingMetadata=function(e,t){if(!t.listSchema)return!1;var n=t.listSchema.filter(function(e){return e.isRequired&&Boolean(e.name)}),a=!1;if(n&&n.length>0)for(var i in n)if(i&&!e[n[i].internalName]){a=!0;break}return a}(e,n);var S=e["serverurl.progid"];if(b.openUrl=S?S.substring(1):e.FileRef,-1!==b.openUrl.toLowerCase().indexOf("/wopiframe?")&&(b.openUrl=b.openUrl.replace(/\/_layouts\/WopiFrame.aspx\?/,"/_layouts/15/WopiFrame.aspx?")),b.previewIFrameUrl=e.ServerRedirectedEmbedUrl,b.appMap=e["File_x0020_Type.mapapp"]||e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],b.size=e.File_x0020_Size?Number(e.File_x0020_Size):void 0,b.totalSize=e.SMTotalSize?Number(e.SMTotalSize):void 0,a.blockDownloadsExperienceEnabled&&(b.type===p.t.Media||b.openUrl&&b.appMap)?b.itemStatus=r.t.ConditionalAccessViewOnly:a.blockDownloadsExperienceEnabled?b.itemStatus=r.t.ConditionalAccessBlocked:a.viewOnlyExperienceEnabled&&(b.itemStatus=r.t.ConditionalAccessViewOnly),b.type===p.t.Folder){b.folder={},b.childCount=Number(e.ItemChildCount)+Number(e.FolderChildCount);var D=Number(e.SMTotalFileCount);b.folder.totalCount=D>0?D:b.childCount,b.folder.childCount=b.childCount}for(var I in b.isDraggable=!0,b.isDropEnabled=b.type===p.t.Folder,b.properties={},e)e.hasOwnProperty(I)&&(b.properties[I]=e[I]);var x=e.UniqueId&&l.e.normalizeLower(e.UniqueId);x&&(b.properties.uniqueId=x);var C=b.name;return b.extension&&(C=b.name.substring(0,b.name.toLowerCase().lastIndexOf(b.extension.toLowerCase()))),b.properties.FileName=C,Number(e.PrincipalCount)>0?b.sharingType=m.e.Shared:void 0===e.PrincipalCount?b.sharingType=m.e.Unknown:b.sharingType=m.e.Private,Object(s.n)(e,t,n),b}}e.buildItems=function(e,n,a,i,r){for(var o=[],s=[],c=e.Row,d=c.length,l=0;l<d;l++){var u=t(c[l],s,n,a);u.parent=i,u.parentKey=i.key,r&&r.setItem(u.key,u),o.push(u)}var f=0;if(s.length>0){var p=s[s.length-1];f=p.startIndex+p.count}else s=void 0,f=d>0?e.LastRow:0;return{items:o,groups:s,totalCount:f}},e.buildRootItem=function(e,t,n,a){var i=function(e){var t=e;return 0===e.indexOf("id")&&(t=Object(_.e)(e).id),t}(e),r=Object(h.e)(i,n.listUrl),o={key:r},s=t.ListTitle,d=t.AllowCreateFolder,l=t.EnableMinorVersions,u=t.verEnabled,f=t.AllowGridMode,m=t.DisableGridEditing,v=t.ListTemplateType,y=t.BasePermissions,S=void 0===y?{}:y,D=S.ManageLists,I=void 0===D?void 0:D,x=S.ManagePersonalViews,C=void 0===x?void 0:x,O=S.OpenItems,w=void 0===O?void 0:O,E=t.ListSchema,A=(void 0===E?{}:E).DefaultItemOpen,L=void 0===A?void 0:A,k=t.ExcludeFromOfflineClient,M=t.WebExcludeFromOfflineClient,P=t.ListData,T="string"==typeof L?"0"===L:void 0;if(a){var U=a.getItem(r);U&&(o=U)}return o.type=p.t.Folder,o.isRootFolder=i===n.listUrl,Object(b.default)(o,{permissions:b.optional(P?c.e(P.FolderPermissions):void 0)}),void 0===o.list&&(o.list={}),Object(b.default)(o.list,{id:b.optional(t.listName),title:b.optional(s),allowGridMode:"boolean"==typeof f?f:b.backup(!0),allowCreateFolder:b.optional(d),disableCommenting:"boolean"==typeof t.DisableCommenting&&t.DisableCommenting,disableGridEditing:"boolean"==typeof m?m:b.backup(!1),enableMinorVersions:b.optional(l),enableVersions:b.optional(u),templateType:b.optional("string"==typeof v?Number(v):void 0),isDocumentLibrary:b.optional("string"==typeof v?Object(g.i)(v):void 0),isPromotedLinks:b.optional("string"==typeof v?Object(g.s)(v):void 0),isForceCheckout:b.optional(t.isForceCheckout),isModerated:b.optional(t.isModerated),enableRequestSignOff:b.optional(t.EnableRequestSignOff),newWOPIDocumentEnabled:b.optional(t.NewWOPIDocumentEnabled),newWOPIDocumentTypes:b.optional(t.NewWOPIDocumentTypes),permissions:{manageLists:b.optional(I),managePersonalViews:b.optional(C),openItems:b.optional(w)},openInClient:b.optional(T),excludeFromOfflineClient:b.optional("boolean"==typeof k||"boolean"==typeof M?k||M:void 0),contentTypesEnabled:b.optional(t.ContentTypesEnabled),metadataNavFeatureEnabled:b.optional(t.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:b.optional(t.canUserCreateMicrosoftForm),itemCount:b.optional(t.ListSchema&&t.ListSchema.ItemCount),rowLimit:b.optional(P&&P.RowLimit)}),o.isRootFolder&&(o.name=o.displayName=s),a&&a.setItem(r,o),o},e.buildItem=t}(a||(a={}))},2865:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(){}return e.newItemCreated="clientFormNewItemCreated",e.itemUpdated="clientFormItemUpdated",e}()},2906:function(e,t,n){"use strict";n.d(t,"e",function(){return q});var a=n(0),i=n(111),r=n(118),o=n(2251),s=n(1311),c=n(1966),d=n(33),l=n(1353),u=n(2581),f=["-2146232832, Microsoft.SharePoint.SPFieldValidationException","NoConnection"],p=n(2409),m=n(2398),_=n(182),h=n(1381),b=n(694),g=n(497),v=n(248),y=n(2756),S=n(1385),D=n(2341),I=n(2864),x=n(2494),C=n(25),O=function(){function e(e){this._listContext=e.listContext,this._pageContext=e.pageContext,this._itemStore=e.itemStore,this._language=e.language}return e.prototype.processData=function(e,t){Object(S.updateListContext)(t,this._listContext),Object(S.updateListContextGroupInfo)(this._listContext);var n=t.ListSchema&&"TRUE"===t.ListSchema.Collapse,a=this._processSchema(t.ListSchema),i=t.ListContenTypes,r=t.ListData||t,o=I.e.buildRootItem(e,t,this._listContext,this._itemStore),s=this._processItems(r,n,o,this._language);return{root:o,items:s.items,groups:s.groups,totalCount:s.totalCount,startIndex:this._getStartIndex(r),columns:a,contentTypes:i,nextRequestToken:this._getNextRequestToken(r),isAllGroupsCollapsed:n}},e.prototype._processSchema=function(e){if(e){var t={},n={hasFixedSchema:this._listContext.listTemplateType===C.n.mySiteDocumentLibrary};this._listContext.listSchema=Object(D.buildSchema)(e,this._listContext,n,t),Object.keys(t).length&&(this._listContext.groupSchema=t)}return this._listContext.listSchema},e.prototype._processItems=function(e,t,n,a){var i;return(i=t?Object(x.e)(e.Row,this._listContext,void 0,a):I.e.buildItems(e,this._listContext,this._pageContext,n,this._itemStore)).groups&&i.groups.length>0&&(this._listContext.lastGroup=i.groups[i.groups.length-1]),{items:i.items?i.items:[],groups:i.groups,totalCount:i.totalCount}},e.prototype._getStartIndex=function(e){var t=0;return this._listContext.group?t=this._listContext.group.startIndex:e.FirstRow&&(t=e.FirstRow-1),t},e.prototype._getNextRequestToken=function(e){var t="";return e.NextHref&&(t=(t=e.NextHref).replace("&View=00000000-0000-0000-0000-000000000000","")),t},e}(),w=n(2565),E=n(2855),A=n(2515),L=n(222),k=n(2841),M=n(92),P=n(78),T=n(105),U="OnChangingTags";function F(e,t){void 0===t&&(t=1);try{for(var n=e.fields.length,a=0;a<n;a++)if("TaxonomyFieldType"===e.fields[a].schema.FieldType||"TaxonomyFieldTypeMulti"===e.fields[a].schema.FieldType){var i=H(e.fields[a].serverData,e.fields[a].data);if(0===i.addedTagsCount&&0===i.deletedTagsCount)continue;var r=e.fields[a].schema.FieldType.toLowerCase();e.isBulkEdit||t>1?r+=".BulkEdit.":r+=".NotBulkEdit.",r+=U;for(var o=0;o<t;o++)M.e.logData({name:r,isIntentional:!0,extraData:{deletedTagsCount:i.deletedTagsCount,addedTagsCount:i.addedTagsCount}})}}catch(e){return void T.e.logError(e,{eventName:U})}}function H(e,t){var n=R(e),a=R(t),i=0,r=Object.keys(n).length,o=Object.keys(a).length;if(r>0&&o>0)for(var s in n)a[s]&&i++;return{deletedTagsCount:r-i,addedTagsCount:o-i}}function R(e){if(!e)return{};for(var t={},n=0,a=e.split(";");n<a.length;n++)t[a[n]]=!0;return delete t[""],t}var N=n(4),B=n(1386),j=n(157),V=n(2865),z=n(2496),G=n(2634),K=n(2817),W=n(146),q={folder:"0x0120",document:"0x0101",item:"0x01"},Q={ODB:788,OneDrive:!0},Y={ODB:573,OneDrive:!0},J={ODB:1261},X={ODB:1293},Z={ODB:60087,ODC:!1,OneDrive:!1,Fallback:!1},$={ODB:60092,ODC:void 0,Fallback:!1},ee={ODB:1770},te="CreateItem",ne="UpdateItem",ae={ODB:60925},ie=N.t.isActivated("d3ea1d30-dd0c-4885-9a95-d6788e1a67ba","03/20/2023","When thumbnail field does not contain data, do not set nucleusRedirection header in item creation/update request"),re=N.t.isActivated("c6e5559b-37ee-4354-bf7d-708f2a1f328a","08/02/2023","fix error display for sen label field"),oe=N.t.isActivated("a0caf3eb-e18a-4cc2-955f-d0789ca872ca","10/06/2023","Use _EffectiveIpLabelDisplayName to render Sensitivity column"),se=N.t.isActivated("329c7588-585d-4df9-a67f-65e2e6213fe8","9/12/2023","FixNucleusSyncCheck"),ce=function(e){function t(t,n){var a=e.call(this,{},n)||this;return a._clientForms=null,a._init=function(e,t){var n=t.pageContext,i=t.apiUrlHelper,r=t.itemUrlHelper,o=t.listContext;a._itemUrlHelper=r||new _.e({},{pageContext:n}),a._apiUrlHelper=i||new g.e({},{itemUrlHelper:a._itemUrlHelper,pageContext:n}),e.complianceTagProvider?a._complianceTagProvider=e.complianceTagProvider:a._complianceTagProvider=new E.e({pageContext:n}),a._getSharedLockId=e.getSharedLockId,e.fileUploaderProvider?a._fileUploaderProvider=e.fileUploaderProvider:a._fileUploaderProvider=new w.e({pageContext:n,listUrl:null==o?void 0:o.listUrl}),a.isFeatureEnabled=e.isFeatureEnabled?e.isFeatureEnabled:function(e){return L.a.isFeatureEnabled(e,a._pageContext&&a._pageContext.ExpFeatures)},a.isFeatureEnabled(ae)&&a._pageContext.isLabelIRMEnabled&&(a._sensitivityLabelsDataSource=new G.SensitivityLabelsDataSource({},{pageContext:a._pageContext,getOAuthToken:null==t?void 0:t.getGraphAuthToken})),o&&(a._listContext=o)},a._getAdditionalPostData=function(e){return e.isListDataRenderOptionChangeFeatureEnabled=a.isFeatureEnabled(Q),e.isSpotlightFeatureEnabled=a.isFeatureEnabled(Y),b.e(e)},a._init(t,n),a._formRenderMode=N.t.isActivated("F0DEE101-8819-4628-B199-51D9800F6A22","08/28/2023","Updated FormRenderMode")?m.n:m.a,a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"listContext",{set:function(e){this._listContext=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fileUploaderProvider",{set:function(e){this._fileUploaderProvider=e},enumerable:!1,configurable:!0}),t.prototype.updateContext=function(e,t){this._init(e,t)},t.prototype.getClientFormSchema=function(e,t,n){var r,o=this,s=function(){var i=o._locateClientFormWithContentTypeInfos(e,t);if(n&&i&&i.fields){var r=i.fields.filter(function(e){return!o._isFieldRequireUniqueValue(e)});return Object(a.__assign)(Object(a.__assign)({},i),{fields:r})}return i};return e===p.e.newItem&&t&&this._contentTypeIdToNameMap&&(r=this._contentTypeIdToNameMap[t[0].contentTypeId]),null===this._clientForms||this._listContext.refreshClientForm||!r?(this._listContext.refreshClientForm=void 0,this.fetchAllClientFormSchemas().then(function(){return s()})):i.n.wrap(s())},t.prototype.getClientForm=function(e,t,n,a){var o=this;return new i.n(function(i,s){o.getData(function(){var t=r.e.encodeRestUriStringToken(o._listContext.listUrl),n=new P.t(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0",a=",cutoffVersion=".concat(n);return"".concat(o._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/RenderExtendedListFormData(itemId=".concat(e,",formId='editform',mode='2',options=").concat(30).concat(a,")")+"?@v1='".concat(t,"'")},function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData)return t=JSON.parse(t.d.RenderExtendedListFormData),n&&n.length>0&&!n[0].contentType&&t.ListData&&t.ListData.ContentType&&(n[0].contentType=t.ListData.ContentType,n[0].contentTypeId||(n[0].contentTypeId=t.ListData.ContentTypeId)),t.ListDataLite=t.ListData,t.ListData=t.Data,t.Data=void 0,t}return null},"GetItemDataForClientForm",function(){return""},"POST",o._getAdditionalHeaders()).then(function(e){var r;if(!a&&o.isFeatureEnabled(ae)&&o._pageContext.isLabelIRMEnabled)null===(r=o._sensitivityLabelsDataSource)||void 0===r||r.getDocLibSensitivityLabelsCached().then(function(r){o._sensitivityLabelOptions=K.e.processLabelsForItem(r);var s=o._processGetClientFormServerData(e,t,n,a);i(s)}).catch(function(r){o._sensitivityLabelOptions=[];var s=o._processGetClientFormServerData(e,t,n,a);i(s)});else{var s=o._processGetClientFormServerData(e,t,n,a);i(s)}},function(e){var t=e.code?e.code.split(","):e.error.code.split(","),n=t.length>1?Number(t[0]):-1;s({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})})},t.prototype.updatePanelViewInfo=function(e){var t=this;return new i.n(function(n,a){t.getData(function(){var n=r.e.encodeRestUriStringToken(t._listContext.listUrl);return"".concat(t._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/contentTypes('".concat(e.contentTypeId,"')")+"/ReorderFields()"+"?@v1='".concat(n,"'")},function(){return null},"CustomPanelSaveDataToServer",function(){return JSON.stringify({fieldNames:e.data})}).then(function(){n(e.serverResponse({message:{value:"updated Information"}}))},function(t){a(e.serverResponse(t))})})},t.prototype.saveCustomShowHideRules=function(e,t,n){var a=this,i={__metadata:{type:"SP.Field"},ClientValidationFormula:e.rules,ClientValidationMessage:e.errMsg};return this.getData(function(){return a._getListApiUrl(t).segment("Fields").method("GetByInternalNameOrTitle",n).toString()},function(e){return e},"saveCustomValidationRules",function(){return JSON.stringify(i)},"MERGE")},t.prototype._isFieldRequireUniqueValue=function(e){var t=e.FieldType.toLowerCase(),n=e.Name;return"file"===t||"attachments"===t||"Title"===n||"LinkTitle"===n||"LinkTitleNoMenu"===n||"thumbnail"===t},t.prototype._getListApiUrl=function(e){var t=this._itemUrlHelper.getUrlParts({path:e||this._pageContext.listUrl,listUrl:e||this._pageContext.listUrl});return this._apiUrlHelper.build().webByItemUrl(t).method("GetList",t.serverRelativeListUrl)},t.prototype.saveClientFormCustomFormatter=function(e,t){var n=this,a={__metadata:{type:"SP.ContentType"},ClientFormCustomFormatter:JSON.stringify(e.ClientFormCustomFormatterJson)};return this.getData(function(){return n._getListApiUrl(t).segment("contentTypes('"+e.ContentTypeId+"')").toString()},function(e){return e},"saveCustomFormFormatterJSON",function(){return JSON.stringify(a)},"MERGE")},t.prototype.getClientFormCustomFormatter=function(e,t){var n=this;return this.getData(function(){return n._getListApiUrl(t).segment("contentTypes('"+e+"')").toString()},function(e){return e},"GetCustomFormatter",null,"GET")},t.prototype.getResourceProviders=function(){return{ComplianceTagProvider:this._complianceTagProvider,FileUploaderProvider:this._fileUploaderProvider}},t.prototype._processGetClientFormServerData=function(e,t,n,i){var r=this,o=new O({listContext:this._listContext,pageContext:this._pageContext}).processData("parent",e),s=o&&o.items&&o.items[0];this._clientForms={};var c=e.ListSchema,d=e.ItemContentTypeId,l=e.ItemContentTypeName||e.ItemContentType,u=e.ClientFormCustomFormatter;u&&(this._ctIdToClientFormCustomFormatter=u),c&&(c.New&&this._processClientFormResponse(p.e.newItem,c.New,d,l),c.Edit&&(this._processClientFormResponse(p.e.editItem,c.Edit,d,l),this._processClientFormResponse(p.e.displayItem,c.Edit,d,l)));var f=this._locateClientFormWithContentTypeInfos(t,n);if(i&&f&&f.fields){var _=f.fields.filter(function(e){return!r._isFieldRequireUniqueValue(e)});f=Object(a.__assign)(Object(a.__assign)({},f),{fields:_})}var h={item:s,formType:null==f?void 0:f.formType,contentType:null==f?void 0:f.contentType,contentTypeId:null==f?void 0:f.contentTypeId,fields:[],isBulkEdit:i,clientFormCustomFormatter:null==f?void 0:f.clientFormCustomFormatter};this._generateFieldsFromSchema(h,f);for(var b=[],g=0,v=h.fields;g<v.length;g++)(D=v[g]).state===m.t.ready&&(D.state=m.t.updating,b.push(D));t!==p.e.newItem&&this._handleServerData(h,e,{},b);for(var y=0,S=b;y<S.length;y++){var D;(D=S[y]).state=m.t.ready}return h},t.prototype._generateFieldsFromSchema=function(e,t){var n=this._listContext&&(this._listContext.enableAttachments||void 0===this._listContext.enableAttachments);if(t){for(var a=0,i=t.fields.length;a<i;a++){var r=t.fields[a];("Attachments"!==r.Type||n)&&(!e.isBulkEdit||!r.ReadOnlyField)&&e.fields.push(this._generateField(e,r))}if(!e.isBulkEdit&&this.isFeatureEnabled(ae)&&this._pageContext.isLabelIRMEnabled&&this._sensitivityLabelOptions){var o=this._generateSensitivityLabelField(this._sensitivityLabelOptions);e.fields.push(this._generateField(e,o))}}},t.prototype._generateField=function(e,t){return{hasException:!1,errorMessage:"",schema:t,state:m.t.ready}},t.prototype._generateSensitivityLabelField=function(e){return{Id:"sensitivitylabel",Name:"Sensitivity",Type:"SensitivityLabel",Hidden:!1,InternalName:"sensitivitylabel",Title:"Sensitivity",SensitivityLabelOptions:e,FieldType:"sensitivitylabel"}},t.prototype.updateFormValues=function(e,t){var n=this,a=e.item;if(!a||!a.properties||!a.properties.ID)return i.n.wrap();for(var o=[],s=0,c=e.fields;s<c.length;s++){var d=c[s];d.state===m.t.ready&&(d.state=m.t.updating,o.push(d))}return this.getData(function(){var e=a.properties.ID,t=r.e.encodeRestUriStringToken(n._listContext.listUrl),i=new P.t(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0",o=",cutoffVersion=".concat(i);return"".concat(n._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/RenderExtendedListFormData(itemId=".concat(e,",formId='editform',mode='2',options=").concat(15).concat(o,")")+"?@v1='".concat(t,"'")},function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData)return JSON.parse(t.d.RenderExtendedListFormData)}return null},"GetItemDataForClientForm",function(){return""},"POST",this._getAdditionalHeaders(),"",0,!0).then(function(a){n._handleServerData(e,a,t,o);for(var i=0,r=o;i<r.length;i++)r[i].state=m.t.ready},function(e){for(var t=e.code?e.code.split(","):e.error.code.split(","),n=t.length>1?Number(t[0]):-1,a=0,r=o;a<r.length;a++)r[a].state=m.t.ready;return i.n.wrapError({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})},t.prototype.createItem=function(e){var t=this,n=this._getUrlInfo(),a=n.listUrl,r=n.itemUrlParts,o="AddValidateUpdateItemUsingPath",s=function(){return t._apiUrlHelper.build().webByItemUrl(r).method("GetList",a).method(o).toString()},c=!!e.clientForm.contentTypeId&&0===e.clientForm.contentTypeId.lastIndexOf(q.folder,0),d=function(t){var n=e.rootFolder||a;return JSON.stringify({listItemCreateInfo:{__metadata:{type:"SP.ListItemCreationInformationUsingPath"},FolderPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:n},UnderlyingObjectType:c?"1":void 0},formValues:t,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment})};return this._ensureClientForms().then(function(){return t.isFeatureEnabled(ee)?t._doCreateItem(s,d,e,o):t._fileUploaderProvider&&t._fileUploaderProvider.hasPendingImageOperations()?t._updateImages(!0).then(function(n){var a=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()});return t.handleFileUploaderErrors(n,null,a)?(n&&n.length>0&&n.forEach(function(t){if(t&&t.image){var n=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()&&e.schema.Name===t.image.fieldName})[0];if(n){var a=Object(z.e)(n.data);a&&(a.serverRelativeUrl=t.image.serverRelativeUrl,a.id=t.image.id,a.serverUrl=t.image.serverUrl);try{n.data=JSON.stringify(a)}catch(e){n.data=""}}}}),t._doCreateItem(s,d,e,o)):i.n.wrap({status:u.e.fail})}):t._doCreateItem(s,d,e,o)})},t.prototype._doCreateItem=function(e,t,n,a){var i=this;return this._createOrUpdateItem(te,e,t,n,a).then(function(e){return i._postUpdateFields(te,n,[]).then(function(t){return e.status===u.e.success&&t.status===u.e.fail?(t.status=u.e.partialSuccess,t):e})})},t.prototype.updateItem=function(e){var t=this,n=e.clientForm.isBulkEdit&&e.itemdIds&&e.itemdIds.length>1?e.itemdIds:void 0,r=n&&n.length>1,o=function(e){var n=t._getUrlInfo(),a=n.listUrl,i=n.itemUrlParts;return r?t._apiUrlHelper.build().webByItemUrl(i).method("GetList",a).method("BulkValidateUpdateListItems").toString():t._apiUrlHelper.build().webByItemUrl(i).method("GetList",a).method("items",e.properties.ID).method("ValidateUpdateListItem").toString()},s=function(i){var o,s;r&&(s=t._listContext.folderPath);var c=null===(o=t._getSharedLockId)||void 0===o?void 0:o.call(t);return JSON.stringify(Object(a.__assign)({itemIds:n,formValues:i,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment,folderPath:s},c?{sharedLockId:c}:{}))};return this._ensureClientForms().then(function(){return t.isFeatureEnabled(ee)?t._doUpdateItem(o,s,e,r,n):t._fileUploaderProvider&&t._fileUploaderProvider.hasPendingImageOperations()?t._updateImages(!1).then(function(a){var c=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()});return t.handleFileUploaderErrors(a,null,c)?(a&&a.length>0&&a.forEach(function(t){if(t&&t.image){var n=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()&&e.schema.Name===t.image.fieldName})[0];if(n&&n.data!==n.serverData){var a=Object(z.e)(n.data);a&&(a.serverRelativeUrl=t.image.serverRelativeUrl,a.id=t.image.id,a.serverUrl=t.image.serverUrl),n.data=a?JSON.stringify(a):""}}}),t._doUpdateItem(o,s,e,r,n)):i.n.wrap({status:u.e.fail})}):t._doUpdateItem(o,s,e,r,n)})},t.prototype._doUpdateItem=function(e,t,n,a,i){var r=this;return this._createOrUpdateItem(ne,e,t,n,a?"BulkValidateUpdateListItems":"ValidateUpdateListItem",i).then(function(e){return r._postUpdateFields(ne,n,i).then(function(t){return e.status===u.e.success&&t.status===u.e.fail?(t.status=u.e.partialSuccess,t):e})})},t.prototype.fetchAllClientFormSchemas=function(){var e=this;return this._clientFormsDebouncer||(this._clientFormsDebouncer=new o.e),this._clientFormsDebouncer.isExecuting()||(this._clientFormsPromise=this._clientFormsDebouncer.debounce(this.getData(function(){return e._getServerConnectionUrl().toString()},function(t){e._clientForms={};var n=JSON.parse(t);n.ContentTypeIdToNameMap&&(e._contentTypeIdToNameMap=n.ContentTypeIdToNameMap),n.ClientFormCustomFormatter&&(e._ctIdToClientFormCustomFormatter=n.ClientFormCustomFormatter);var a=n.ClientForms;a&&(a.New&&e._processClientFormResponse(p.e.newItem,a.New),a.Edit&&(e._processClientFormResponse(p.e.editItem,a.Edit),e._processClientFormResponse(p.e.displayItem,a.Edit))),n.Navigation&&(e._listContext.leftNavigationData={quickLaunchNodes:n.Navigation.Nodes}),e._listContext.enableAttachments="true"===n.EnableAttachments,n.FormRenderModes&&e._processFormRenderMode(n.FormRenderModes),(n.PowerAppFormId||n.AppId)&&(e._powerAppFormId=n.PowerAppFormId||n.AppId),n.AppRenderInfo&&(e._powerAppFormInfo=n.AppRenderInfo||{}),n.AppAdditionalData&&(e._powerAppAdditionalData=n.AppAdditionalData),n.CachedFileUrlTemplate&&n.CacheAppFiles&&(e._powerAppFormCacheInfo=JSON.stringify({appFiles:n.CacheAppFiles,cachedFileUrlTemplate:n.CachedFileUrlTemplate}))},"GetClientForms",function(){return e._getAdditionalPostData({needsSchema:!1,viewXml:'<View><ViewFields><FieldRef Name="ID"/></ViewFields></View>',needsForms:!0,needsQuickLaunch:!1})},"POST",this._getAdditionalHeaders()))),this._clientFormsPromise},t.prototype.getFieldFilterData=function(e,t,n){return new y.e({parentKey:void 0,listContext:this._listContext,pageContext:this._pageContext,folderPath:n,itemUrlHelper:this._itemUrlHelper,apiUrlHelper:this._apiUrlHelper}).getFilterData(e,"",t,void 0)},t.prototype.getContentTypes=function(e){var t=[];if(this._clientForms&&this._clientForms[e])for(var n in this._clientForms[e])this._clientForms[e].hasOwnProperty(n)&&t.push({displayName:n,description:n,templateUrl:null});return t},t.prototype.hasFormRenderMode=function(e){var t=this;return this._ensureClientForms(function(){return t._checkRenderModes(e)})},t.prototype.getFormRenderMode=function(e,t){var n=this;return this._ensureClientForms(function(){return n._getFormRenderMode(e,t)})},t.prototype.getPowerAppFormId=function(){return this._powerAppFormId},t.prototype.getPowerAppRenderInfo=function(){return this._powerAppFormInfo},t.prototype.getPowerAppAdditionalData=function(){return this._powerAppAdditionalData},t.prototype.getPowerAppFormCacheInfo=function(){return this._powerAppFormCacheInfo},t.prototype.getPowerAppFormDesignUrl=function(e){var t=this;return this.getData(function(){return"".concat(t._pageContext.webAbsoluteUrl,"/_api/SP.Internal.FormsCustomization.GetPowerAppsFormDesignUrl?listName='")+e+"'&visualizationTarget="+k.e.browser},function(e){var t=JSON.parse(e),n="";return t.d&&t.d.Value&&(n=JSON.parse(t.d.Value)),n},"GetPowerAppFormDesignUrl",null,"GET")},t.prototype.getCustomAllowedExternalDomains=function(){return this.dataRequestor.getData({url:"".concat(this._pageContext.webAbsoluteUrl,"/_api/Site/AllowedExternalDomains"),qosName:"GetAllowedExternalDomains",method:"GET",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})},t.prototype._getServerConnectionUrl=function(e){var t=this._itemUrlHelper.getUrlParts({listUrl:this._listContext.listUrl});return h.t({webUrl:this._pageContext.webAbsoluteUrl,listId:this._listContext.listId,urlParts:t,rootFolder:this._listContext.folderPath,requestToken:"?"})},t.prototype._processClientFormResponse=function(e,t,n,a){this._clientForms[e]||(this._clientForms[e]={});var i=this._clientForms[e];for(var r in t)if(t.hasOwnProperty(r)&&!i[r]){var o;o=r===a?n:this._reverseLookupContentTypeIdByName(r);var s=this._ctIdToClientFormCustomFormatter?this._ctIdToClientFormCustomFormatter[o]:void 0;i[r]={contentType:r,contentTypeId:o,formType:e,fields:[],clientFormCustomFormatter:s?JSON.parse(s):void 0,mode:m.n.Unknown};for(var c=i[r],d=t[r],l=0,u=d.length;l<u;l++)c.fields.push(d[l])}this._clientForms[e]=i},t.prototype._reverseLookupContentTypeIdByName=function(e){for(var t in this._contentTypeIdToNameMap)if(e===this._contentTypeIdToNameMap[t])return t;return null},t.prototype._processFormRenderMode=function(e){if(e)for(var t in e)for(var n in e[t]){var a=p.e.newItem;switch(n){case"Edit":a=p.e.editItem;break;case"Display":a=p.e.displayItem}var i=this._formRenderMode.Unknown;switch(e[t][n].RenderType){case 1:i=this._formRenderMode.Classic;break;case 2:i=this._formRenderMode.Modern;break;case 3:i=this._formRenderMode.PowerApp;break;case 4:i=this._formRenderMode.Customized;break;default:s.e.logData({name:"ClientFormDataSource.InvalidFormRenderMode",message:"Server returned RenderType="+e[t][n].RenderType})}this._clientForms[a][t].mode=i}},t.prototype._locateClientFormWithContentTypeInfos=function(e,t){if(!t||!t.length)return this._locateClientForm(e,void 0,void 0);var n=t[0],i=this._locateClientForm(e,n.contentType,n.contentTypeId);if(1===t.length||!i||!i.fields)return i;for(var r=i.fields.slice(),o=function(n){if(0===r.length)return"break";var a=t[n],i=s._locateClientForm(e,a.contentType,a.contentTypeId);r=r.filter(function(e){for(var t=0,n=i.fields;t<n.length;t++)if(n[t].Name===e.Name)return!0;return!1})},s=this,c=1;c<t.length&&"break"!==o(c);c++);return Object(a.__assign)(Object(a.__assign)({},i),{fields:r})},t.prototype._locateClientForm=function(e,t,n){if(!t&&n&&this._contentTypeIdToNameMap&&(t=this._contentTypeIdToNameMap[n]),!t&&this._clientForms[e])for(var a in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(a)){t=a;break}if(n&&0===n.lastIndexOf(q.folder,0)&&this._clientForms[e]&&!this._clientForms[e][t]){var i={FileLeafRef:1,Title:1,URL:1};for(var a in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(a)){var r=this._clientForms[e][a].fields.filter(function(e){return!!i[e.Name]})[0];if(r)return this._clientForms[e].Folder={contentType:"Folder",contentTypeId:n,formType:e,fields:[r],mode:m.n.Unknown},this._clientForms[e].Folder}}if(!this._clientForms[e]||!this._clientForms[e][t]){if("folder"===t.toLowerCase()&&!n)for(var a in this._clientForms[e])if(this._clientForms[e][a]&&!this._clientForms[e][a].contentTypeId)return this._clientForms[e][a];return null}return this._clientForms[e][t]},t.prototype._getAdditionalHeaders=function(e,t){var n=h.a(this._listContext);return this.isFeatureEnabled($)&&n&&e&&(e===p.e.newItem?(n.Scenario="CreateListItem",n.ScenarioType="AUO"):e===p.e.editItem&&(n.Scenario="EditListItem",n.ScenarioType="AUO")),t&&(n.nucleusRedirection="false"),n},t.prototype._handleServerData=function(e,t,n,a){var i=t.ListDataLite?t.ListDataLite:t.ListData,r=t.ListDataLite?t.ListData.Row[0]:t.Data.Row[0],o=e.item;if(this._ctIdToClientFormCustomFormatter=t.ClientFormCustomFormatter,this.isFeatureEnabled(ae)&&this._pageContext.isLabelIRMEnabled){var s=t.ListData.Row&&t.ListData.Row[0]&&t.ListData.Row[0]._DisplayName||"none";if(!oe){var c=t.ListData.Row&&t.ListData.Row[0]&&t.ListData.Row[0]._EffectiveIpLabelDisplayName;void 0!==c&&""!==c&&"0"!==c&&(s=c)}e.sensitivityLabel=s}for(var d=0,l=a.length;d<l;d++){var u=a[d],f=u.schema;if(!n||!n.hasOwnProperty(f.Name)){if(void 0===u.data&&(u.data=null),void 0===u.serverData&&(u.serverData=null),i.hasOwnProperty(f.Name)){if(f.FieldType&&"boolean"===f.FieldType.toLowerCase()&&""===r[f.Name]&&"0"===i[f.Name]?u.serverData="":f.FieldType&&"thumbnail"===f.FieldType.toLowerCase()&&r[f.Name]?u.serverData=r[f.Name]:u.serverData=i[f.Name],o.hasOwnProperty(f.Name)||o.properties.hasOwnProperty(f.Name)||(o.properties[f.Name]=r[f.Name]),this.isFeatureEnabled(Z)&&(o.properties.hasOwnProperty("ItemExpirationDate")||(o.properties.ItemExpirationDate=r._ExpirationDate),!o.properties.hasOwnProperty("IsItemExpirationModifiable"))){var p=r.MetaInfo,m=p&&p[0]&&p[0].lookupValue||"",_=new RegExp(/vti_stream_isexpirationmodifiable:([a-zA-Z]{2})\|false/gi).test(m);o.properties.IsItemExpirationModifiable=!_}}else A.r(u)?(u.serverData=r[A.t],o.hasOwnProperty(f.Name)||o.properties.hasOwnProperty(f.Name)||(o.properties[f.Name]=r[f.Name])):o.folder&&u.schema.FieldType&&"file"===u.schema.FieldType.toLowerCase()&&u.schema.Title&&"name"===u.schema.Title.toLowerCase()&&i.Title?u.serverData=i.Title:f.FieldType&&"sensitivitylabel"===f.FieldType?u.serverData=e.sensitivityLabel:u.serverData=null;e.isBulkEdit&&(u.serverData=null),u.schema.AppendOnly?(u.appendOnlyData=t[u.schema.Name],u.data=""):u.schema.SensitivityLabelOptions?u.data="":u.data=u.serverData}}o.hasClientFormData=!0},t.prototype._createOrUpdateItem=function(e,t,n,a,r,o){var s=this,c=a.clientForm.fields,d=[],l=[],f={},_=[],h=!1,b=!1;a.clientForm.formType===p.e.editItem&&a.clientForm.item&&!a.clientForm.isBulkEdit&&this._listContext&&!this._listContext.isDocLib&&a.clientForm.item.properties&&"1"===a.clientForm.item.properties.FSObjType&&(b=!0),this.isFeatureEnabled(X)&&(o?F(a.clientForm,o.length):F(a.clientForm));for(var g=void 0,y=!1,S=!1,D=0,I=c;D<I.length;D++){var x=I[D];if(this.isFeatureEnabled(ee)&&"thumbnail"===x.schema.FieldType.toLowerCase()&&(ie||this._fileUploaderProvider&&this._fileUploaderProvider.hasPendingImageOperations())&&(S=!0),null!==x.data&&void 0!==x.data){var C=x.data;if("thumbnail"===x.schema.FieldType.toLowerCase()){if(this.isFeatureEnabled(ee))continue;if("string"!=typeof C)try{C=JSON.stringify(C)}catch(e){}}if(!this._isClientFormFieldUpdated(a,C,x.serverData,x)||"attachments"===x.schema.FieldType.toLowerCase()||"sensitivitylabel"===x.schema.FieldType||A.r(x)||A.o(x))f[x.schema.Name]=!0,!g&&this._isEventField(x)&&(g=x);else{d.push(x);var O=x.schema.Name;"ContentType"===O&&(C=this._reverseLookupContentTypeIdByName(C.displayName),O="ContentTypeId",h=!0),l.push({FieldName:O,FieldValue:C,HasException:!1,ErrorMessage:null}),!y&&this._isEventField(x)&&(y=!0),"Title"===O&&b&&l.push({FieldName:"FileLeafRef",FieldValue:C,HasException:!1,ErrorMessage:null});var w=x.schema.FieldType.toLowerCase();M.e.logData({name:"ClientFormUpdate",extraData:{FieldType:w,Host:Object(B.e)()}})}}}if(y&&g&&l.push({FieldName:g.schema.Name,FieldValue:g.data,HasException:!1,ErrorMessage:null}),h?4096==(4096&this._listContext.flags2)&&l.push({FieldName:"PrimeCorrectedByUser",FieldValue:"true",HasException:!1,ErrorMessage:null}):a.clientForm.formType===p.e.newItem?l.push({FieldName:"ContentType",FieldValue:a.clientForm.contentType,HasException:!1,ErrorMessage:null}):a.clientForm.formType===p.e.editItem&&a.clientForm.item&&a.clientForm.item.properties&&!a.clientForm.isBulkEdit&&l.push({FieldName:"ContentTypeId",FieldValue:a.clientForm.item.properties.ContentTypeId,HasException:!1,ErrorMessage:null}),0===d.length&&0===_.length)return i.n.wrap({status:u.e.success});var E=!1;return this.isFeatureEnabled(ee)&&a.clientForm.formType===p.e.newItem&&S&&(E=!0),_.push(this._getUpdateItemPromise(e,t,n,a,r,d,l,a.clientForm.item,o,E)),i.n.all(_).then(function(e){for(var t={status:u.e.success},n=0,a=e;n<a.length;n++){var i=a[n];i&&i.hasOwnProperty("status")&&(t.status=i.status,i.failedItemIds&&(t.failedItemIds=i.failedItemIds));break}return t},function(e){var t,n;if((e=Array.isArray(e)?e:[e])&&e[0]&&e[0].code){var i=e[0].code.split(", ");i&&2===i.length&&(t=i[0],n=i[1])}for(var r="-2146232832"===t&&"Microsoft.SharePoint.SPFieldValidationException"===n,o=0;o<d.length;o++){var c=d[o];c.hasException=0===o||r,c.state=m.t.ready}var l=Object(v.s)(s._pageContext)+a.clientForm.item.properties.FileRef;throw e.filter(function(e){return e&&e.message&&e.message.value}).map(function(e){return e.message.value=e.message.value.replace('"'.concat(l,'" '),""),e})})},t.prototype._isEventField=function(e){var t,n,a=null===(n=null===(t=e.schema)||void 0===t?void 0:t.Id)||void 0===n?void 0:n.toLowerCase();return"64cd368d-2f95-4bfc-a1f9-8d4324ecb007"===a||"2684f9f2-54be-429f-ba06-76754fc056bf"===a},t.prototype._getUpdateItemPromise=function(e,t,n,r,o,s,c,l,_,h){var b,g=this;return c&&0!==c.length&&s&&0!==s.length?this.getData(t.bind(null,l),function(e){var t=JSON.parse(e);if(!t.d||!t.d[o]||!t.d[o].results){for(var n=0,a=s;n<a.length;n++)(A=a[n]).state=m.t.ready;return b={status:u.e.partialSuccess,errorMessage:"The server response couldn't be processed"}}for(var i=null,c={},d="",f=0,h=t.d[o].results;f<h.length;f++){var v=h[f];if(r.clientForm.formType===p.e.newItem&&"Id"===v.FieldName){var y=l;y.properties||(y.properties={}),y.properties.ID=v.FieldValue}if(!0===v.HasException||null!==v.ErrorMessage){var S=v.FieldName;if(c[S]||(c[S]=[]),void 0!==v.ItemId&&c[S].indexOf(v.ItemId)<0&&c[S].push(v.ItemId),!i){i={};for(var D=0,I=r.clientForm.fields;D<I.length;D++){var x=I[D];i[x.schema.Name]=x}}if(i[S]){i[S].errorMessage=v.ErrorMessage,i[S].hasException=!0;var C=i[S].schema.Title;d=d?d+", "+C:C}}}if(b={status:d?u.e.fail:u.e.success},_&&_.length&&c.null){var O=c.null;O.length<_.length?b.status=u.e.partialSuccess:b.status=u.e.fail,b.failedItemIds=O}for(var w=0,E=s;w<E.length;w++){var A=E[w];d?!c[A.schema.Name]&&r.isInteractiveSave&&(A.errorMessage="Cannot save due to errors in other fields: "+d,A.hasException=!0):(A.errorMessage="",A.hasException=!1),A.state=m.t.ready}return g._raiseCreateOrUpdateEvents(r,b),b},e,function(){return n(c)},"POST",this._getAdditionalHeaders(r.clientForm.formType,h),void 0,5,void 0,void 0,function(e){var t=e.eventData,n=e.errorData;if(n){var i=!1;return f.indexOf(n.code)>-1&&(i=!0),{eventData:Object(a.__assign)(Object(a.__assign)({},t),t.resultType!==d.t.ExpectedFailure?{resultType:i?d.t.ExpectedFailure:d.t.Failure}:{}),canRetry:!i}}return{eventData:t}}):(b={status:u.e.partialSuccess},i.n.wrap(b))},t.prototype._getUrlInfo=function(){var e=this._itemUrlHelper.getUrlParts({listUrl:this._listContext.listUrl});return{listUrl:e&&e.serverRelativeListUrl?e.serverRelativeListUrl:this._listContext.listUrl,itemUrlParts:e}},t.prototype._isClientFormFieldUpdated=function(e,t,n,a){return!(e.clientForm.isBulkEdit&&""===t&&null===n||a.schema.AppendOnly&&!t&&!Object(C.i)(this._pageContext.listBaseTemplate)||("thumbnail"===a.schema.FieldType.toLowerCase()?a.data.fileName&&n.fileName&&a.data.serverRelativeUrl===n.serverRelativeUrl:c.e(t,n)))},t.prototype._postUpdateFields=function(e,t,n){var a=this,r=t.clientForm,o=r.item;if(!this.isValidItem(o))return i.n.wrap({status:u.e.fail});for(var s,c=this._itemUrlHelper.getItemUrlParts(o.key).serverRelativeListUrl,d=n&&n.length>1,l=[],f=null,p=[],m=0;m<r.fields.length;m++){var _=r.fields[m];if(A.r(_)){if(!d&&_.data===_.serverData)continue;if(d){var h=this._updateMultipleComplianceTagsPromises(n,_,c);if(h)for(var b=0,g=h;b<g.length;b++){var v=g[b];l.push(v)}}else l.push(this._updateComplianceTagField(_,o));M.e.logData({name:"ClientFormUpdate."+_.schema.FieldType.toLowerCase()})}else if(A.o(_)){if(!this.isFeatureEnabled(J)||_.data===_.serverData)continue;var y=A.s(o.properties[A.e]);if(y===("1"===_.data)||d)continue;l.push(this._updateUnlockRecordField(o,_,c,y)),M.e.logData({name:"ClientFormUpdate."+_.schema.FieldType.toLowerCase()})}else if("attachments"===_.schema.FieldType.toLowerCase())f=_;else if("sensitivitylabel"===_.schema.InternalName)s=_;else if("thumbnail"===_.schema.FieldType.toLowerCase()){if(!_.data&&!_.serverData)continue;if(_.data&&_.serverData&&_.data.serverRelativeUrl===_.serverData.serverRelativeUrl)continue;p.push(_)}}if(this.isFeatureEnabled(ae)&&this._pageContext.isLabelIRMEnabled&&s){var S=t.graph,D=null==S?void 0:S.driveId,I=null==S?void 0:S.itemId,x=this._getCurrentSensitivityLabelTitle(this._sensitivityLabelOptions,s.data),C="none"===s.data;if((C?r.sensitivityLabel!==s.data:s.data&&s.data.trim()&&r.sensitivityLabel!==x)&&D&&I){var O=C?"":s.data;M.e.logData({name:"ClientFormSensitivityLabelUpdate",extraData:{Host:Object(B.e)()}}),l.push(i.n.resolve(this._sensitivityLabelsDataSource.setSensitivityLabel(D,I,O,s.justificationText).then(function(e){return r.sensitivityLabel=x,{status:u.e.success}},function(e){var t,n;if(re){var a=e.message;e.innerError&&(a=a+"."+e.innerError.message),s.errorMessage=a}else{var i=e.response.error;n=i&&i.code&&i.code.toString()||"",(null===(t=null==i?void 0:i.innerError)||void 0===t?void 0:t.code)&&(n=n+"."+i.innerError.code.toString()),s.hasException=!0,s.errorMessage=n}return{status:u.e.fail}})))}}return r.containsImageFieldData=p.length>0,n&&0!==n.length||(l.push(this._updateAttachmentsField(f,o,e)),this.isFeatureEnabled(ee)&&l.push(this._updateThumbnailFields(p,o,e===te))),i.n.all(l).then(function(e){var t;p.length>0&&a._pageContext.dataSyncClient&&a._pageContext.listId&&a._pageContext.siteId&&a._pageContext.dataSyncClient.then(function(e){e&&(se?e.triggerListSyncNowForCurrentUser({listId:Object(W.normalizeLower)(a._pageContext.listId,!1),siteId:Object(W.normalizeLower)(a._pageContext.siteId,!1)}):e.isListDataSyncEnabledAsync({listId:a._pageContext.listId,siteId:a._pageContext.siteId}).then(function(t){t&&e.triggerListSyncNowForCurrentUser({listId:Object(W.normalizeLower)(a._pageContext.listId,!1),siteId:Object(W.normalizeLower)(a._pageContext.siteId,!1)})}))});for(var n={status:u.e.success},i=0,r=e;i<r.length;i++){var o=r[i];o&&o.status===u.e.fail&&(n.status=o.status),o&&o.failedItemIds&&o.failedItemIds.length>0&&(t=n.failedItemIds).push.apply(t,o.failedItemIds)}return n})},t.prototype._getCurrentSensitivityLabelTitle=function(e,t){for(var n=0;n<e.length;n++)if(e[n].id===t)return e[n].text;return""},t.prototype._updateComplianceTagField=function(e,t){var n,a=e.schema;return a.ComplianceTags&&(n=a.ComplianceTags.filter(function(t){return t&&t.tagValue===e.data})[0]),n?(e.state=m.t.saving,this._complianceTagProvider.updateComplianceTag(t,n).then(function(){return e.state=m.t.ready,{status:u.e.success}},function(t){return t&&e&&(e.errorMessage=t.message&&t.message.value?t.message.value:t,e.hasException=!0),e.state=m.t.ready,{status:u.e.fail}})):i.n.wrap(null)},t.prototype._updateMultipleComplianceTagsPromises=function(e,t,n){var a,i=t.schema,r=[];if(i.ComplianceTags&&(a=i.ComplianceTags.filter(function(e){return e&&e.tagValue===t.data})[0]),!a)return r;t.state=m.t.saving;for(var o=[],s=0,c=0,d=e.length;c<d;c++)o.push(e[c]),++s!==A.n&&c!==e.length-1||(r.push(this._complianceTagProvider.updateComplianceTagInBatch(o,a,n).then(function(e){return t.state=m.t.ready,e&&e.length>0?{status:u.e.fail,failedItemIds:e}:{status:u.e.success}},function(e){return e&&t&&(t.errorMessage=e.message&&e.message.value?e.message.value:e,t.hasException=!0),t.state=m.t.ready,{status:u.e.fail,failedItemIds:o}})),o=[],s=0);return r},t.prototype._updateUnlockRecordField=function(e,t,n,a){var i="1"===t.data;return t.state=m.t.saving,i?this._complianceTagProvider.unlockRecord(e,n).then(function(e){return t.serverData=e?"1":"0",t.state=m.t.ready,{status:u.e.success}},function(e){return e&&t&&(t.serverData=a?"1":"0",t.data="0",t.errorMessage=e.message&&e.message.value?e.message.value:e,t.hasException=!0),t.state=m.t.ready,{status:u.e.fail}}):this._complianceTagProvider.lockRecord(e,n).then(function(e){return t.serverData=e?"1":"0",t.state=m.t.ready,{status:u.e.success}},function(e){return e&&t&&(t.serverData=a?"1":"0",t.data="1",t.errorMessage=e.message&&e.message.value?e.message.value:e,t.hasException=!0),t.state=m.t.ready,{status:u.e.fail}})},t.prototype._updateAttachmentsField=function(e,t,n){var a=this;return this._fileUploaderProvider&&this._fileUploaderProvider.hasPendingAttachmentOperations()?(e.state=m.t.saving,this._fileUploaderProvider.executeAttachmentOperations(n===te&&t&&t.properties?Number(t.properties.ID):void 0).then(function(t){return a._fileUploaderProvider.clearAttachmentOperations(),{status:a.handleFileUploaderErrors(t,e,[])?u.e.success:u.e.fail}},function(t){return a._fileUploaderProvider.clearAttachmentOperations(),{status:a.handleFileUploaderErrors(t,e,[])?u.e.success:u.e.fail}})):i.n.wrap(null)},t.prototype.isValidItem=function(e){return e&&e.properties&&e.properties.ID&&"0"!==e.properties.ID},t.prototype.handleFileUploaderErrors=function(e,t,n){var a={attachments:[]},i=!0;if(e.forEach(function(e){e.result||(e.attachment&&a.attachments.push(e.errorMsg),e.image&&(a[e.image.fieldName]=e.errorMsg),i=!1)}),t){if(a.attachments.length>0){var r=a.attachments.reduce(function(e,t){return e+(e?"\r\n":"")+t+"\r\n"},"");t.errorMessage=r,t.hasException=!0}t.state=m.t.ready,M.e.logData({name:"ClientFormUpdate."+t.schema.FieldType.toLowerCase()})}return n.forEach(function(e){a[e.schema.Name]&&(e.errorMessage=a[e.schema.Name],e.hasException=!0),e.state=m.t.ready,M.e.logData({name:"ClientFormUpdate."+e.schema.FieldType.toLowerCase()})}),i},t.prototype._ensureClientForms=function(e){return this._clientForms&&this._contentTypeIdToNameMap&&!this._listContext.refreshClientForm?e?i.n.wrap(e()):i.n.wrap():(this._listContext.refreshClientForm=void 0,e?this.fetchAllClientFormSchemas().then(e):this.fetchAllClientFormSchemas().then(function(){return i.n.wrap()}))},t.prototype._checkRenderModes=function(e){for(var t in this._clientForms)for(var n in this._clientForms[t])if(this._clientForms[t][n].mode===e)return!0;return!1},t.prototype._getFormRenderMode=function(e,t){var n=this._contentTypeIdToNameMap[t],a=this._clientForms[e][n];return a?a.mode:this._checkRenderModes(this._formRenderMode.PowerApp)?this._formRenderMode.PowerApp:this._formRenderMode.Unknown},t.prototype._raiseCreateOrUpdateEvents=function(e,t){var n=e.clientForm;if(t&&t.status===u.e.success&&n){var a=n.item&&n.item.properties&&n.item.properties.ID?n.item.properties.ID:void 0,i=e.itemdIds&&e.itemdIds.length?e.itemdIds.map(String):a?[a]:void 0;i&&j.t.raise(window,n.formType===p.e.newItem?V.e.newItemCreated:V.e.itemUpdated,{itemIds:i})}},t.prototype._updateImages=function(e){return this._fileUploaderProvider&&this._fileUploaderProvider.hasPendingImageOperations()?this._fileUploaderProvider.executeImageOperationsOnSingleItem(e?0:void 0,void 0,e):i.n.wrap([])},t.prototype._updateThumbnailFields=function(e,t,n){var a=this;return this._fileUploaderProvider&&this._fileUploaderProvider.hasPendingImageOperations()?this._fileUploaderProvider.executeImageOperationsOnSingleItem(Number(t.properties.ID),void 0,n).then(function(t){return{status:a.handleFileUploaderErrors(t,null,e)?u.e.success:u.e.fail}},function(t){return{status:a.handleFileUploaderErrors(t,null,e)?u.e.success:u.e.fail}}):i.n.resolve()},t}(l.t);t.t=ce},3315:function(e,t,n){"use strict";n.d(t,"t",function(){return s}),n.d(t,"e",function(){return c});var a=n(6),i=n(52),r=n(2863),o={listContext:i.s,pageContext:i.p},s=new a.t({name:"ClientFormProviderV2",factory:{dependencies:o,create:function(e){var t=e.listContext,n=e.pageContext,a=new r.e({listContext:c(t),pageContext:n});return{instance:a,disposable:a}}}});function c(e){return{listUrl:e.listUrl,listId:e.listId,urlParts:e.urlParts,listTitle:e.listTitle,listTemplateType:e.listTemplateType,isDocLib:e.isDocLib,folderPath:e.folderPath,enableAttachments:!!e.enableAttachments,leftNavigationData:e.leftNavigationData,refreshClientForm:e.refreshClientForm,contentTypesEnabled:e.contentTypesEnabled,tenantTagPolicyEnabled:e.tenantTagPolicyEnabled,allowCreateFolder:e.allowCreateFolder,flags2:e.flags2}}},5296:function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return h});var a=n(53),i=n(0),r=n(111),o=n(248),s=n(33),c=n(227),d=n(2409),l=n(4),u=n(2569),f=n(3315),p=n(2659),m=function(e){function t(t,n){var a=e.call(this,n.pageContext)||this;return a._pageContext=n.pageContext,a}return Object(i.__extends)(t,e),t.prototype.getClientForm=function(e){var t=e.resources,n=e.item,a=e.isBulkEdit,i=e.forceToFetch,r=this._getClientFormParmsV2(n,a),o=new s.e({name:"TMR.getClientForm"});return t.consume(f.t).getClientForm(r,i,!0).then(function(e){return e},function(e){throw o.end(Object(c.e)(e)),e})},t.prototype.setItemExpirationDate=function(e,t){var n,a=Object(o.o)(this._pageContext),i=encodeURI(null===(n=null==e?void 0:e.id)||void 0===n?void 0:n.replace(/'/g,"%27")),r=a+"/_api/web/GetFileByServerRelativeUrl('".concat(i,"')/SetExpirationDate"),s={},c=null;return t&&(c=t.toISOString()),s.expirationDate=c,this.dataRequestor.getData({url:r,parseResponse:function(e){},qosName:"TMR.setItemExpirationDate",additionalPostData:JSON.stringify(s),method:"POST",noRedirect:!0})},t.prototype.clearStoreClientForm=function(e){return r.n.resolve(e.consumeAsync(f.t)).then(function(e){return e.clearStoreClientForm()})},t.prototype.getItemExpirationDate=function(e){var t,n=Object(o.o)(this._pageContext),a=!l.e.isActivated("F60F8874-E998-4128-94B1-00F6CBD5713B","02/14/2023","Replace single quote with %27 to fix the invalid query exception."),i=null==e?void 0:e.id;a&&(i=encodeURI(null===(t=null==e?void 0:e.id)||void 0===t?void 0:t.replace(/'/g,"%27")));var r=n+"/_api/web/GetFileByServerRelativeUrl('".concat(i,"')/ExpirationDate");return this.dataRequestor.getData({url:r,parseResponse:function(e){var t,n=JSON.parse(e);return!!(null===(t=null==n?void 0:n.d)||void 0===t?void 0:t.ExpirationDate)},qosName:"TMR.getItemExpirationDate",method:"GET",noRedirect:!0})},t.prototype._getClientFormParmsV2=function(e,t){var n=Object(p.n)(e),a=e.properties||{};return{clientFormType:d.e.editItem,item:n,itemId:a.ID,contentType:a.ContentType,contentTypeId:a.ContentTypeId,isBulkEdit:t,selection:[n]}},t}(u.e),_=n(52),h=Object(a.r)("ExpirationStore",m,{pageContext:_.p})}}]);