(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[112],{2611:function(e,t,n){"use strict";n.d(t,"k",function(){return r}),n.d(t,"A",function(){return o}),n.d(t,"I",function(){return s}),n.d(t,"h",function(){return c}),n.d(t,"c",function(){return d}),n.d(t,"x",function(){return l}),n.d(t,"f",function(){return u}),n.d(t,"m",function(){return f}),n.d(t,"e",function(){return p}),n.d(t,"a",function(){return m}),n.d(t,"n",function(){return _}),n.d(t,"i",function(){return h}),n.d(t,"t",function(){return b}),n.d(t,"y",function(){return g}),n.d(t,"s",function(){return v}),n.d(t,"p",function(){return y}),n.d(t,"v",function(){return S}),n.d(t,"u",function(){return D}),n.d(t,"l",function(){return I}),n.d(t,"g",function(){return x}),n.d(t,"S",function(){return C}),n.d(t,"D",function(){return O}),n.d(t,"b",function(){return w}),n.d(t,"E",function(){return E}),n.d(t,"w",function(){return A}),n.d(t,"C",function(){return L}),n.d(t,"_",function(){return k}),n.d(t,"L",function(){return M}),n.d(t,"O",function(){return P}),n.d(t,"U",function(){return T}),n.d(t,"d",function(){return U}),n.d(t,"o",function(){return F}),n.d(t,"r",function(){return H}),n.d(t,"M",function(){return R}),n.d(t,"T",function(){return N}),n.d(t,"P",function(){return B});var a=n(222),i=n(4),r=a.a.isFeatureEnabled,o={ODB:817,ODC:!0,OneDrive:!0},s={ODB:60124,ODC:"UseMsPdfViewer",OneDrive:!1,Fallback:!1},c={ODB:60358},d={ODB:1655,ODC:!1,OneDrive:!1,Fallback:!1},l={ECS:1071224},u={ECS:1132624},f={ECS:1161382},p={ECS:1082725},m={ECS:1111474},_={ECS:1116309},h={ECS:1125492},b={ECS:1126891},g={ECS:1161070},v={ODB:1614,ODC:!1,OneDrive:!1,Fallback:!1},y={ODB:1063,ODC:!1,OneDrive:!1,Fallback:!1},S={ODB:1513,ODC:!1,OneDrive:!1,Fallback:!1},D={ODB:1811,ODC:!1,OneDrive:!1,Fallback:!1},I={ODB:1425,ODC:!1,OneDrive:!1,Fallback:!1},x={ODB:61332,ODC:!1,OneDrive:!1,Fallback:!1},C={ODB:60165},O={ODB:60192},w={ODB:61066},E={ODB:1355,ODC:!1,OneDrive:!1,Fallback:!1},A={ODB:61094,ODC:!1,OneDrive:!1,Fallback:!1},L={ODB:!i.e.isActivated("8a90e09f-a635-4113-897e-402973bce841","10/21/2021","Use pdf viewer to preview tiff files"),ODC:!0},k={ODB:1698};function M(){return!i.e.isActivated("d9c17c13-cdd6-4c12-aec1-e636d97e7a9c","09/25/2023","Scoping context work for copilot pane in oneup")}var P={ODB:!0,OneDrive:!0},T={ODB:61113},U={ODB:61210},F={ODB:60655},H={ODB:61300},R={ODB:61125},N={ODB:61217},B={ODB:61146}},2887:function(e,t,n){"use strict";n.d(t,"p",function(){return a}),n.d(t,"f",function(){return i}),n.d(t,"m",function(){return r}),n.d(t,"i",function(){return o}),n.d(t,"o",function(){return s}),n.d(t,"r",function(){return c}),n.d(t,"s",function(){return d}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return u}),n.d(t,"l",function(){return f}),n.d(t,"e",function(){return p}),n.d(t,"n",function(){return m}),n.d(t,"t",function(){return _}),n.d(t,"u",function(){return h}),n.d(t,"_",function(){return b}),n.d(t,"a",function(){return g});var a=.5,i=5,r=90,o=14,s=3,c=7,d=5,l=5,u=150,f=96,p=100,m=1,_=255,h=1e8,b="MsPdfViewer.ZOOM_OPTION_STORE_KEY",g="MsPdfViewer.CACHED_DISPLAY_INFO_ARRAY_STORE_KEY"},3025:function(e,t,n){"use strict";n.d(t,"e",function(){return D}),n.d(t,"t",function(){return I});var a=n(0),i=n(183),r=n(53),o=n(181),s=n(231),c=n(699),d=n(3223),l=n(161),u=n(2611),f=n(3274),p=n(85),m=n(45),_=n(975),h=n(3251),b=n(3120),g=n(3275),v=n(2887),y=".pdf",S=["ODBLightSpeedWebPack","TeamsODBFileBrowserWebPack"],D=function(){function e(e,t){this.isWorkerVersionMismatch=function(e){var t,n=null===(t=window._spModuleLink)||void 0===t?void 0:t.buildNumber;return"dev"!==n&&!(!e||!n)&&e!==n},this._enablePdf=Object(u.k)(u.A),this._enableMsPdfviewer=Object(u.k)(u.I),this._enableEmbedMsPdfviewer=Object(u.k)(u.c),this._enableEditPdf=Object(u.k)(u.s),this._enableExtractPdf=Object(u.k)(u.v),this._enablePreviewTif=Object(u.k)(u.C),this._enableHTML=Object(u.k)(u.O)&&(Object(f.e)()||t.platformDetection.isEdge),this._urlDataSource=t.urlDataSource,this._pdfDataSource=t.pdfDataSource,this._navigation=t.navigation,this._viewParams=this._navigation.viewParams,this._platformDetection=t.platformDetection,this._pageContext=t.pageContext,this._embedOptions=t.embedOptions}return e.isWasmSupported=function(){if(void 0===e._isWasmSupported){var t=!1;try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){var n=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));n instanceof WebAssembly.Module&&(t=new WebAssembly.Instance(n)instanceof WebAssembly.Instance)}}catch(e){}e._isWasmSupported=t}return e._isWasmSupported},e.prototype.isNotEmbed=function(){return this._urlDataSource.getPageType(this._viewParams)!==l.e.Embed},e.prototype.isSupportedFileType=function(e){var t=this._extension(e);return this._enablePdf&&(t===y||".ai"===t||!!e.pdfConversion)&&(this._enablePreviewTif||".tif"!==t&&".tiff"!==t)},e.prototype.isDownloadByRangeEnabled=function(e){if(!(Object(u.k)(u.u)||!this.isNotEmbed()&&Object(g.e)(u.f.ECS))||!e.size)return!1;var t=this._platformDetection.isMobile?10485760:31457280;return e.size>t&&!e.pdfConversion},e.prototype.isPreviewerEnabled=function(e){if(!(Object(u.k)(u.g)||!this.isNotEmbed()&&Object(g.e)(u.m.ECS))||!e.size)return!1;var t=this._platformDetection.isMobile?20971520:209715200;return e.size>t&&!e.pdfConversion},e.prototype.isMsPdfViewerSupported=function(e){var t;if(!e)return!1;var n=this._enableMsPdfviewer&&(this.isNotEmbed()||this._enableEmbedMsPdfviewer),a=this._isHostAppTeams()&&Object(g.e)(u.x.ECS),i=!Object(b.r)()&&!Object(g.t)(u.e.ECS)&&!this.isNotEmbed()&&((null===(t=this._embedOptions)||void 0===t?void 0:t.useMsPdf)||!1);return(n||a||i)&&this._isMsPdfViewerSupported(e)},e.prototype.isMsPdfViewerAvailable=function(e){return this.isSupportedFileType(e)&&this._isEnabledInOneUp(e)&&this.isMsPdfViewerSupported(e.size)},e.prototype.isPdfEditAvailable=function(e){var t=!!e.size&&e.size<=v.u;return this.isMsPdfViewerAvailable(e)&&(this._enableEditPdf||!this.isNotEmbed()&&!Object(b.n)()&&!Object(g.t)(u.a.ECS))&&this._extension(e)===y&&t},e.prototype.isPdfExtractAvailable=function(e){return this.hasSyntexLicense()&&this.isMsPdfViewerAvailable(e)&&this.isNotEmbed()&&this._enableExtractPdf},e.prototype.isPdfExtractable=function(){return this.hasSyntexLicense()&&this._enableExtractPdf},e.prototype.isPdfEditable=function(e){var t;return e.itemStatus!==i.t.ConditionalAccessViewOnly&&e.itemStatus!==i.t.ConditionalAccessBlocked&&(null===(t=this._pdfDataSource)||void 0===t?void 0:t.canSave({item:e}))},e.prototype.getWorkerManifestName=function(){var e,t=(null===(e=window._spModuleLink)||void 0===e?void 0:e.manifestName)||"";return Object(u.k)(u.h)&&-1!==S.indexOf(t)?"odbmspdfwebworker":"mspdfwebworker"},e.prototype.getEmbedOptions=function(){return this._embedOptions},e.prototype.hasSyntexLicense=function(){var e,t;return(null===(e=this._pageContext)||void 0===e?void 0:e.canUserUseSyntex)||Object(b.d)()&&(null===(t=this._pageContext)||void 0===t?void 0:t.isUserSyntexV2Licensed)||!1},e.prototype._isHostAppTeams=function(){if(this.isNotEmbed())return!1;var e=this._getClientId();return!!e&&-1!==["MicrosoftTeams","Microsoft Teams","Microsoft Teams Web Client","Teams Service","Teams Client App","Teams Additional Client App","Teams App"].indexOf(e)},e.prototype._isEnabledInOneUp=function(e){return!(e.officeBundle||e.wopiFrameUrl||this._enableHTML&&e.htmlConversion)},e.prototype._isMsPdfViewerSupported=function(t){if(!t)return!1;var n=t<(performance.memory?performance.memory.jsHeapSizeLimit-performance.memory.totalJSHeapSize:268435456)/4;return e.isWasmSupported()&&n},e.prototype._extension=function(e){return e&&e.extension&&e.extension.toLowerCase()||""},e.prototype._getClientId=function(){var e,t=(null===(e=this._pageContext)||void 0===e?void 0:e.authToken)||"",n=Object(c.a)(t);return n&&n.app_displayname||this._getClientIdFromQSP()},e.prototype._getClientIdFromQSP=function(){var e,t=window,n=Object(s.e)((t.location.search||"").slice(1)),i=Object(s.e)((t.location.hash||"").slice(1)),r=(null===(e=t.PageContext)||void 0===e?void 0:e.scenarioContext.embed)||{};return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},n),i),r).client_id},e.dependencies={},e}(),I=Object(r.r)("PdfViewerHelper",D,{platformDetection:o.e,urlDataSource:_.e,navigation:p.e,pdfDataSource:h.e,pageContext:m.e.optional,embedOptions:d.e.optional})},3120:function(e,t,n){"use strict";n.d(t,"r",function(){return i}),n.d(t,"d",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"o",function(){return d}),n.d(t,"s",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"c",function(){return f}),n.d(t,"t",function(){return p});var a=n(4),i=function(){return a.e.isActivated("c3dc126d-70db-4dc6-9ad6-3ce6d59dfaca")},r=function(){return!a.e.isActivated("acc3d562-8099-40b9-ad90-f199e8fcec91","6/15/2023","Syntex V2 License check")},o=function(){return a.e.isActivated("f644d6f3-bfb2-4b67-9ea4-f2bbd98431b0","07/17/2023","Enable editing for mspdf in embed scenarios")},s=function(){return a.e.isActivated("106d45a3-37c3-42cd-95a6-8a04645f8a7b","08/07/2023","Enable host saving for embedded scenarios")},c=function(){return a.e.isActivated("ed408543-0a69-47e8-a898-31bf63f74ce6","08/28/2023","Enable sending PDF related notifications to host for embedded scenarios")},d=function(){return a.e.isActivated("7734ec9d-6955-4473-9ea5-1c21baf2af07","08/31/2023","Fix page content with some Chinese characters cannot be rendered")},l=function(){return a.e.isActivated("facbf24e-8794-4b51-9003-45d3abd49d9b","09/28/2023","Fix sharee can not save pdf change")},u=function(){return a.e.isActivated("58d82ac9-f371-4727-bb77-44cddd470f04","10/19/2023","Allow unloading page with edits for embedded scenarios")},f=function(){return a.e.isActivated("8ba1d3e7-57fd-495f-953b-beb4d093e5e7","11/24/2023","Set pdf unloaded when pdf viewer disposed")},p=function(){return a.e.isActivated("0e5640e9-b84f-4cd2-abf5-46e9e6177353","12/02/2023","Do not send version request for view only PDF")}},3222:function(e,t,n){"use strict";n.d(t,"t",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"n",function(){return u});var a=n(53),i=n(2239),r=n(356),o=n(3313),s=n(16),c=n(3025),d=function(e){return"ZXNpZ24"===e()[s.n.navParamKey]},l=function(){function e(e,t){var n=this;this.isWorkerVersionMismatch=function(e){return n._corePdfViewerHelper.isWorkerVersionMismatch(e)};var a=t.observablesFactoryType,i=t.viewParams,r=new a;this._corePdfViewerHelper=t.corePdfViewerHelper;var s=this.getEmbedOptions(),c=(null==s?void 0:s.allowEdit)&&(null==s?void 0:s.openInEditMode),l=d(i)?o.e.Esign:c?o.e.Edit:o.e.View;this.state={isOpened:r.create(!1),currentMode:r.create(l),filePickerMode:r.create("close"),protectedPdf:r.create(!1),mipPdf:r.create(!1)}}return e.isWasmSupported=function(){return c.e.isWasmSupported()},e.prototype.isMsPdfViewerAvailable=function(e){return this._corePdfViewerHelper.isMsPdfViewerAvailable(this._convertItem(e))},e.prototype.isMsPdfViewerSupported=function(e){return this._corePdfViewerHelper.isMsPdfViewerSupported(e)},e.prototype.isNotEmbed=function(){return this._corePdfViewerHelper.isNotEmbed()},e.prototype.isPdfEditAvailable=function(e){return this._corePdfViewerHelper.isPdfEditAvailable(this._convertItem(e))},e.prototype.isPdfEditable=function(e){return this._corePdfViewerHelper.isPdfEditable(this._convertItem(e))&&!this.state.mipPdf()},e.prototype.isSupportedFileType=function(e){return this._corePdfViewerHelper.isSupportedFileType(this._convertItem(e))},e.prototype.isDownloadByRangeEnabled=function(e){return this._corePdfViewerHelper.isDownloadByRangeEnabled(this._convertItem(e))},e.prototype.getWorkerManifestName=function(){return this._corePdfViewerHelper.getWorkerManifestName()},e.prototype.getEmbedOptions=function(){return this._corePdfViewerHelper.getEmbedOptions()},e.prototype.isPdfExtractAvailable=function(e){return this._corePdfViewerHelper.isPdfExtractAvailable(this._convertItem(e))},e.prototype.isPdfExtractable=function(){return this._corePdfViewerHelper.isPdfExtractable()},e.prototype.hasSyntexLicense=function(){return this._corePdfViewerHelper.hasSyntexLicense()},e.prototype._convertItem=function(e){return e},e.dependencies={observablesFactoryType:i.i,viewParams:r.P,corePdfViewerHelper:c.t},e}(),u=Object(a.r)("PdfViewerHelper",l)},3223:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(6).t)("pdfViewerEmbedOptions")},3251:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(53),r=n(51),o=function(){function e(){}return e.prototype.canSave=function(e){return this.canSaveAsOriginal(e)},e}(),s=n(45),c=function(e){function t(t,n){var a=e.call(this)||this;return a._pageContext=n.pageContext,a}return Object(a.__extends)(t,e),t.prototype.canSaveAsOriginal=function(e){var t,n=e.item;return!!n&&r.e.hasItemPermission(n,r.e.insertListItems)&&r.e.hasItemPermission(n,r.e.editListItems)&&!(null===(t=this._pageContext)||void 0===t?void 0:t.isAnonymousGuestUser)},t}(o),d=Object(i.r)("PdfDataSource",c,{pageContext:s.e.optional})},3274:function(e,t,n){"use strict";var a;function i(){return"boolean"!=typeof a&&(a="srcdoc"in document.createElement("iframe")),a}n.d(t,"e",function(){return i})},3275:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i});var a=function(e){var t,n,a,i;if(!e)return!1;var r=(null===(t=window.Flight)||void 0===t?void 0:t.ecsConfig)&&JSON.parse(null===(n=window.Flight)||void 0===n?void 0:n.ecsConfig),o=null===(i=null===(a=null==r?void 0:r.RolloutContext)||void 0===a?void 0:a.settings)||void 0===i?void 0:i.ODSPMicroservices_ODWeb;return o&&!0===o[e]},i=function(e){return a(e)}},3313:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.View=0]="View",e[e.Edit=1]="Edit",e[e.Extract=2]="Extract",e[e.Esign=3]="Esign"}(a||(a={}))},3680:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(2239),i=new(n(6).t)({name:"".concat("UniversalAnnotationStateKey",".universalAnnotationState"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:{isUniversalAnnotationActive:t.create(!1),hasPreloadSucceeded:t.create(!0)},disposable:t}}}})},4257:function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"n",function(){return l});var a=n(2611),i=n(96),r=n(25),o=n(4);function s(e,t,n,s,c,d){var l,u=t||{},f=u.isSyntexPAYGEnabled,p=u.isSyntexESignatureEnabled,m=u.webTemplate,_=u.listBaseTemplate,h=u.cloudType,b=u.isExternalGuestUser;return!(o.e.isActivated("FE5BDF48-187F-4F55-B5B7-A4EFDFFAE1FD","11/14/2023","Disable e-signature")||n||!Object(a.k)(a.b)||!f||!p||b||m===i.t.mySite.toString()||_===r.t.mySiteDocumentLibrary||".pdf"!==(null===(l=null==e?void 0:e.extension)||void 0===l?void 0:l.toLowerCase())||!c||!c()||d||s||!function(e){if(o.e.isActivated("2AC9DFE6-103D-4580-B6BB-8BACB5CC54A0","11/14/2023","Disable cloud type checking for e-signature"))return!0;if(!e)return!1;switch(e){default:return!1;case"edog":case"spdf":case"prodbubble":case"prod":return!0}}(null==h?void 0:h.toLowerCase()))}function c(e,t,n,a,i,r){return s(e,t,n,a,i,r)}function d(e,t,n,i,r,o){return s(e,t,n,i,r,o)&&Object(a.k)(a.S)}function l(e,t,n,i,r,o){return s(e,t,n,i,r,o)&&Object(a.k)(a.D)}},5604:function(e,t,n){"use strict";var a=n(0),i=n(5605),r=n(145),o=function(){function e(e,t,n){this._defaultAccessTokenExpiration=3600,this._baseUrl="https://".concat(n,"/").concat(e),this._tokenName="".concat(e,"Token"),this._accessToken=t,this._provider=e}return e.prototype.createDraftAgreement=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e?[4,this.getItemContentAsBlob(e)]:[2];case 1:return(t=a.sent())?(this.getProviderAccessToken(function(a){var i,r={provider:n._provider,getAuthorization:function(){return"Bearer ".concat(n._accessToken.accessToken)},providerBaseUrl:a.apiBaseUrl,get3pAuthorization:function(){return a.accessToken}};n.createAgreement(r,t,null!==(i=e.name)&&void 0!==i?i:"document.pdf")}),[2]):[2]}})})},e.prototype.createAgreement=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this.sendDocumentToThirdParty(e,t,n)];case 1:return(i=a.sent())?[4,this.createSigningRequest(e,i,n)]:[2];case 2:return(null==(r=a.sent())?void 0:r.url)?(window.open(r.url,"".concat(this._provider,"Window")),[2]):[2]}})})},e.prototype.sendDocumentToThirdParty=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return r=new i.LibraryDocumentClient(e,this._baseUrl),o={data:t,fileName:n},[4,r.createLibraryDocument(o)];case 1:return[2,a.sent()]}})})},e.prototype.exchangeAuthCodeForAccessToken=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,r,o=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t={provider:this._provider,getAuthorization:function(){return"Bearer ".concat(o._accessToken.accessToken)},providerBaseUrl:"",get3pAuthorization:function(){return""}},n=new i.OAuthTokenClient(t,this._baseUrl),r={clientCode:e},[4,n.getOAuthToken(r)];case 1:return[2,a.sent()]}})})},e.prototype.refreshProviderAccessToken=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t={provider:this._provider,getAuthorization:function(){return"Bearer ".concat(n._accessToken.accessToken)},providerBaseUrl:e.apiBaseUrl,get3pAuthorization:function(){return""}},[4,new i.OAuthTokenClient(t,this._baseUrl).refreshOAuthToken(e.refreshTokenCipher)];case 1:return[2,a.sent()]}})})},e.prototype.addExpirationToToken=function(e){var t,n=Date.now()+1e3*(null!==(t=e.expiresIn)&&void 0!==t?t:this._defaultAccessTokenExpiration);return Object(a.__assign)(Object(a.__assign)({},e),{expiresAt:n})},e.prototype.createSigningRequest=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return r=new i.SigningRequestClient(e,this._baseUrl),o={documents:[{LibraryDocumentId:t,Name:n}],status:"draft"},[4,r.createSigningRequest(o)];case 1:return s=a.sent(),[4,r.getSigningRequest(s)];case 2:return[2,a.sent()]}})})},e.prototype.getItemContentAsBlob=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return e.openUrl?[4,fetch(e.openUrl)]:[2];case 1:return[4,n.sent().arrayBuffer()];case 2:return t=n.sent(),[2,new Blob([t],{type:"application/pdf"})]}})})},e.prototype.getProviderAccessToken=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i,o,s,c=this;return Object(a.__generator)(this,function(d){switch(d.label){case 0:return t=localStorage.getItem(this._tokenName),(n=t&&JSON.parse(t))&&n.expiresAt>Date.now()?(e(n),[2]):n?[4,this.refreshProviderAccessToken(n)]:[3,2];case 1:return(i=d.sent())?((i=this.addExpirationToToken(i)).apiBaseUrl=n.apiBaseUrl,localStorage.setItem(this._tokenName,JSON.stringify(i)),e(i),[2]):[2];case 2:return o=function(t){return Object(a.__awaiter)(c,void 0,void 0,function(){var n,i,r,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return this._baseUrl.startsWith(t.origin)?(n=t.data,i=localStorage.getItem("thirdPartyNonceState"),n.nonce!==i?[2]:[4,this.exchangeAuthCodeForAccessToken(n.code)]):[2];case 1:return r=a.sent(),localStorage.removeItem("thirdPartyNonceState"),r?(s=this.addExpirationToToken(r),localStorage.setItem(this._tokenName,JSON.stringify(s)),e(s),window.removeEventListener("message",o),[2]):[2]}})})},s=r.e.generate(),localStorage.setItem("thirdPartyNonceState",s),window.open("".concat(this._baseUrl,"/oauth/Start?nonce=").concat(s),"ProviderLoginScreen","width=600,height=600"),window.addEventListener("message",o),[2]}})})},e}();t.e=o},5605:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IConfig=t.ServiceClientBase=t.ServiceException=t.FormFieldType=t.UserRole=t.SigningRequestStatus=t.RecipientRoleStatus=t.RecipientRole=t.TemplatesClient=t.SigningRequestDocumentFormFieldsClient=t.SigningRequestDocumentClient=t.SigningRequestClient=t.OAuthTokenClient=t.MyInfoClient=t.LibraryDocumentClient=t.AuthorizedApiBase=void 0;class a{constructor(e){this.transformOptions=e=>(e.headers=Object.assign(Object.assign({},e.headers),{Authorization:this.config.getAuthorization(),"x-provider-token":this.config.get3pAuthorization(),"x-provider-base-url":this.config.providerBaseUrl}),Promise.resolve(e)),this.config=e}}var i,r,o,s,c;t.AuthorizedApiBase=a,t.LibraryDocumentClient=class extends a{constructor(e,t,n){super(e),this.jsonParseReviver=void 0,this.http=n||window,this.baseUrl=null!=t?t:""}createLibraryDocument(e){let t=this.baseUrl+"/librarydocuments";t=t.replace(/[?&]$/,"");const n=new FormData;if(null==e)throw new Error("The parameter 'formFile' cannot be null.");n.append("formFile",e.data,e.fileName?e.fileName:"formFile");let a={body:n,method:"POST",headers:{Accept:"application/json"}};return this.transformOptions(a).then(e=>this.http.fetch(t,e)).then(e=>this.processCreateLibraryDocument(e))}processCreateLibraryDocument(e){const t=e.status;let n={};return e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),200===t?e.text().then(e=>{let t=null;return t=""===e?null:JSON.parse(e,this.jsonParseReviver),t}):200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}},t.MyInfoClient=class extends a{constructor(e,t,n){super(e),this.jsonParseReviver=void 0,this.http=n||window,this.baseUrl=null!=t?t:""}getMyInfo(){let e=this.baseUrl+"/myinfo";return e=e.replace(/[?&]$/,""),this.transformOptions({method:"GET",headers:{Accept:"application/json"}}).then(t=>this.http.fetch(e,t)).then(e=>this.processGetMyInfo(e))}processGetMyInfo(e){const t=e.status;let n={};return e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),200===t?e.text().then(e=>{let t=null;return t=""===e?null:JSON.parse(e,this.jsonParseReviver),t}):200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}},t.OAuthTokenClient=class extends a{constructor(e,t,n){super(e),this.jsonParseReviver=void 0,this.http=n||window,this.baseUrl=null!=t?t:""}getOAuthToken(e){let t=this.baseUrl+"/oauth/token";t=t.replace(/[?&]$/,"");let n={body:JSON.stringify(e),method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}};return this.transformOptions(n).then(e=>this.http.fetch(t,e)).then(e=>this.processGetOAuthToken(e))}processGetOAuthToken(e){const t=e.status;let n={};return e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),200===t?e.text().then(e=>{let t=null;return t=""===e?null:JSON.parse(e,this.jsonParseReviver),t}):200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}refreshOAuthToken(e){let t=this.baseUrl+"/oauth/refreshtoken";t=t.replace(/[?&]$/,"");let n={body:JSON.stringify(e),method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}};return this.transformOptions(n).then(e=>this.http.fetch(t,e)).then(e=>this.processRefreshOAuthToken(e))}processRefreshOAuthToken(e){const t=e.status;let n={};return e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),200===t?e.text().then(e=>{let t=null;return t=""===e?null:JSON.parse(e,this.jsonParseReviver),t}):200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}startThirdPartyLogin(e){let t=this.baseUrl+"/{provider}/oauth/start";if(null==e)throw new Error("The parameter 'provider' must be defined.");return t=t.replace("{provider}",encodeURIComponent(""+e)),t=t.replace(/[?&]$/,""),this.transformOptions({method:"GET",headers:{Accept:"application/octet-stream"}}).then(e=>this.http.fetch(t,e)).then(e=>this.processStartThirdPartyLogin(e))}processStartThirdPartyLogin(e){const t=e.status;let n={};if(e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),200===t||206===t){const a=e.headers?e.headers.get("content-disposition"):void 0;let i=a?/filename\*=(?:(\\?['"])(.*?)\1|(?:[^\s]+'.*?')?([^;\n]*))/g.exec(a):void 0,r=i&&i.length>1?i[3]||i[2]:void 0;return r?r=decodeURIComponent(r):(i=a?/filename="?([^"]*?)"?(;|$)/g.exec(a):void 0,r=i&&i.length>1?i[1]:void 0),e.blob().then(e=>({fileName:r,data:e,status:t,headers:n}))}return 200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}endPartyLogin(e,t){let n=this.baseUrl+"/oauth/end?";if(null==e)throw new Error("The parameter 'code' must be defined and cannot be null.");if(n+="code="+encodeURIComponent(""+e)+"&",null==t)throw new Error("The parameter 'state' must be defined and cannot be null.");return n+="state="+encodeURIComponent(""+t)+"&",n=n.replace(/[?&]$/,""),this.transformOptions({method:"GET",headers:{Accept:"application/octet-stream"}}).then(e=>this.http.fetch(n,e)).then(e=>this.processEndPartyLogin(e))}processEndPartyLogin(e){const t=e.status;let n={};if(e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),200===t||206===t){const a=e.headers?e.headers.get("content-disposition"):void 0;let i=a?/filename\*=(?:(\\?['"])(.*?)\1|(?:[^\s]+'.*?')?([^;\n]*))/g.exec(a):void 0,r=i&&i.length>1?i[3]||i[2]:void 0;return r?r=decodeURIComponent(r):(i=a?/filename="?([^"]*?)"?(;|$)/g.exec(a):void 0,r=i&&i.length>1?i[1]:void 0),e.blob().then(e=>({fileName:r,data:e,status:t,headers:n}))}return 200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}},t.SigningRequestClient=class extends a{constructor(e,t,n){super(e),this.jsonParseReviver=void 0,this.http=n||window,this.baseUrl=null!=t?t:""}getSigningRequest(e){let t=this.baseUrl+"/signingrequests/{id}";if(null==e)throw new Error("The parameter 'id' must be defined.");return t=t.replace("{id}",encodeURIComponent(""+e)),t=t.replace(/[?&]$/,""),this.transformOptions({method:"GET",headers:{Accept:"application/json"}}).then(e=>this.http.fetch(t,e)).then(e=>this.processGetSigningRequest(e))}processGetSigningRequest(e){const t=e.status;let n={};return e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),200===t?e.text().then(e=>{let t=null;return t=""===e?null:JSON.parse(e,this.jsonParseReviver),t}):200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}deleteSigningRequest(e){let t=this.baseUrl+"/signingrequests/{id}";if(null==e)throw new Error("The parameter 'id' must be defined.");return t=t.replace("{id}",encodeURIComponent(""+e)),t=t.replace(/[?&]$/,""),this.transformOptions({method:"DELETE",headers:{}}).then(e=>this.http.fetch(t,e)).then(e=>this.processDeleteSigningRequest(e))}processDeleteSigningRequest(e){const t=e.status;let n={};return e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),200===t?e.text().then(e=>{}):200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}listSigningRequests(e,t,n,a,i,r){let o=this.baseUrl+"/signingrequests?";if(null===e)throw new Error("The parameter 'equalityContract' cannot be null.");return void 0!==e&&(o+="equalityContract="+encodeURIComponent(""+e)+"&"),null!=t&&(o+="maxPageSize="+encodeURIComponent(""+t)+"&"),null!=n&&n&&n.forEach(e=>{o+="orderBy="+encodeURIComponent(""+e)+"&"}),null!=a&&(o+="skip="+encodeURIComponent(""+a)+"&"),null!=i&&(o+="top="+encodeURIComponent(""+i)+"&"),null!=r&&r&&r.forEach(e=>{o+="userRoles="+encodeURIComponent(""+e)+"&"}),o=o.replace(/[?&]$/,""),this.transformOptions({method:"GET",headers:{Accept:"application/json"}}).then(e=>this.http.fetch(o,e)).then(e=>this.processListSigningRequests(e))}processListSigningRequests(e){const t=e.status;let n={};return e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),200===t?e.text().then(e=>{let t=null;return t=""===e?null:JSON.parse(e,this.jsonParseReviver),t}):200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}createSigningRequest(e){let t=this.baseUrl+"/signingrequests";t=t.replace(/[?&]$/,"");let n={body:JSON.stringify(e),method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}};return this.transformOptions(n).then(e=>this.http.fetch(t,e)).then(e=>this.processCreateSigningRequest(e))}processCreateSigningRequest(e){const t=e.status;let n={};return e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),201===t?e.text().then(e=>{let t=null;return t=""===e?null:JSON.parse(e,this.jsonParseReviver),t}):200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}cancelSigningRequest(e,t){let n=this.baseUrl+"/signingrequests/{id}/:cancel";if(null==e)throw new Error("The parameter 'id' must be defined.");n=n.replace("{id}",encodeURIComponent(""+e)),n=n.replace(/[?&]$/,"");let a={body:JSON.stringify(t),method:"POST",headers:{"Content-Type":"application/json"}};return this.transformOptions(a).then(e=>this.http.fetch(n,e)).then(e=>this.processCancelSigningRequest(e))}processCancelSigningRequest(e){const t=e.status;let n={};return e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),200===t?e.text().then(e=>{}):200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}declineSigningRequest(e,t){let n=this.baseUrl+"/signingrequests/{id}/:decline";if(null==e)throw new Error("The parameter 'id' must be defined.");n=n.replace("{id}",encodeURIComponent(""+e)),n=n.replace(/[?&]$/,"");let a={body:JSON.stringify(t),method:"POST",headers:{"Content-Type":"application/json"}};return this.transformOptions(a).then(e=>this.http.fetch(n,e)).then(e=>this.processDeclineSigningRequest(e))}processDeclineSigningRequest(e){const t=e.status;let n={};return e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),200===t?e.text().then(e=>{}):200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}},t.SigningRequestDocumentClient=class extends a{constructor(e,t,n){super(e),this.jsonParseReviver=void 0,this.http=n||window,this.baseUrl=null!=t?t:""}getSigningRequestDocument(e,t){let n=this.baseUrl+"/signingrequests/{id}/documents/{documentId}";if(null==e)throw new Error("The parameter 'id' must be defined.");if(n=n.replace("{id}",encodeURIComponent(""+e)),null==t)throw new Error("The parameter 'documentId' must be defined.");return n=n.replace("{documentId}",encodeURIComponent(""+t)),n=n.replace(/[?&]$/,""),this.transformOptions({method:"GET",headers:{Accept:"application/octet-stream"}}).then(e=>this.http.fetch(n,e)).then(e=>this.processGetSigningRequestDocument(e))}processGetSigningRequestDocument(e){const t=e.status;let n={};if(e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),200===t||206===t){const a=e.headers?e.headers.get("content-disposition"):void 0;let i=a?/filename\*=(?:(\\?['"])(.*?)\1|(?:[^\s]+'.*?')?([^;\n]*))/g.exec(a):void 0,r=i&&i.length>1?i[3]||i[2]:void 0;return r?r=decodeURIComponent(r):(i=a?/filename="?([^"]*?)"?(;|$)/g.exec(a):void 0,r=i&&i.length>1?i[1]:void 0),e.blob().then(e=>({fileName:r,data:e,status:t,headers:n}))}return 200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}createOrUpdateSigningRequestDocument(e,t,n){let a=this.baseUrl+"/signingrequests/{id}/documents/{documentId}";if(null==e)throw new Error("The parameter 'id' must be defined.");if(a=a.replace("{id}",encodeURIComponent(""+e)),null==t)throw new Error("The parameter 'documentId' must be defined.");a=a.replace("{documentId}",encodeURIComponent(""+t)),a=a.replace(/[?&]$/,"");let i={body:JSON.stringify(n),method:"PUT",headers:{"Content-Type":"application/json"}};return this.transformOptions(i).then(e=>this.http.fetch(a,e)).then(e=>this.processCreateOrUpdateSigningRequestDocument(e))}processCreateOrUpdateSigningRequestDocument(e){const t=e.status;let n={};return e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),200===t?e.text().then(e=>{}):200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}deleteSigningRequestDocument(e,t){let n=this.baseUrl+"/signingrequests/{id}/documents/{documentId}";if(null==e)throw new Error("The parameter 'id' must be defined.");if(n=n.replace("{id}",encodeURIComponent(""+e)),null==t)throw new Error("The parameter 'documentId' must be defined.");return n=n.replace("{documentId}",encodeURIComponent(""+t)),n=n.replace(/[?&]$/,""),this.transformOptions({method:"DELETE",headers:{}}).then(e=>this.http.fetch(n,e)).then(e=>this.processDeleteSigningRequestDocument(e))}processDeleteSigningRequestDocument(e){const t=e.status;let n={};return e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),200===t?e.text().then(e=>{}):200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}listSigningRequestDocuments(e){let t=this.baseUrl+"/signingrequests/{id}/documents";if(null==e)throw new Error("The parameter 'id' must be defined.");return t=t.replace("{id}",encodeURIComponent(""+e)),t=t.replace(/[?&]$/,""),this.transformOptions({method:"GET",headers:{Accept:"application/json"}}).then(e=>this.http.fetch(t,e)).then(e=>this.processListSigningRequestDocuments(e))}processListSigningRequestDocuments(e){const t=e.status;let n={};return e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),200===t?e.text().then(e=>{let t=null;return t=""===e?null:JSON.parse(e,this.jsonParseReviver),t}):200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}},t.SigningRequestDocumentFormFieldsClient=class extends a{constructor(e,t,n){super(e),this.jsonParseReviver=void 0,this.http=n||window,this.baseUrl=null!=t?t:""}listSigningRequestDocumentFormFields(e,t,n){let a=this.baseUrl+"/{provider}/signingrequests/{id}/documents/{documentId}/formfields";if(null==e)throw new Error("The parameter 'provider' must be defined.");if(a=a.replace("{provider}",encodeURIComponent(""+e)),null==t)throw new Error("The parameter 'id' must be defined.");if(a=a.replace("{id}",encodeURIComponent(""+t)),null==n)throw new Error("The parameter 'documentId' must be defined.");return a=a.replace("{documentId}",encodeURIComponent(""+n)),a=a.replace(/[?&]$/,""),this.transformOptions({method:"GET",headers:{Accept:"application/json"}}).then(e=>this.http.fetch(a,e)).then(e=>this.processListSigningRequestDocumentFormFields(e))}processListSigningRequestDocumentFormFields(e){const t=e.status;let n={};return e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),200===t?e.text().then(e=>{let t=null;return t=""===e?null:JSON.parse(e,this.jsonParseReviver),t}):200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}updateSigningRequestDocumentFormFields(e,t,n,a){let i=this.baseUrl+"/{provider}/signingrequests/{id}/documents/{documentId}/formfields";if(null==e)throw new Error("The parameter 'provider' must be defined.");if(i=i.replace("{provider}",encodeURIComponent(""+e)),null==t)throw new Error("The parameter 'id' must be defined.");if(i=i.replace("{id}",encodeURIComponent(""+t)),null==n)throw new Error("The parameter 'documentId' must be defined.");i=i.replace("{documentId}",encodeURIComponent(""+n)),i=i.replace(/[?&]$/,"");let r={body:JSON.stringify(a),method:"PUT",headers:{"Content-Type":"application/json"}};return this.transformOptions(r).then(e=>this.http.fetch(i,e)).then(e=>this.processUpdateSigningRequestDocumentFormFields(e))}processUpdateSigningRequestDocumentFormFields(e){const t=e.status;let n={};return e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),200===t?e.text().then(e=>{}):200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}},t.TemplatesClient=class extends a{constructor(e,t,n){super(e),this.jsonParseReviver=void 0,this.http=n||window,this.baseUrl=null!=t?t:""}listTemplates(e,t,n,a,i,r){let o=this.baseUrl+"/templates?";if(null===e)throw new Error("The parameter 'equalityContract' cannot be null.");return void 0!==e&&(o+="equalityContract="+encodeURIComponent(""+e)+"&"),null!=t&&(o+="maxPageSize="+encodeURIComponent(""+t)+"&"),null!=n&&n&&n.forEach(e=>{o+="orderBy="+encodeURIComponent(""+e)+"&"}),null!=a&&(o+="skip="+encodeURIComponent(""+a)+"&"),null!=i&&(o+="top="+encodeURIComponent(""+i)+"&"),null!=r&&r&&r.forEach(e=>{o+="userRoles="+encodeURIComponent(""+e)+"&"}),o=o.replace(/[?&]$/,""),this.transformOptions({method:"GET",headers:{Accept:"application/json"}}).then(e=>this.http.fetch(o,e)).then(e=>this.processListTemplates(e))}processListTemplates(e){const t=e.status;let n={};return e.headers&&e.headers.forEach&&e.headers.forEach((e,t)=>n[t]=e),200===t?e.text().then(e=>{let t=null;return t=""===e?null:JSON.parse(e,this.jsonParseReviver),t}):200!==t&&204!==t?e.text().then(e=>l("An unexpected server error occurred.",t,e,n)):Promise.resolve(null)}},(c=t.RecipientRole||(t.RecipientRole={}))[c.Signer=0]="Signer",c[c.Approver=1]="Approver",c[c.CarbonCopy=2]="CarbonCopy",(s=t.RecipientRoleStatus||(t.RecipientRoleStatus={}))[s.Waiting=0]="Waiting",s[s.Received=1]="Received",s[s.Approved=2]="Approved",s[s.Signed=3]="Signed",s[s.Declined=4]="Declined",(o=t.SigningRequestStatus||(t.SigningRequestStatus={}))[o.Draft=0]="Draft",o[o.Sent=1]="Sent",o[o.Signed=2]="Signed",o[o.Declined=3]="Declined",o[o.Voided=4]="Voided",(r=t.UserRole||(t.UserRole={}))[r.Sender=0]="Sender",r[r.Signer=1]="Signer",r[r.Approver=2]="Approver",r[r.CarbonCopy=3]="CarbonCopy",(i=t.FormFieldType||(t.FormFieldType={}))[i.Signature=0]="Signature",i[i.Initials=1]="Initials",i[i.Name=2]="Name",i[i.Email=3]="Email",i[i.Date=4]="Date";class d extends Error{constructor(e,t,n,a,i){super(),this.isServiceException=!0,this.message=e,this.status=t,this.response=n,this.headers=a,this.result=i}static isServiceException(e){return!0===e.isServiceException}}function l(e,t,n,a,i){throw null!=i?i:new d(e,t,n,a,null)}t.ServiceException=d,t.ServiceClientBase=class{constructor(e,t){this.baseURL=e,this.provider=t}},t.IConfig=class{constructor(e,t,n,a,i){this.getAuthorization=e,this.get3pAuthorization=t,this.provider=a,this.providerBaseUrl=i}}},7249:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(2262),r=n(111),o=n(33),s=n(181),c=n(52),d=n(2267),l=n(3680),u=n(4257),f=n(600),p=n(3222),m=n(360),_=n(5604),h=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a,i,r=this;(r=e.call(this,t,n)||this).name="SendForSignatureAdobe",r._itemSelectionHelper=new(r.child(d.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});var o=n.engagement,s=void 0===o?r.resources.consume(f.e):o;r._identityDataSource=r.resources.consume(m.t),r._engagement=s;var l=r.resources.consume(c.p);return r._gatewayUrl=null!==(i=null===(a=l.farmSettings)||void 0===a?void 0:a.ExternalService_esigngatewayendpoint)&&void 0!==i?i:"localhost:8080",r}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return!1;var t=this.resources.consume(c.p),n=this.resources.consume(l.e),a=this.resources.consume(p.n),i=this.resources.consume(s.e),r=n.hasPreloadSucceeded()&&n.isUniversalAnnotationActive();return Object(u.t)(e,t,r,a.state.protectedPdf()||a.state.mipPdf(),function(){return a.isMsPdfViewerAvailable(e)},i.isMobile)},t.prototype.onExecute=function(e,t){return Object(a.__awaiter)(this,void 0,r.n,function(){var e,t,n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return this._engagement.logData({name:"SendforSignatureAdobe.Click",isIntentional:!0}),this._identityDataSource&&this._identityDataSource.getOAuthSessionToken?[4,this._identityDataSource.getOAuthSessionToken("api://29f0582a-cecf-4007-9b04-6e7e036a9835")]:[3,2];case 1:e=a.sent(),t=new _.e("adobe",e,this._gatewayUrl),n=this._itemSelectionHelper.firstItem(),t.createDraftAgreement(n),a.label=2;case 2:return[2,r.n.resolve({resultType:o.t.Success})]}})})},t}(i.e);t.default=h}}]);